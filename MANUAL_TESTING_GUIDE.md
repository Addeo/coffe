# 📋 РУКОВОДСТВО ПО РУЧНОМУ ТЕСТИРОВАНИЮ
## Coffee Admin Panel - Manual Testing Guide

> **Версия:** 1.0  
> **Дата:** 15 октября 2025  
> **Время выполнения:** 45-60 минут  

---

## 🎯 ЦЕЛЬ ТЕСТИРОВАНИЯ

Проверить полный жизненный цикл работы с системой:
1. ✅ Создание пользователей (Admin, Manager, Engineers)
2. ✅ Создание организаций с тарифами
3. ✅ Создание и назначение заказов
4. ✅ Работа инженера с заказом
5. ✅ Автоматические расчёты оплаты
6. ✅ Отображение статистики

---

## 📌 ПРЕДВАРИТЕЛЬНЫЕ ТРЕБОВАНИЯ

### Перед началом тестирования убедитесь:

- [ ] Backend запущен: `http://localhost:3001`
- [ ] Frontend запущен: `http://localhost:4202`
- [ ] База данных доступна (SQLite dev или MySQL prod)
- [ ] Браузер: Chrome/Firefox (последняя версия)
- [ ] Консоль разработчика открыта (F12) для проверки ошибок

### Команды для запуска:

```bash
# Терминал 1 - Backend
cd backend
npm install
npm run start:dev

# Терминал 2 - Frontend
cd frontend
npm install
npm start

# Терминал 3 - Database (если используется Docker)
docker-compose up mysql
```

---

## 📝 СЦЕНАРИЙ 1: СОЗДАНИЕ АДМИНИСТРАТОРА И ВХОД

### Шаг 1.1: Создание первого администратора

**Вариант A: Через Seed Script (рекомендуется)**

```bash
cd backend
npm run seed
```

**Результат:**
- Создан пользователь: `admin@coffee.com`
- Пароль: `password`

**Вариант B: Через SQL (если seed не работает)**

```sql
-- Для SQLite (development)
sqlite3 backend/database.sqlite

-- Для MySQL (production)
mysql -u coffee_user -p coffee_admin

-- Выполните:
INSERT INTO users (email, password, first_name, last_name, role, is_active, created_at, updated_at) 
VALUES (
  'admin@coffee.com',
  '$2b$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi',
  'System',
  'Administrator',
  'admin',
  1,
  datetime('now'),
  datetime('now')
);
```

### Шаг 1.2: Первый вход в систему

1. **Откройте браузер:** `http://localhost:4202/login`
2. **Введите данные:**
   - Email: `admin@coffee.com`
   - Password: `password`
3. **Нажмите:** "Войти" / "Login"

**✅ Ожидаемый результат:**
- Редирект на `/dashboard`
- В шапке отображается "System Administrator"
- Видно боковое меню навигации
- Нет ошибок в консоли (F12)

**❌ Что проверять если не работает:**
- Консоль браузера (F12) - есть ли ошибки?
- Backend запущен? `curl http://localhost:3001/api`
- CORS настроен? Проверьте `backend/src/main.ts`
- JWT_SECRET установлен в `.env`?

---

## 👥 СЦЕНАРИЙ 2: СОЗДАНИЕ ПОЛЬЗОВАТЕЛЕЙ

### Шаг 2.1: Создание менеджера

1. В боковом меню → **"Users"** / **"Пользователи"**
2. Кнопка → **"+ Add User"** (справа вверху)
3. Заполните форму:

```
┌─────────────────────────────────────────┐
│ Email:       manager@coffee.com         │
│ Password:    Manager123!                │
│ First Name:  John                       │
│ Last Name:   Smith                      │
│ Role:        Manager ▼                  │
│ Active:      ☑                          │
└─────────────────────────────────────────┘
```

4. **Нажмите:** "Save" / "Сохранить"

**✅ Ожидаемый результат:**
- Сообщение: "User created successfully"
- В таблице появилась строка с `manager@coffee.com`
- Role = Manager
- Status = Active (зелёная галочка)

### Шаг 2.2: Создание первого инженера

1. **"+ Add User"** (снова)
2. Заполните форму:

```
┌─────────────────────────────────────────┐
│ ОСНОВНЫЕ ДАННЫЕ                         │
├─────────────────────────────────────────┤
│ Email:       engineer1@coffee.com       │
│ Password:    Engineer123!               │
│ First Name:  Ivan                       │
│ Last Name:   Petrov                     │
│ Role:        User ▼ (роль инженера!)    │
│ Active:      ☑                          │
├─────────────────────────────────────────┤
│ НАСТРОЙКИ ИНЖЕНЕРА (появятся после      │
│ выбора Role = User)                     │
├─────────────────────────────────────────┤
│ Engineer Type:          Hourly ▼        │
│ Base Rate (₽/hour):     800             │
│ Overtime Rate (₽/hour): 1200            │
│ Plan Hours/Month:       160             │
│ Home Territory Fixed:   5000            │
│ Fixed Salary:           0               │
│ Fixed Car Amount:       10000           │
│ Engineer Active:        ☑               │
└─────────────────────────────────────────┘
```

3. **Нажмите:** "Save"

**✅ Ожидаемый результат:**
- Создан пользователь `engineer1@coffee.com`
- Role = User
- В деталях видны инженерские ставки
- Base Rate = 800 ₽/час

### Шаг 2.3: Создание второго инженера

Повторите Шаг 2.2 с данными:

```
Email:       engineer2@coffee.com
Password:    Engineer123!
First Name:  Maria
Last Name:   Ivanova
Role:        User
Base Rate:   900
Overtime:    1300
Plan Hours:  160
```

### ✅ Контрольная проверка пользователей

В списке "Users" должно быть **4 пользователя:**

| # | Email | Role | Status |
|---|-------|------|--------|
| 1 | admin@coffee.com | Admin | Active |
| 2 | manager@coffee.com | Manager | Active |
| 3 | engineer1@coffee.com | User | Active |
| 4 | engineer2@coffee.com | User | Active |

---

## 🏢 СЦЕНАРИЙ 3: СОЗДАНИЕ ОРГАНИЗАЦИЙ

### Шаг 3.1: Создание первой организации

1. В меню → **"Organizations"** / **"Организации"**
2. **"+ Add Organization"**
3. Заполните форму:

```
┌─────────────────────────────────────────┐
│ Name:                Coffee Shop #1     │
│                      Downtown           │
│ Base Rate (₽/hour):  1500               │
│ Overtime Multiplier: 1.5                │
│ Has Overtime:        ☑                  │
│ Active:              ☑                  │
└─────────────────────────────────────────┘
```

4. **Нажмите:** "Save"

**✅ Ожидаемый результат:**
- Организация создана
- В списке: "Coffee Shop #1 Downtown"
- Base Rate: 1500 ₽/hour

### Шаг 3.2: Создание второй организации

```
Name:                Coffee Shop #2 Mall
Base Rate:           1800
Overtime Multiplier: 2.0
Has Overtime:        ☑
Active:              ☑
```

### Шаг 3.3: Настройка индивидуальных ставок инженера

> **Цель:** Установить специальную ставку для Ivan в Coffee Shop #1

1. Перейдите в → **"Engineer Rates"** / **"Ставки инженеров"**
2. **"+ Add Rate"**
3. Заполните:

```
┌─────────────────────────────────────────┐
│ Engineer:              Ivan Petrov ▼    │
│ Organization:          Coffee Shop #1 ▼ │
│ Custom Base Rate:      850              │
│ Custom Overtime Rate:  1300             │
│ Zone 1 Extra:          0                │
│ Zone 2 Extra:          500              │
│ Zone 3 Extra:          1000             │
└─────────────────────────────────────────┘
```

4. **Нажмите:** "Save"

**📝 Что это значит:**
- Для заказов в Coffee Shop #1, Ivan будет получать **850₽/час** вместо базовых 800₽
- Это позволяет устанавливать разные ставки для разных клиентов

---

## 📋 СЦЕНАРИЙ 4: СОЗДАНИЕ И НАЗНАЧЕНИЕ ЗАКАЗОВ

### Шаг 4.1: Переключение на менеджера

1. **Logout** (клик на аватар → Выход)
2. **Login** как менеджер:
   - Email: `manager@coffee.com`
   - Password: `Manager123!`

**✅ Проверка:** В шапке должно быть "John Smith (Manager)"

### Шаг 4.2: Создание первого заказа

1. Меню → **"Orders"** / **"Заказы"**
2. **"+ New Order"** / **"Создать заказ"**
3. Заполните форму:

```
┌─────────────────────────────────────────┐
│ Organization:      Coffee Shop #1    ▼  │
│                    Downtown              │
│ Title:             Ремонт эспрессо-     │
│                    машины                │
│ Description:       Не работает основная │
│                    группа, нужна замена │
│                    насоса               │
│ Location:          ул. Пушкина, д. 10,  │
│                    Downtown             │
│ Distance (km):     15.5                 │
│ Territory Type:    City ▼               │
│ Source:            Manual ▼             │
│ Planned Start:     2025-10-20           │
└─────────────────────────────────────────┘
```

4. **"Save"** / **"Создать"**

**✅ Ожидаемый результат:**
- Заказ создан с ID #1
- Status = **"Waiting"** (в ожидании)
- Created By = John Smith
- No Assigned Engineer

### Шаг 4.3: Создание второго заказа

```
Organization:      Coffee Shop #2 Mall
Title:             Установка новой кофемашины
Description:       Требуется установка и настройка нового оборудования
Location:          ТЦ Мега, 2 этаж
Distance (km):     25
Territory Type:    Zone 1
Planned Start:     2025-10-21
```

### Шаг 4.4: Назначение инженера на заказ

1. В списке заказов → клик на **"Ремонт эспрессо-машины"**
2. На странице заказа → **"Assign Engineer"** / **"Назначить инженера"**
3. В диалоге выберите:

```
┌─────────────────────────────────────────┐
│ Select Engineer:  Ivan Petrov ▼         │
│                                         │
│         [Cancel]  [Assign]              │
└─────────────────────────────────────────┘
```

4. **"Assign"** / **"Назначить"**

**✅ Ожидаемый результат:**
- Status изменился: `waiting` → `assigned`
- Assigned Engineer: Ivan Petrov
- Assigned By: John Smith
- Assigned Date: текущее время

### Шаг 4.5: Проверка уведомления

1. **Logout**
2. **Login** как инженер:
   - Email: `engineer1@coffee.com`
   - Password: `Engineer123!`
3. Нажмите на колокольчик (🔔) в шапке

**✅ Ожидаемый результат:**
- Уведомление: "New Order Assigned: Ремонт эспрессо-машины"
- Badge с цифрой "1" на колокольчике

---

## 🔧 СЦЕНАРИЙ 5: РАБОТА ИНЖЕНЕРА С ЗАКАЗОМ

> **Вы под учётной записью:** `engineer1@coffee.com`

### Шаг 5.1: Принятие заказа

1. Меню → **"Orders"**
2. Клик на → **"Ремонт эспрессо-машины"**
3. Проверьте Status = **"Assigned"**
4. **"Accept Order"** / **"Принять заказ"**
5. Подтвердите в диалоге

**✅ Ожидаемый результат:**
- Status изменился: `assigned` → `working`
- Actual Start Date: текущее время
- Кнопка "Accept" исчезла

### Шаг 5.2: Добавление первой рабочей сессии

**На странице заказа:**

1. Прокрутите вниз → раздел **"Work Sessions"**
2. **"+ Add Work Session"** / **"Добавить сессию"**
3. Заполните форму:

```
┌─────────────────────────────────────────────────┐
│ Work Date:         2025-10-15                   │
│ Regular Hours:     6                            │
│ Overtime Hours:    2                            │
│ Car Usage Amount:  500                          │
│ Distance (km):     15.5 (автоматически)         │
│ Territory Type:    City (автоматически)         │
│ Notes:             Заменён основной насос,      │
│                    прочищены фильтры,           │
│                    откалибрована температура.   │
│                    Всё работает.                │
│ Photo URL:         (оставьте пустым)            │
│ Status:            Completed ▼                  │
│ Can Be Invoiced:   ☑                            │
└─────────────────────────────────────────────────┘
```

4. **"Save Session"** / **"Сохранить"**

**✅ АВТОМАТИЧЕСКИЕ РАСЧЁТЫ (проверьте!):**

После сохранения система должна показать:

```
╔═════════════════════════════════════════════════╗
║   РАСЧЁТ ОПЛАТЫ ЗА РАБОЧУЮ СЕССИЮ              ║
╠═════════════════════════════════════════════════╣
║ ОПЛАТА ИНЖЕНЕРУ (Ivan Petrov):                 ║
║ • Базовая ставка:      850 ₽/час               ║
║   (индивидуальная для Coffee Shop #1)          ║
║ • Ставка переработки:  1300 ₽/час              ║
║                                                 ║
║ Regular Payment:     6h × 850₽  = 5,100₽      ║
║ Overtime Payment:    2h × 1300₽ = 2,600₽      ║
║ Car Usage:                          500₽       ║
║ ─────────────────────────────────────────────  ║
║ ИТОГО ИНЖЕНЕРУ:                   8,200₽      ║
╠═════════════════════════════════════════════════╣
║ ОПЛАТА ОТ ОРГАНИЗАЦИИ (Coffee Shop #1):        ║
║ • Базовая ставка:      1500 ₽/час              ║
║ • Коэффициент:         1.5x (переработка)      ║
║                                                 ║
║ Regular Payment:     6h × 1500₽      = 9,000₽ ║
║ Overtime Payment:    2h × 1500₽ × 1.5 = 4,500₽║
║ ─────────────────────────────────────────────  ║
║ ИТОГО ОТ ОРГАНИЗАЦИИ:               13,500₽   ║
╠═════════════════════════════════════════════════╣
║ ПРИБЫЛЬ КОМПАНИИ:                              ║
║ 13,500₽ - 8,200₽ = 5,300₽                     ║
╚═════════════════════════════════════════════════╝
```

**📝 Проверьте в UI:**
- [ ] Engineer Payment: **8,200₽**
- [ ] Organization Payment: **13,500₽**
- [ ] Profit: **5,300₽**
- [ ] Regular Hours: **6h**
- [ ] Overtime Hours: **2h**
- [ ] Engineer Base Rate: **850₽** (сохранено для аудита)
- [ ] Organization Base Rate: **1500₽**

### Шаг 5.3: Добавление второй сессии (доработка)

> Если потребовался второй визит на следующий день

Повторите Шаг 5.2 с данными:

```
Work Date:         2025-10-16
Regular Hours:     2
Overtime Hours:    0
Car Usage Amount:  300
Notes:             Финальная проверка, обучение персонала
```

**✅ Расчёт второй сессии:**
- Engineer: 2h × 850₽ + 300₽ = **2,000₽**
- Organization: 2h × 1500₽ = **3,000₽**
- Profit: **1,000₽**

**📊 ОБЩИЙ ИТОГ ПО ЗАКАЗУ:**
```
┌──────────────────────────┬──────────┐
│ Total Engineer Payment   │ 10,200₽ │
│ Total Organization Pay   │ 16,500₽ │
│ Total Profit             │  6,300₽ │
│ Total Hours              │  8h reg  │
│                          │  2h over │
└──────────────────────────┴──────────┘
```

### Шаг 5.4: Завершение заказа

1. На странице заказа → **"Complete Order"**
2. Подтвердите в диалоге

**✅ Ожидаемый результат:**
- Status = **"Completed"** (завершён)
- Completion Date: текущее время
- Обе work sessions видны
- Итоговые суммы отображены

---

## 📊 СЦЕНАРИЙ 6: ПРОСМОТР СТАТИСТИКИ

### Шаг 6.1: Статистика инженера (Personal Dashboard)

> **Вы всё ещё под:** `engineer1@coffee.com`

1. Меню → **"Statistics"** / **"Статистика"**
2. Выберите период:
   - Month: **October** (10)
   - Year: **2025**
3. Нажмите **"Show"** (или обновится автоматически)

**✅ Ожидаемая статистика:**

```
╔═══════════════════════════════════════════════════╗
║ СТАТИСТИКА ИНЖЕНЕРА: Ivan Petrov                 ║
║ Период: Октябрь 2025                             ║
╠═══════════════════════════════════════════════════╣
║ ЗАКАЗЫ:                                          ║
║ ┌────────────────────────┬────────┐              ║
║ │ Total Orders           │   1    │              ║
║ │ Completed Orders       │   1    │              ║
║ │ In Progress            │   0    │              ║
║ │ Completion Rate        │ 100%   │              ║
║ └────────────────────────┴────────┘              ║
╠═══════════════════════════════════════════════════╣
║ ЧАСЫ РАБОТЫ:                                     ║
║ ┌────────────────────────┬────────┐              ║
║ │ Regular Hours          │  8h    │              ║
║ │ Overtime Hours         │  2h    │              ║
║ │ Total Hours            │ 10h    │              ║
║ │ Planned Monthly        │ 160h   │              ║
║ │ Utilization            │ 6.25%  │              ║
║ └────────────────────────┴────────┘              ║
╠═══════════════════════════════════════════════════╣
║ ЗАРАБОТОК:                                       ║
║ ┌────────────────────────┬─────────┐             ║
║ │ Base Earnings          │ 6,800₽ │             ║
║ │ Overtime Earnings      │ 2,600₽ │             ║
║ │ Car Usage              │   800₽ │             ║
║ │ Bonuses                │     0₽ │             ║
║ │━━━━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━│             ║
║ │ TOTAL EARNINGS         │10,200₽ │             ║
║ └────────────────────────┴─────────┘             ║
╠═══════════════════════════════════════════════════╣
║ ОРГАНИЗАЦИИ:                                     ║
║ 1. Coffee Shop #1 Downtown                       ║
║    • Заказов: 1                                  ║
║    • Часов: 10h (8h + 2h)                        ║
║    • Заработано: 10,200₽                         ║
╚═══════════════════════════════════════════════════╝
```

**📊 Графики (должны отображаться):**
- [ ] Часы по дням (bar chart)
- [ ] Заработок по организациям (pie chart)
- [ ] Тренд заказов (line chart)

### Шаг 6.2: Dashboard администратора/менеджера

1. **Logout**
2. **Login** как `admin@coffee.com` или `manager@coffee.com`
3. Перейдите на → **"Dashboard"**

**✅ Ожидаемое отображение:**

```
╔═══════════════════════════════════════════════════╗
║ DASHBOARD - ОБЩАЯ СТАТИСТИКА                     ║
╠═══════════════════════════════════════════════════╣
║ ЗАКАЗЫ ПО СТАТУСАМ:                              ║
║ ┌──────────────┬────────┬──────┐                 ║
║ │ Status       │ Count  │  %   │                 ║
║ ├──────────────┼────────┼──────┤                 ║
║ │ Waiting      │   0    │  0%  │                 ║
║ │ Assigned     │   1    │ 50%  │                 ║
║ │ Working      │   0    │  0%  │                 ║
║ │ Completed    │   1    │ 50%  │                 ║
║ │━━━━━━━━━━━━━━┿━━━━━━━━┿━━━━━━│                 ║
║ │ TOTAL        │   2    │ 100% │                 ║
║ └──────────────┴────────┴──────┘                 ║
╠═══════════════════════════════════════════════════╣
║ ФИНАНСЫ (за текущий месяц):                      ║
║ ┌──────────────────────┬──────────┐              ║
║ │ Total Revenue        │ 16,500₽ │              ║
║ │ Engineer Payments    │ 10,200₽ │              ║
║ │ Profit               │  6,300₽ │              ║
║ │ Profit Margin        │  38.2%  │              ║
║ └──────────────────────┴──────────┘              ║
╠═══════════════════════════════════════════════════╣
║ ИНЖЕНЕРЫ:                                        ║
║ ┌────────────┬────────┬────────┬──────────┐      ║
║ │ Engineer   │ Orders │ Hours  │ Earnings │      ║
║ ├────────────┼────────┼────────┼──────────┤      ║
║ │ Ivan P.    │   1    │  10h   │ 10,200₽ │      ║
║ │ Maria I.   │   0    │   0h   │      0₽ │      ║
║ └────────────┴────────┴────────┴──────────┘      ║
╠═══════════════════════════════════════════════════╣
║ ОРГАНИЗАЦИИ:                                     ║
║ ┌───────────────────┬────────┬──────────┐        ║
║ │ Organization      │ Orders │ Revenue  │        ║
║ ├───────────────────┼────────┼──────────┤        ║
║ │ Coffee Shop #1    │   1    │ 13,500₽ │        ║
║ │ Coffee Shop #2    │   0    │      0₽ │        ║
║ └───────────────────┴────────┴──────────┘        ║
╚═══════════════════════════════════════════════════╝
```

### Шаг 6.3: Детальные отчёты

1. Меню → **"Reports"** / **"Отчёты"**
2. Тип отчёта: **"Orders Report"**
3. Установите период:

```
Start Date:  2025-10-01
End Date:    2025-10-31
```

4. Фильтры (опционально):
   - Status: All / Completed / In Progress
   - Organization: All / Coffee Shop #1
   - Engineer: All / Ivan Petrov

5. **"Generate Report"** / **"Сформировать отчёт"**

**✅ Ожидаемый отчёт:**

```
╔═══════════════════════════════════════════════════╗
║ ОТЧЁТ ПО ЗАКАЗАМ                                 ║
║ Период: 01.10.2025 - 31.10.2025                 ║
╠═══════════════════════════════════════════════════╣
║ СВОДКА:                                          ║
║ • Всего заказов:          2                      ║
║ • Завершённых:            1 (50%)                ║
║ • В работе:               1 (50%)                ║
║ • Средний чек:            13,500₽                ║
╠═══════════════════════════════════════════════════╣
║ ЗАВЕРШЁННЫЕ ЗАКАЗЫ:                              ║
║ ┌────┬──────────────┬──────┬────────┬─────────┐  ║
║ │ ID │ Title        │Hours │ Rev.   │ Profit  │  ║
║ ├────┼──────────────┼──────┼────────┼─────────┤  ║
║ │ 1  │ Ремонт       │ 10h  │13,500₽│ 5,300₽ │  ║
║ │    │ эспрессо     │      │        │         │  ║
║ └────┴──────────────┴──────┴────────┴─────────┘  ║
╠═══════════════════════════════════════════════════╣
║ НЕЗАВЕРШЁННЫЕ ЗАКАЗЫ:                            ║
║ ┌────┬──────────────┬──────────┬──────────┐      ║
║ │ ID │ Title        │ Status   │ Engineer │      ║
║ ├────┼──────────────┼──────────┼──────────┤      ║
║ │ 2  │ Установка    │ Assigned │ (None)   │      ║
║ └────┴──────────────┴──────────┴──────────┘      ║
╠═══════════════════════════════════════════════════╣
║ ЭКСПОРТ:                                         ║
║ [📊 Excel] [📄 PDF] [📋 CSV]                    ║
╚═══════════════════════════════════════════════════╝
```

---

## ✅ ЧЕКЛИСТ ПРОВЕРКИ ВСЕХ ФУНКЦИЙ

### 📋 Управление пользователями

- [ ] Создан Admin (admin@coffee.com)
- [ ] Создан Manager (manager@coffee.com)
- [ ] Создан Engineer #1 (engineer1@coffee.com)
- [ ] Создан Engineer #2 (engineer2@coffee.com)
- [ ] Все пользователи могут войти
- [ ] Роли корректно отображаются
- [ ] Пароли хэшированы (не видны в plaintext)

### 🏢 Управление организациями

- [ ] Создана Coffee Shop #1 с тарифами
- [ ] Создана Coffee Shop #2 с тарифами
- [ ] Ставки отображаются корректно
- [ ] Можно редактировать организацию
- [ ] Можно деактивировать организацию

### ⚙️ Индивидуальные ставки

- [ ] Настроена индивидуальная ставка Ivan + Coffee Shop #1
- [ ] Ставка 850₽ применяется при расчёте
- [ ] Можно просмотреть все ставки инженера

### 📋 Жизненный цикл заказа

- [ ] Заказ создан (Status: Waiting)
- [ ] Инженер назначен (Status: Assigned)
- [ ] Уведомление получено инженером
- [ ] Инженер принял (Status: Working)
- [ ] Work session создана
- [ ] **Расчёты выполнены автоматически**
- [ ] Заказ завершён (Status: Completed)

### 💰 Расчёты и формулы

- [ ] Regular hours × base rate = корректно
- [ ] Overtime hours × overtime rate = корректно
- [ ] Car usage amount добавлен
- [ ] Organization payment с учётом multiplier
- [ ] Profit = org payment - engineer payment
- [ ] Индивидуальные ставки применяются
- [ ] Все ставки сохранены для аудита

### 📊 Статистика инженера

- [ ] Отображается количество заказов
- [ ] Отображаются часы (regular + overtime)
- [ ] Отображается заработок
- [ ] Utilization рассчитан корректно
- [ ] Графики отображаются
- [ ] Разбивка по организациям

### 📈 Статистика администратора

- [ ] Dashboard показывает общие цифры
- [ ] Разбивка заказов по статусам
- [ ] Список инженеров с заработком
- [ ] Список организаций с выручкой
- [ ] Финансовая сводка корректна

### 📄 Отчёты

- [ ] Можно сгенерировать отчёт за период
- [ ] Фильтрация по статусу работает
- [ ] Фильтрация по организации работает
- [ ] Фильтрация по инженеру работает
- [ ] Разделение completed/incomplete
- [ ] Экспорт в Excel (если реализовано)

### 🔔 Уведомления

- [ ] Уведомление при назначении заказа
- [ ] Уведомление при смене статуса
- [ ] Badge с количеством непрочитанных
- [ ] Можно отметить как прочитанное
- [ ] Счётчик обновляется

---

## 🔥 РАСШИРЕННЫЕ СЦЕНАРИИ ТЕСТИРОВАНИЯ

### Сценарий 7: Множественные рабочие сессии

**Цель:** Проверить суммирование расчётов

1. Создайте заказ
2. Назначьте инженера
3. Инженер принимает
4. Добавьте **3 work sessions** в разные дни:
   - День 1: 6h regular, 2h overtime
   - День 2: 8h regular, 0h overtime
   - День 3: 4h regular, 1h overtime

**✅ Проверьте:**
- [ ] Все сессии отображаются в списке
- [ ] Общие часы = 18h regular + 3h overtime
- [ ] Итоговые суммы корректны
- [ ] Profit суммирован правильно

### Сценарий 8: Разные территориальные зоны

**Цель:** Проверить надбавки за зоны

Создайте 4 заказа:
1. City (базовая зона)
2. Zone 1 (+500₽)
3. Zone 2 (+1000₽)
4. Zone 3 (+1500₽)

**✅ Проверьте:**
- [ ] Надбавки применяются к оплате инженера
- [ ] Zone Extra отображается в расчётах

### Сценарий 9: Переназначение заказа

**Цель:** Проверить изменение назначения

1. Создайте заказ
2. Назначьте на Ivan
3. **Переназначьте** на Maria
4. Проверьте:
   - [ ] Обоим инженерам пришли уведомления
   - [ ] История изменений сохранена
   - [ ] Статус корректный
   - [ ] Assigned By обновился

### Сценарий 10: Загрузка файлов к заказу

**Цель:** Проверить прикрепление документов

1. Откройте заказ
2. Нажмите "Upload Files" / "Загрузить файлы"
3. Загрузите:
   - Фото выполненных работ (JPG/PNG)
   - Акт выполненных работ (PDF)
   - Чек (JPG)

**✅ Проверьте:**
- [ ] Файлы загружены
- [ ] Превью отображается для изображений
- [ ] Можно скачать файлы
- [ ] Файлы привязаны к заказу

### Сценарий 11: Пагинация и фильтрация

**Создайте 20+ заказов**

**✅ Проверьте:**
- [ ] Пагинация работает
- [ ] Фильтр по статусу
- [ ] Фильтр по организации
- [ ] Фильтр по инженеру
- [ ] Поиск по названию
- [ ] Сортировка по дате

---

## 🐛 ЧТО ПРОВЕРЯТЬ ПРИ КАЖДОМ ДЕЙСТВИИ

### После создания пользователя:

```
✅ Email уникален (нельзя создать дубликат)
✅ Пароль не отображается в plaintext
✅ Пароль хэширован в БД (bcrypt)
✅ Role корректен
✅ Для engineer создана запись в таблице engineers
✅ Ставки сохранены
✅ Пользователь может войти
```

### После создания заказа:

```
✅ Status = waiting
✅ Created By = текущий пользователь
✅ Organization связана корректно
✅ Дата/время создания
✅ Все обязательные поля заполнены
✅ ID сгенерирован
```

### После назначения инженера:

```
✅ Status: waiting → assigned
✅ Assigned Engineer отображается
✅ Assigned By = текущий пользователь
✅ Assigned Date сохранена
✅ Уведомление отправлено инженеру
✅ Badge на колокольчике обновился
```

### После принятия заказа инженером:

```
✅ Status: assigned → working
✅ Actual Start Date установлена
✅ Кнопка "Accept" исчезла
✅ Появились кнопки для работы
✅ Уведомление отправлено создателю
```

### После создания work session:

```
✅ Regular payment = hours × base rate
✅ Overtime payment = hours × overtime rate
✅ Total = regular + overtime + car
✅ Organization payment с multiplier
✅ Profit = org payment - engineer payment
✅ Все ставки сохранены (audit trail)
✅ Work date влияет на статистику за месяц
✅ Session отображается в списке
```

### После завершения заказа:

```
✅ Status: working → completed
✅ Completion Date установлена
✅ Нельзя редактировать основные поля
✅ Work sessions остаются для просмотра
✅ Заказ учитывается в статистике
✅ Показывается в отчётах как completed
```

---

## 🔍 ПРОВЕРКА КОНСОЛИ (F12)

### В процессе тестирования проверяйте:

**✅ Не должно быть:**
- ❌ Ошибок 500 (Internal Server Error)
- ❌ Ошибок 401 (Unauthorized)
- ❌ Ошибок CORS
- ❌ Failed requests
- ❌ JavaScript errors

**✅ Должно быть:**
- ✅ Успешные 200/201 responses
- ✅ Console.log с информацией (в dev режиме)
- ✅ Network requests к `/api/*`

---

## ⏱️ ВРЕМЯ ВЫПОЛНЕНИЯ

| Сценарий | Время |
|----------|-------|
| 1. Создание пользователей (4 шт) | 5-7 мин |
| 2. Создание организаций (2 шт) | 3-5 мин |
| 3. Настройка индивидуальных ставок | 2-3 мин |
| 4. Создание заказов (2 шт) | 5-7 мин |
| 5. Назначение и принятие | 3-5 мин |
| 6. Work sessions (2 шт) | 5-10 мин |
| 7. Проверка статистики инженера | 3-5 мин |
| 8. Проверка статистики админа | 3-5 мин |
| 9. Генерация отчётов | 3-5 мин |
| 10. Проверка уведомлений | 2-3 мин |
| **ИТОГО** | **35-55 мин** |

---

## 📸 СКРИНШОТЫ ДЛЯ ДОКУМЕНТАЦИИ

Рекомендуется сохранить скриншоты:

1. ✅ **Список пользователей** - все 4 роли
2. ✅ **Список организаций** - с тарифами
3. ✅ **Форма создания заказа**
4. ✅ **Заказ в статусе Assigned**
5. ✅ **Work Session с автоматическими расчётами**
6. ✅ **Completed Order** с итоговыми суммами
7. ✅ **Dashboard** - общая статистика
8. ✅ **Engineer Statistics** - личная статистика
9. ✅ **Reports** - детальный отчёт
10. ✅ **Notifications** - список уведомлений

---

## 🎯 КРИТЕРИИ УСПЕХА

### ✅ Система работает корректно если:

1. **Все пользователи могут войти** в систему со своими credentials
2. **Расчёты математически верны** (проверьте калькулятором!)
3. **Статусы переходят последовательно:** waiting → assigned → working → completed
4. **Уведомления приходят** всем заинтересованным сторонам
5. **Статистика совпадает** с реальными данными в заказах
6. **Отчёты генерируются** корректно с фильтрацией
7. **Нет ошибок** в консоли браузера (F12)
8. **Нет 500 ошибок** от backend API
9. **CORS работает** (нет CORS errors)
10. **JWT токены** корректно обновляются

---

## 📞 ПОДДЕРЖКА И ОТЧЁТЫ О БАГАХ

### Если что-то не работает:

1. **Проверьте консоль** (F12 → Console)
2. **Проверьте Network** (F12 → Network)
3. **Проверьте backend logs** (терминал где запущен backend)
4. **Проверьте database** (есть ли данные?)

### Формат отчёта о баге:

```markdown
## Bug Report

**Описание:**
[Что произошло]

**Ожидалось:**
[Что должно было произойти]

**Шаги воспроизведения:**
1. ...
2. ...
3. ...

**Скриншот:**
[Прикрепите если возможно]

**Консоль (F12):**
[Ошибки из консоли]

**Окружение:**
- OS: macOS/Windows/Linux
- Browser: Chrome/Firefox
- Node version: 18.x
- Frontend: localhost:4202
- Backend: localhost:3001
```

---

## ✅ ИТОГОВАЯ ПРОВЕРКА

После завершения всех сценариев у вас должно быть:

- [ ] **4 пользователя** (1 admin, 1 manager, 2 engineers)
- [ ] **2 организации** с разными тарифами
- [ ] **1 индивидуальная ставка** (Ivan + Coffee Shop #1)
- [ ] **2+ заказа** в разных статусах
- [ ] **1 завершённый заказ** с work sessions
- [ ] **Статистика** отображается корректно
- [ ] **Отчёты** генерируются
- [ ] **Уведомления** работают
- [ ] **Нет ошибок** в системе

---

## 🎉 ПОЗДРАВЛЯЕМ!

Если все чеклисты пройдены, система работает корректно и готова к:
- ✅ Дальнейшей разработке
- ✅ Демонстрации заказчику
- ✅ Интеграционному тестированию
- ✅ Deployment в staging

---

**Дата создания:** 15 октября 2025  
**Версия документа:** 1.0  
**Автор:** AI Assistant  
**Статус:** Ready for Testing

