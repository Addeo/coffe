# üîì –ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã 80 –∏ 443 –≤ Cloud.ru

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–°–∞–π—Ç **coffe-ug.ru** –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ **Cloud.ru –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç—ã 80 –∏ 443**.

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –æ–±–ª–∞—á–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –≤ –ø–∞–Ω–µ–ª–∏ Cloud.ru

### **–®–∞–≥ 1: –í–æ–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å Cloud.ru**

1. –û—Ç–∫—Ä–æ–π—Ç–µ [https://cloud.ru](https://cloud.ru) –∏–ª–∏ [https://my.cloud.ru](https://my.cloud.ru)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã"** –∏–ª–∏ **"Compute"**

### **–®–∞–≥ 2: –ù–∞–π—Ç–∏ –≤–∞—à—É VM**

1. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É: **vm-46609d42d**
2. IP –∞–¥—Ä–µ—Å: **192.144.12.102**
3. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ—ë

### **–®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Security Groups (–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)**

–í–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É:
- **"Security Groups"** (–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- **"Firewall"** (–ú–µ–∂—Å–µ—Ç–µ–≤–æ–π —ç–∫—Ä–∞–Ω)
- **"Network"** ‚Üí **"Security"**
- **"–°–µ—Ç—å"** ‚Üí **"–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"**

### **–®–∞–≥ 4: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞**

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å **2 –ø—Ä–∞–≤–∏–ª–∞**:

#### **–ü—Ä–∞–≤–∏–ª–æ 1: HTTP (Port 80)**
```
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í—Ö–æ–¥—è—â–µ–µ (Inbound/Ingress)
–ü—Ä–æ—Ç–æ–∫–æ–ª: TCP
–ü–æ—Ä—Ç: 80
–ò—Å—Ç–æ—á–Ω–∏–∫: 0.0.0.0/0 (–ª—é–±–æ–π IP) –∏–ª–∏ Anywhere
–û–ø–∏—Å–∞–Ω–∏–µ: HTTP
```

#### **–ü—Ä–∞–≤–∏–ª–æ 2: HTTPS (Port 443)**
```
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í—Ö–æ–¥—è—â–µ–µ (Inbound/Ingress)
–ü—Ä–æ—Ç–æ–∫–æ–ª: TCP
–ü–æ—Ä—Ç: 443
–ò—Å—Ç–æ—á–Ω–∏–∫: 0.0.0.0/0 (–ª—é–±–æ–π IP) –∏–ª–∏ Anywhere
–û–ø–∏—Å–∞–Ω–∏–µ: HTTPS
```

### **–®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è**

1. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"** / **"Save"** / **"Apply"**
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30-60 —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∞ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

### **–ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–æ–≤:**

**–ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (Mac) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 80
curl -I http://192.144.12.102

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–π—Ç–∞
curl -I http://coffe-ug.ru
```

**–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:**
```
HTTP/1.1 200 OK
Server: nginx
...
```

**–ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**

```bash
cd /Users/sergejkosilov/WebstormProjects/new\ goal/coffe
./fix-firewall-and-ssl.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç HTTPS.

---

## üì∏ –ö–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø—Ä–∏–º–µ—Ä—ã)

### **–¢–∏–ø–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Cloud.ru:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã                      ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ vm-46609d42d (192.144.12.102)          ‚îÇ
‚îÇ   ‚îú‚îÄ –û–±–∑–æ—Ä                             ‚îÇ
‚îÇ   ‚îú‚îÄ –ö–æ–Ω—Å–æ–ª—å                           ‚îÇ
‚îÇ   ‚îú‚îÄ –°–µ—Ç—å                              ‚îÇ
‚îÇ   ‚îî‚îÄ üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  ‚Üê –°–Æ–î–ê           ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ –ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                     ‚îÇ
‚îÇ   ‚îú‚îÄ + –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ                ‚îÇ
‚îÇ   ‚îÇ                                     ‚îÇ
‚îÇ   ‚îú‚îÄ –ü—Ä–∞–≤–∏–ª–æ 1: SSH (Port 22) ‚úÖ       ‚îÇ
‚îÇ   ‚îú‚îÄ –ü—Ä–∞–≤–∏–ª–æ 2: HTTP (Port 80) ‚ùå ‚Üê    ‚îÇ
‚îÇ   ‚îî‚îÄ –ü—Ä–∞–≤–∏–ª–æ 3: HTTPS (Port 443) ‚ùå ‚Üê  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üÜò –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Cloud.ru**

–ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Cloud.ru:

```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!

–ú–Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –ø–æ—Ä—Ç—ã 80 (HTTP) –∏ 443 (HTTPS)
–¥–ª—è –º–æ–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:

VM ID: vm-46609d42d
IP: 192.144.12.102

–ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Security Groups –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç–∏ –ø–æ—Ä—Ç—ã?

–°–ø–∞—Å–∏–±–æ!
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

–ü–æ–∏—â–∏—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Cloud.ru:
- "–ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã"
- "Security Groups"
- "Firewall"
- "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏"

### **–í–∞—Ä–∏–∞–Ω—Ç 3: –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**

–ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Cloudflare Tunnel** –æ–±—Ä–∞—Ç–Ω–æ:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh user1@192.144.12.102

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cloudflared
wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
sudo dpkg -i cloudflared-linux-amd64.deb

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å tunnel
cloudflared tunnel login
cloudflared tunnel create coffee-tunnel
cloudflared tunnel route dns coffee-tunnel coffe-ug.ru

# –ó–∞–ø—É—Å—Ç–∏—Ç—å tunnel
cloudflared tunnel run --url http://localhost:4000 coffee-tunnel
```

---

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–µ–π—á–∞—Å

```
Internet (Port 80/443) 
    ‚Üì
 ‚ùå BLOCKED by Cloud.ru Firewall
    ‚Üì
192.144.12.102
    ‚Üì
  Nginx (—Å–ª—É—à–∞–µ—Ç –Ω–∞ 80/443) ‚úÖ
  ‚îú‚Üí Frontend: localhost:4000 ‚úÖ
  ‚îî‚Üí Backend: localhost:3001 ‚úÖ
```

**–ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–æ–≤:**

```
Internet (Port 80/443) 
    ‚Üì
 ‚úÖ Allowed by Cloud.ru Firewall
    ‚Üì
192.144.12.102
    ‚Üì
  Nginx (—Å–ª—É—à–∞–µ—Ç –Ω–∞ 80/443) ‚úÖ
  ‚îú‚Üí Frontend: localhost:4000 ‚úÖ
  ‚îî‚Üí Backend: localhost:3001 ‚úÖ

Result: üåê https://coffe-ug.ru WORKS!
```

---

## üéØ –ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞

1. **–ó–∞–π—Ç–∏**: [https://cloud.ru](https://cloud.ru) ‚Üí –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã ‚Üí vm-46609d42d
2. **–ù–∞–π—Ç–∏**: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" / "Security Groups" / "Firewall"
3. **–î–æ–±–∞–≤–∏—Ç—å**: 
   - Port 80 (TCP, 0.0.0.0/0)
   - Port 443 (TCP, 0.0.0.0/0)
4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** –∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: `curl -I http://192.144.12.102`
6. **–ü–æ–ª—É—á–∏—Ç—å SSL**: `./fix-firewall-and-ssl.sh`

---

## ‚úÖ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–°–∞–π—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚úÖ http://coffe-ug.ru (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º –Ω–∞ HTTPS)
- ‚úÖ https://coffe-ug.ru (—Å –≤–∞–ª–∏–¥–Ω—ã–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º)
- ‚úÖ https://www.coffe-ug.ru

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 5 –º–∏–Ω—É—Ç  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –õ–µ–≥–∫–æ (–µ—Å–ª–∏ –Ω–∞–π–¥—ë—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Cloud.ru)  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π —Å–∞–π—Ç —Å HTTPS! üéâ

