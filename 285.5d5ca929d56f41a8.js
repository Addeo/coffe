"use strict";(self.webpackChunkcoffee_admin=self.webpackChunkcoffee_admin||[]).push([[285],{8285:(S,f,s)=>{s.r(f),s.d(f,{LogsViewerComponent:()=>$});var e=s(4292),m=s(9351),c=s(7199),g=s(8598),h=s(5320),u=s(3505),p=s(6721),v=s(4536),C=s(91),F=s(8497),_=s(6093),d=s(8613),x=s(878),b=s(9110),L=s(3170),k=s(6e3),M=s(7694);function R(n,a){if(1&n&&(e.j41(0,"div",23)(1,"mat-chip-set")(2,"mat-chip")(3,"mat-icon",24),e.EFF(4,"info"),e.k0s(),e.EFF(5),e.k0s(),e.j41(6,"mat-chip")(7,"mat-icon",24),e.EFF(8,"filter_list"),e.k0s(),e.EFF(9),e.k0s(),e.j41(10,"mat-chip")(11,"mat-icon",24),e.EFF(12,"list"),e.k0s(),e.EFF(13),e.k0s()()()),2&n){let t,i,o;const r=e.XpG();e.R7$(5),e.SpI(" Total: ",(null==(t=r.logStats())?null:t.total)||0," "),e.R7$(4),e.SpI(" Filtered: ",(null==(i=r.logStats())?null:i.filtered)||0," "),e.R7$(4),e.SpI(" Showing: ",(null==(o=r.logStats())?null:o.returned)||0," ")}}function j(n,a){1&n&&(e.j41(0,"div",25),e.nrm(1,"mat-spinner",26),e.j41(2,"p"),e.EFF(3,"Loading logs..."),e.k0s()())}function E(n,a){if(1&n&&(e.j41(0,"div",27)(1,"mat-icon",28),e.EFF(2,"error"),e.k0s(),e.j41(3,"p"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(t.error())}}function O(n,a){if(1&n&&(e.j41(0,"span",38),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.timestamp)}}function P(n,a){if(1&n&&(e.j41(0,"span",39),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.emoji)}}function w(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",31)(1,"div",32),e.DNE(2,O,2,1,"span",33)(3,P,2,1,"span",34),e.j41(4,"mat-chip",35),e.EFF(5),e.k0s(),e.j41(6,"span",36),e.EFF(7),e.k0s()(),e.j41(8,"button",37),e.bIt("click",function(){const o=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.copyLog(o.raw))}),e.j41(9,"mat-icon"),e.EFF(10,"content_copy"),e.k0s()()()}if(2&n){const t=a.$implicit;e.AVh("log-error","ERROR"===t.level)("log-warn","WARN"===t.level)("log-info","INFO"===t.level)("log-success","\u2705"===t.emoji),e.R7$(2),e.Y8G("ngIf",t.timestamp),e.R7$(),e.Y8G("ngIf",t.emoji),e.R7$(2),e.JRh(t.level),e.R7$(2),e.JRh(t.message)}}function I(n,a){if(1&n&&(e.j41(0,"div",29),e.DNE(1,w,11,12,"div",30),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.logs())("ngForTrackBy",t.trackByLogId)}}function T(n,a){1&n&&(e.j41(0,"div",40)(1,"mat-icon"),e.EFF(2,"inbox"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No logs found"),e.k0s()())}function V(n,a){if(1&n&&(e.j41(0,"div",41)(1,"mat-icon"),e.EFF(2,"sync"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.SpI("Auto-refresh: ",t.refreshInterval,"s")}}let $=(()=>{class n{constructor(t){this.http=t,this.logs=(0,e.vPA)([]),this.isLoading=(0,e.vPA)(!1),this.error=(0,e.vPA)(""),this.logStats=(0,e.vPA)(null),this.autoRefreshEnabled=(0,e.vPA)(!1),this.selectedLines="100",this.selectedLevel="",this.searchQuery="",this.refreshInterval=5,(0,e.QZP)(()=>{this.logs().length>0&&this.autoRefreshEnabled()})}ngOnInit(){this.loadLogs()}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}loadLogs(){this.isLoading.set(!0),this.error.set("");const t={lines:this.selectedLines};"orders"===this.selectedLevel?t.level="order":"error"===this.selectedLevel&&(t.level="error"),this.http.get(`${x.c.apiUrl}/api/logs`,{params:t}).subscribe({next:i=>{this.logs.set(i.logs||[]),this.logStats.set(i),this.isLoading.set(!1)},error:i=>{this.error.set("Failed to load logs: "+i.message),this.isLoading.set(!1)}})}searchLogs(){this.searchQuery.trim()?(this.isLoading.set(!0),this.http.get(`${x.c.apiUrl}/api/logs/search`,{params:{query:this.searchQuery,lines:this.selectedLines}}).subscribe({next:t=>{this.logs.set(t.logs||[]),this.logStats.set(t),this.isLoading.set(!1)},error:t=>{this.error.set("Search failed: "+t.message),this.isLoading.set(!1)}})):this.loadLogs()}toggleAutoRefresh(){this.autoRefreshEnabled.update(t=>!t),this.autoRefreshEnabled()?this.refreshSubscription=function y(n=0,a=b.E){return n<0&&(n=0),(0,L.O)(n,n,a)}(1e3*this.refreshInterval).subscribe(()=>{this.loadLogs()}):this.refreshSubscription&&this.refreshSubscription.unsubscribe()}copyLog(t){navigator.clipboard.writeText(t).then(()=>{})}trackByLogId(t,i){return i.id}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(k.Qq))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-logs-viewer"]],standalone:!0,features:[e.aNF],decls:52,vars:12,consts:[[1,"logs-viewer-container"],[1,"header-content"],[1,"header-actions"],["mat-icon-button","",3,"click","matTooltip"],[1,"controls-section"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],["value","50"],["value","100"],["value","200"],["value","500"],["value",""],["value","error"],["value","orders"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Type to search...",3,"ngModelChange","keyup.enter","ngModel"],["mat-icon-button","","matSuffix","",3,"click"],["class","stats-section",4,"ngIf"],["class","loading-section",4,"ngIf"],["class","error-section",4,"ngIf"],["class","logs-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","auto-refresh-indicator",4,"ngIf"],[1,"stats-section"],["matChipAvatar",""],[1,"loading-section"],["diameter","50"],[1,"error-section"],["color","warn"],[1,"logs-list"],["class","log-entry",3,"log-error","log-warn","log-info","log-success",4,"ngFor","ngForOf","ngForTrackBy"],[1,"log-entry"],[1,"log-content"],["class","timestamp",4,"ngIf"],["class","emoji",4,"ngIf"],[1,"level-chip"],[1,"message"],["mat-icon-button","","matTooltip","Copy log",3,"click"],[1,"timestamp"],[1,"emoji"],[1,"empty-state"],[1,"auto-refresh-indicator"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"div",1)(4,"h2")(5,"mat-icon"),e.EFF(6,"list"),e.k0s(),e.EFF(7," Backend Logs Viewer "),e.k0s(),e.j41(8,"div",2)(9,"button",3),e.bIt("click",function(){return o.toggleAutoRefresh()}),e.j41(10,"mat-icon"),e.EFF(11),e.k0s()(),e.j41(12,"button",3),e.bIt("click",function(){return o.loadLogs()}),e.j41(13,"mat-icon"),e.EFF(14,"refresh"),e.k0s()()()()(),e.j41(15,"mat-card-content")(16,"div",4)(17,"mat-form-field",5)(18,"mat-label"),e.EFF(19,"Lines"),e.k0s(),e.j41(20,"mat-select",6),e.mxI("ngModelChange",function(l){return e.DH7(o.selectedLines,l)||(o.selectedLines=l),l}),e.bIt("selectionChange",function(){return o.loadLogs()}),e.j41(21,"mat-option",7),e.EFF(22,"50"),e.k0s(),e.j41(23,"mat-option",8),e.EFF(24,"100"),e.k0s(),e.j41(25,"mat-option",9),e.EFF(26,"200"),e.k0s(),e.j41(27,"mat-option",10),e.EFF(28,"500"),e.k0s()()(),e.j41(29,"mat-form-field",5)(30,"mat-label"),e.EFF(31,"Filter by level"),e.k0s(),e.j41(32,"mat-select",6),e.mxI("ngModelChange",function(l){return e.DH7(o.selectedLevel,l)||(o.selectedLevel=l),l}),e.bIt("selectionChange",function(){return o.loadLogs()}),e.j41(33,"mat-option",11),e.EFF(34,"All"),e.k0s(),e.j41(35,"mat-option",12),e.EFF(36,"Errors only"),e.k0s(),e.j41(37,"mat-option",13),e.EFF(38,"Orders only"),e.k0s()()(),e.j41(39,"mat-form-field",14)(40,"mat-label"),e.EFF(41,"Search"),e.k0s(),e.j41(42,"input",15),e.mxI("ngModelChange",function(l){return e.DH7(o.searchQuery,l)||(o.searchQuery=l),l}),e.bIt("keyup.enter",function(){return o.searchLogs()}),e.k0s(),e.j41(43,"button",16),e.bIt("click",function(){return o.searchLogs()}),e.j41(44,"mat-icon"),e.EFF(45,"search"),e.k0s()()()(),e.DNE(46,R,14,3,"div",17)(47,j,4,0,"div",18)(48,E,5,1,"div",19)(49,I,2,2,"div",20)(50,T,5,0,"div",21),e.k0s()(),e.DNE(51,V,5,1,"div",22),e.k0s()),2&i&&(e.R7$(9),e.Y8G("matTooltip",o.autoRefreshEnabled()?"Disable auto-refresh":"Enable auto-refresh"),e.R7$(2),e.JRh(o.autoRefreshEnabled()?"sync":"sync_disabled"),e.R7$(),e.Y8G("matTooltip","Refresh logs"),e.R7$(8),e.R50("ngModel",o.selectedLines),e.R7$(12),e.R50("ngModel",o.selectedLevel),e.R7$(10),e.R50("ngModel",o.searchQuery),e.R7$(4),e.Y8G("ngIf",o.logStats()),e.R7$(),e.Y8G("ngIf",o.isLoading()),e.R7$(),e.Y8G("ngIf",o.error()),e.R7$(),e.Y8G("ngIf",!o.isLoading()&&!o.error()),e.R7$(),e.Y8G("ngIf",!o.isLoading()&&!o.error()&&0===o.logs().length),e.R7$(),e.Y8G("ngIf",o.autoRefreshEnabled()))},dependencies:[m.MD,m.Sq,m.bT,c.YN,c.me,c.BC,c.vS,g.Hu,g.RN,g.m2,g.MM,h.Hl,h.iY,u.fS,u.fg,p.rl,p.nJ,p.yw,p.RG,v.Ve,v.VO,M.wT,C.m_,C.An,F.D6,F.LG,_.uc,_.oV,d.YN,d.Jl,d.yZ,d.Jo],styles:[".logs-viewer-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}mat-card[_ngcontent-%COMP%]{margin-bottom:20px}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.controls-section[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;flex-wrap:wrap}mat-form-field[_ngcontent-%COMP%]{min-width:120px}.search-field[_ngcontent-%COMP%]{flex:1;min-width:250px}.stats-section[_ngcontent-%COMP%]{margin-bottom:20px}.loading-section[_ngcontent-%COMP%], .error-section[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-section[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.error-section[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc;margin-bottom:16px}.logs-list[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;border:1px solid #e0e0e0;border-radius:4px;padding:8px}.log-entry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;border-radius:4px;margin-bottom:8px;background-color:#fafafa;transition:background-color .2s}.log-entry[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.log-entry.log-error[_ngcontent-%COMP%]{background-color:#ffebee;border-left:4px solid #f44336}.log-entry.log-warn[_ngcontent-%COMP%]{background-color:#fff3e0;border-left:4px solid #ff9800}.log-entry.log-info[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3}.log-entry.log-success[_ngcontent-%COMP%]{background-color:#e8f5e9;border-left:4px solid #4caf50}.log-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1;font-family:Courier New,monospace;font-size:13px;overflow-x:auto}.timestamp[_ngcontent-%COMP%]{color:#666;font-size:11px;min-width:140px}.emoji[_ngcontent-%COMP%]{font-size:18px;min-width:24px}.level-chip[_ngcontent-%COMP%]{font-size:10px;height:20px;min-width:60px}.message[_ngcontent-%COMP%]{flex:1;white-space:pre-wrap;word-break:break-word}.auto-refresh-indicator[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;display:flex;align-items:center;gap:8px;padding:12px 16px;background-color:#4caf50;color:#fff;border-radius:24px;box-shadow:0 4px 6px #0000001a;font-size:14px;z-index:1000}.auto-refresh-indicator[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return n})()}}]);