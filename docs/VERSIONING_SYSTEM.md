# –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å

### 1. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏:**

- **–í –∫–æ–¥–µ**: –ó–∞—à–∏—Ç–∞ –≤ `environment.ts` –∏ `environment.prod.ts` –∫–∞–∫ `appVersion: '1.0.1'`
- **–ü—Ä–∏ —Å–±–æ—Ä–∫–µ**: –ë–µ—Ä–µ—Ç—Å—è –∏–∑ `environment.appVersion` –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–¥
- **–í –Ω–∞—Ç–∏–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**: –ß–∏—Ç–∞–µ—Ç—Å—è –∏–∑ `AndroidManifest.xml` —á–µ—Ä–µ–∑ Capacitor App API

**–í–∞–∂–Ω–æ:** –í–µ—Ä—Å–∏—è –≤ `environment.ts` –¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –≤–µ—Ä—Å–∏–µ–π –≤ `package.json`!

### 2. –í–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏:**

- Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —á–µ—Ä–µ–∑ `/api/app/version`
- –í–µ—Ä—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `backend/src/modules/app/app.controller.ts`

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:** `1.0.2`

### 3. –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

#### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

```typescript
// –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è StartupService.checkForUpdates()
// –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è —Å –≤–µ—Ä—Å–∏–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

#### –®–∞–≥ 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π

```typescript
currentVersion: string = environment.appVersion; // –ò–∑ –∫–æ–¥–∞
serverVersion: string = await http.get('/api/app/version');

if (serverVersion !== currentVersion) {
  // –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
}
```

#### –®–∞–≥ 3: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ APK

```typescript
// –î–ª—è Android –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ APK
// Android –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
await App.openUrl({ url: downloadUrl });
```

#### –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞

- Android –ø–æ–∫–∞–∂–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Frontend (`environment.ts`)

```typescript
export const environment = {
  appVersion: '1.0.1', // ‚Üê –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –≤ –∫–æ–¥–µ
  // ...
};
```

### Backend (`app.controller.ts`)

```typescript
@Get('version')
getVersion() {
  return {
    version: '1.0.2', // ‚Üê –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    downloadUrl: 'http://.../app-debug.apk',
    required: false,
    releaseNotes: '...',
  };
}
```

### Android (`build.gradle`)

```gradle
android {
    defaultConfig {
        versionCode 2      // ‚Üê –£–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–π —Å–±–æ—Ä–∫–µ
        versionName "1.0.2" // ‚Üê –î–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å serverVersion
    }
}
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –î–ª—è –Ω–æ–≤–æ–π —Å–±–æ—Ä–∫–∏:

1. **–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ –∫–æ–¥–µ:**

   ```bash
   # –í frontend/src/environments/environment.ts
   appVersion: '1.0.2'

   # –í frontend/src/environments/environment.prod.ts
   appVersion: '1.0.2'
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

   ```bash
   # –í backend/src/modules/app/app.controller.ts
   version: '1.0.2'
   ```

3. **–û–±–Ω–æ–≤–∏—Ç—å AndroidManifest.xml:**

   ```bash
   # –í frontend/android/app/build.gradle
   versionCode 2
   versionName "1.0.2"
   ```

4. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

   ```bash
   ng build --configuration production
   npx cap sync android
   # –°–æ–±—Ä–∞—Ç—å APK
   ```

5. **–í—ã–ª–æ–∂–∏—Ç—å –Ω–æ–≤—ã–π APK –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   # –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ downloadUrl
   ```

## –¢–∏–ø—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (`required: true`)

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (`required: false`)

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ª–æ–∂–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–µ—Ä—Å–∏–∏:**
   - Frontend: `1.0.1`
   - Backend: `1.0.2`
   - APK –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `1.0.2`

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

   ```bash
   # –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –¥–∏–∞–ª–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```bash
   # –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞/Android Studio
   üì± –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: 1.0.1
   üì° –í–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: 1.0.2
   ‚úÖ –î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è: 1.0.2
   ```

## –ü—Ä–æ—Ü–µ—Å—Å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### –ö–æ–≥–¥–∞ –≤—ã–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è:

1. **–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö:**

   ```bash
   environment.ts ‚Üí 1.0.2
   environment.prod.ts ‚Üí 1.0.2
   app.controller.ts ‚Üí 1.0.2
   build.gradle ‚Üí versionName "1.0.2"
   ```

2. **–°–æ–±—Ä–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é:**

   ```bash
   cd frontend
   ng build --configuration production
   npx cap sync android
   ```

3. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å APK:**

   ```bash
   cd android
   ./gradlew assembleDebug
   # –ò–ª–∏ —á–µ—Ä–µ–∑ Android Studio
   ```

4. **–í—ã–ª–æ–∂–∏—Ç—å APK –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**

   ```bash
   # –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø–æ URL –∏–∑ downloadUrl
   ```

5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
   ```bash
   # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
   # –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   ```

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ü–æ—á–µ–º—É –≤–µ—Ä—Å–∏—è –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è?

A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–µ—Ä—Å–∏—è –≤ `environment.ts` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–µ—Ä—Å–∏–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### Q: –ö–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–±–Ω–æ–≤–∏—Ç—å—Å—è?

A: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `required: true` –≤ –æ—Ç–≤–µ—Ç–µ `/api/app/version`

### Q: –ú–æ–∂–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

A: –î–∞, Android –ø–æ–∫–∞–∂–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ APK

### Q: –ß—Ç–æ –µ—Å–ª–∏ downloadUrl –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω?

A: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. ‚úÖ –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ APK
4. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
5. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö
6. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ–Ω–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É
