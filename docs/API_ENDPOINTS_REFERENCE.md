# API Endpoints Reference

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ä–æ–ª—è–º.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [API_SECURITY_AUDIT.md](./API_SECURITY_AUDIT.md) –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/api/auth`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| POST | `/auth/login` | Public | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É |
| POST | `/auth/switch-role` | All | –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–∏ |
| POST | `/auth/reset-role` | All | –°–±—Ä–æ—Å –∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–æ–ª–∏ |
| GET | `/auth/init-admin` | Public | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞ |

## üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/api/users`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/users` | ADMIN, MANAGER | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| POST | `/users` | ADMIN | –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| GET | `/users/profile` | All | –°–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å |
| PATCH | `/users/profile` | All | –û–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å |
| GET | `/users/:id` | ADMIN, MANAGER | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| PATCH | `/users/:id` | ADMIN | –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| DELETE | `/users/:id` | ADMIN | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| DELETE | `/users/:id/force` | ADMIN | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |

## üè¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (`/api/organizations`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/organizations` | ADMIN, MANAGER | –°–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π |
| POST | `/organizations` | ADMIN | –°–æ–∑–¥–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é |
| GET | `/organizations/:id` | ADMIN, MANAGER | –ü–æ–ª—É—á–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é |
| PATCH | `/organizations/:id` | ADMIN | –û–±–Ω–æ–≤–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é |
| PATCH | `/organizations/:id/toggle-status` | ADMIN | –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å |
| DELETE | `/organizations/:id` | ADMIN | –£–¥–∞–ª–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é |
| GET | `/organizations/test` | Public | –¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç |
| GET | `/organizations/public` | Public | –ü—É–±–ª–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ |

## üì¶ –ó–∞–∫–∞–∑—ã (`/api/orders`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/orders` | All | –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ —Ä–æ–ª–∏) |
| POST | `/orders` | ADMIN, MANAGER | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ |
| POST | `/orders/automatic` | ADMIN | –°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–∫–∞–∑ |
| GET | `/orders/my-orders` | ADMIN, MANAGER | –ú–æ–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã |
| GET | `/orders/by-source/:source` | ADMIN, MANAGER | –ó–∞–∫–∞–∑—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É |
| GET | `/orders/stats` | All | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ |
| GET | `/orders/:id` | All | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ |
| PATCH | `/orders/:id` | All | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø–æ —Ä–æ–ª–∏) |
| DELETE | `/orders/:id` | All | –£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø–æ —Ä–æ–ª–∏) |
| POST | `/orders/:id/assign-engineer` | ADMIN, MANAGER | –ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω–∂–µ–Ω–µ—Ä–∞ |
| POST | `/orders/:id/accept` | USER | –ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑ (–∏–Ω–∂–µ–Ω–µ—Ä) |
| POST | `/orders/:id/complete-work` | USER | –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É |
| POST | `/orders/:id/work-sessions` | All | –°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é —Å–µ—Å—Å–∏—é |
| GET | `/orders/:id/work-sessions` | All | –°–ø–∏—Å–æ–∫ —Ä–∞–±–æ—á–∏—Ö —Å–µ—Å—Å–∏–π |
| POST | `/orders/:id/complete` | MANAGER, ADMIN | –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑ |

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (`/api/statistics`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/statistics` | ADMIN, MANAGER | –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| GET | `/statistics/organizations` | ADMIN, MANAGER | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º |
| GET | `/statistics/engineers` | ADMIN | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–Ω–∂–µ–Ω–µ—Ä–∞–º |
| GET | `/statistics/engineer/detailed` | ADMIN | –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω–∂–µ–Ω–µ—Ä–∞ |

## üí∞ –í—ã–ø–ª–∞—Ç—ã (`/api/salary-payments`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/salary-payments` | ADMIN, MANAGER | –°–ø–∏—Å–æ–∫ –≤—ã–ø–ª–∞—Ç |
| POST | `/salary-payments` | ADMIN, MANAGER | –°–æ–∑–¥–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É |
| GET | `/salary-payments/:id` | ADMIN, MANAGER | –ü–æ–ª—É—á–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É |
| PATCH | `/salary-payments/:id` | ADMIN, MANAGER | –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É |
| DELETE | `/salary-payments/:id` | ADMIN, MANAGER | –£–¥–∞–ª–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É |
| POST | `/salary-payments/:id/mark-paid` | ADMIN, MANAGER | –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—É—é |
| POST | `/salary-payments/:id/mark-cancelled` | ADMIN, MANAGER | –û—Ç–º–µ–Ω–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É |
| GET | `/salary-payments/engineer/:engineerId` | ADMIN, MANAGER | –í—ã–ø–ª–∞—Ç—ã –∏–Ω–∂–µ–Ω–µ—Ä–∞ |

## üë®‚Äçüíº –ò–Ω–∂–µ–Ω–µ—Ä-–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¢–∞—Ä–∏—Ñ—ã (`/api/engineer-organization-rates`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/engineer-organization-rates` | ADMIN, MANAGER | –°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤ |
| POST | `/engineer-organization-rates` | ADMIN, MANAGER | –°–æ–∑–¥–∞—Ç—å —Ç–∞—Ä–∏—Ñ |
| GET | `/engineer-organization-rates/:id` | ADMIN, MANAGER | –ü–æ–ª—É—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ |
| PATCH | `/engineer-organization-rates/:id` | ADMIN, MANAGER | –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞—Ä–∏—Ñ |
| DELETE | `/engineer-organization-rates/:id` | ADMIN, MANAGER | –£–¥–∞–ª–∏—Ç—å —Ç–∞—Ä–∏—Ñ |
| GET | `/engineer-organization-rates/by-engineer/:engineerId` | ADMIN, MANAGER | –¢–∞—Ä–∏—Ñ—ã –∏–Ω–∂–µ–Ω–µ—Ä–∞ |

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (`/api/notifications`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/notifications` | All | –°–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| GET | `/notifications/unread-count` | All | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö |
| POST | `/notifications/:id/mark-read` | All | –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ |
| POST | `/notifications/mark-all-read` | All | –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ |

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (`/api/settings`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/settings` | ADMIN, MANAGER | –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| PATCH | `/settings` | MANAGER | –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

## üìÑ –§–∞–π–ª—ã (`/api/files`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| POST | `/files/upload` | All | –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª |
| GET | `/files` | All | –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ |
| GET | `/files/:id` | All | –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª |
| DELETE | `/files/:id` | All | –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª |
| GET | `/files/:id/download` | All | –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª |

## üìà –û—Ç—á–µ—Ç—ã (`/api/reports`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/reports/orders` | ADMIN, MANAGER | –û—Ç—á–µ—Ç –ø–æ –∑–∞–∫–∞–∑–∞–º |
| GET | `/reports/salary` | ADMIN, MANAGER | –û—Ç—á–µ—Ç –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–∞–º |

## üì§ –≠–∫—Å–ø–æ—Ä—Ç (`/api/export`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/export/orders` | All | –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ |

## üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (`/api/backup`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/backup` | ADMIN | –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤ |
| POST | `/backup` | ADMIN | –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø |
| GET | `/backup/:id/download` | ADMIN | –°–∫–∞—á–∞—Ç—å –±—ç–∫–∞–ø |

## üìù –õ–æ–≥–∏ (`/api/logs`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|------|----------|
| GET | `/logs` | ADMIN | –°–ø–∏—Å–æ–∫ –ª–æ–≥–æ–≤ |

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. **RolesGuard** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é —Ä–æ–ª–µ–π:
   - ADMIN –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è
   - MANAGER –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è MANAGER –∏ USER
   - USER –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è

2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
   - USER –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã
   - MANAGER –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑—ã —Å–≤–æ–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   - ADMIN –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   - –ò–Ω–∂–µ–Ω–µ—Ä –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º–∏ –µ–º—É –∑–∞–∫–∞–∑–∞–º–∏
   - –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–∫–∞–∑–∞–º–∏ —Å–≤–æ–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

