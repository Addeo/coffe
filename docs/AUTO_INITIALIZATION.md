# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç:

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend** (`AuthModule.onModuleInit`):
   - –ñ–¥–µ—Ç 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
   - –í—ã–∑—ã–≤–∞–µ—Ç `initializeAdmin()` –∏–∑ `AuthService`
   - –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: admin, manager, engineer
   - –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç:**
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –µ–≥–æ —Ä–æ–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π

### –ü–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

- **Admin:** `admin@coffee.com` / `admin123`
- **Manager:** `manager@coffee.com` / `manager123`
- **Engineer:** `engineer@coffee.com` / `engineer123`

## üìã –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –í–æ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞:

1. **MySQL –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –∏ –∂–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (–¥–æ 60 —Å–µ–∫—É–Ω–¥)
2. **–ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è SQL –º–∏–≥—Ä–∞—Ü–∏–∏** –∏–∑ `backend/migrations/*_add_*.sql`:
   - `004_add_role_hierarchy_fields.sql` - –ø–æ–ª—è –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ä–æ–ª–µ–π
   - `005_add_order_work_execution_fields.sql` - –ø–æ–ª—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç
   - –î—Ä—É–≥–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –µ—Å—Ç—å

3. **–ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è backend**, –∫–æ—Ç–æ—Ä—ã–π:
   - –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MySQL
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—á–µ—Ä–µ–∑ `AuthModule.onModuleInit`)

### –í–∞–∂–Ω–æ:

- –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–ø–µ—Ä–µ–¥** –∑–∞–ø—É—Å–∫–æ–º backend
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è **–ø–æ—Å–ª–µ** –∑–∞–ø—É—Å–∫–∞ backend (–≤ `onModuleInit`)
- –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫, —ç—Ç–æ –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend:

```bash
docker logs coffee_backend_fallback | grep -E "(Auto-initializing|Default users|Migrations)"
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üîÑ Auto-initializing default users...
‚úÖ Default users initialized: { admin: 'created/updated', manager: 'created/updated', engineer: 'created/updated' }
üìù Default passwords: { admin: 'admin123', manager: 'manager123', engineer: 'engineer123' }
```

## üõ†Ô∏è –†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞, –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
curl http://YOUR_VPS_IP:3001/api/auth/init-admin
```

–ò–ª–∏ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞:
```
http://YOUR_VPS_IP:3001/api/auth/init-admin
```

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤–∞ (MySQL —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è)
2. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
3. –¢–∞–±–ª–∏—Ü–∞ `users` –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ MySQL: `docker logs coffee_mysql_fallback`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend: `docker logs coffee_backend_fallback`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å
4. –í—ã–∑–æ–≤–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ API

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ –¥–µ–ø–ª–æ–π-–ø–∞–∫–µ—Ç
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ MySQL
3. –û—à–∏–±–∫–∏ –≤ SQL-—Å–∫—Ä–∏–ø—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `backend/migrations/` –≤–∫–ª—é—á–µ–Ω –≤ `.github/workflows/deploy-with-fallback.yml`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ MySQL
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é:

```bash
docker exec -i coffee_mysql_fallback mysql \
  -u${MYSQL_USER} \
  -p${MYSQL_PASSWORD} \
  ${MYSQL_DATABASE} < backend/migrations/004_add_role_hierarchy_fields.sql
```

## üìù –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–µ:

1. ‚úÖ MySQL –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. ‚úÖ –ñ–¥–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ MySQL (–¥–æ 60 —Å–µ–∫)
3. ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ SQL
4. ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º backend
5. ‚úÖ Backend –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MySQL
6. ‚úÖ `AuthModule.onModuleInit` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—á–µ—Ä–µ–∑ 5 —Å–µ–∫ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞)
7. ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

