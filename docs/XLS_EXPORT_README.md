# Экспорт заказов в Excel (XLS)

## Что добавлено

Добавлен функционал экспорта заказов в формат Excel (.xlsx) с полной финансовой информацией.

## Как использовать

1. Откройте страницу **Заказы** в приложении
2. При необходимости примените фильтры (по статусу, поиск и т.д.)
3. Нажмите кнопку **"Скачать XLS"** в правом верхнем углу
4. Файл автоматически загрузится в папку загрузок

## Что включено в экспорт

Excel файл содержит следующие данные по каждому заказу:

### Основная информация

- ID заказа
- Название заказа
- Организация-заказчик
- Инженер
- Статус

### Тарифы и ставки

- Ставка оплаты от организации (₽/час)
- Коэффициент переработки организации
- Ставка оплаты инженера (₽/час)
- Ставка переработки инженера (₽/час)

### Часы работы

- Обычные часы
- Часы переработки
- Всего часов

### Финансовые данные

- Сумма к оплате от организации (₽)
- Оплата инженеру за работу (₽)
- Доплата за автомобиль (₽)
- Всего к оплате инженеру (₽)
- **ДОХОД (₽)** - разница между оплатой от организации и оплатой инженеру

### Даты

- Дата создания
- Дата начала работ
- Дата завершения

## Имя файла

Файл сохраняется с именем: `orders_export_YYYY-MM-DD.xlsx`

Например: `orders_export_2025-10-16.xlsx`

## Особенности

✅ Экспортируются только видимые/отфильтрованные заказы
✅ Автоматический расчёт итоговых значений (часы, доход)
✅ Удобная ширина колонок для чтения
✅ Корректная обработка отсутствующих данных
✅ Уведомление об успешном экспорте

## Технические детали

**Библиотека**: xlsx (SheetJS)
**Формат**: Excel 2007+ (.xlsx)
**Лист**: "Заказы"

## Изменённые файлы

1. `frontend/package.json` - добавлена зависимость `xlsx`
2. `frontend/src/app/pages/orders/orders.component.ts` - добавлен метод `exportToExcel()`
3. `frontend/src/app/pages/orders/orders.component.html` - добавлена кнопка "Скачать XLS"

## Примечания

- Экспорт происходит на стороне клиента (в браузере)
- Не требует дополнительных запросов к серверу
- Работает с любым количеством заказов
- Даты форматируются в российском формате (дд.мм.гггг)
