# üö® –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï: –°–∞–π—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## –ü—Ä–æ–±–ª–µ–º–∞

–°–∞–π—Ç—ã **https://coffe-ug.ru** –∏ **http://coffe-ug.ru** –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è Cloudflare Tunnel, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö 80/443. Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–æ—Ä—Ç–∞—Ö (4000 –∏ 3001), –Ω–æ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç

### 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –° –≤–∞—à–µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
scp nginx-host.conf setup-nginx-ssl.sh root@your-server-ip:/root/coffe/
```

### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@your-server-ip
cd /root/coffe
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É

```bash
chmod +x setup-nginx-ssl.sh
sudo ./setup-nginx-ssl.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Nginx
- ‚úÖ –ü–æ–ª—É—á–∏—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç reverse proxy (80/443 ‚Üí 4000/3001)
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç Nginx

### 4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
docker-compose -f docker-compose.prod.yml up -d
docker ps
```

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä—ã—Ç—å https://coffe-ug.ru - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å! üéâ

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ

**–î–æ:**

```
Internet (Port 80/443) ‚ùå ‚Üí –ù–∏—á–µ–≥–æ –Ω–µ —Å–ª—É—à–∞–µ—Ç
                        ‚ùå ‚Üí Docker —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 4000/3001
```

**–ü–æ—Å–ª–µ:**

```
Internet (Port 80/443)
    ‚Üì
  Nginx (Host) ‚úÖ –°–ª—É—à–∞–µ—Ç –Ω–∞ 80/443
    ‚îú‚Üí Frontend: localhost:4000 ‚úÖ
    ‚îî‚Üí Backend: localhost:3001 ‚úÖ
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç?
systemctl status nginx

# –ü–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã?
netstat -tulpn | grep -E '(80|443)'

# Docker —Ä–∞–±–æ—Ç–∞–µ—Ç?
docker ps

# –¢–µ—Å—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏
curl -I https://coffe-ug.ru
```

## üÜò –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ø–æ—Ä—Ç—ã
sudo netstat -tulpn | grep -E '(80|443)'

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
sudo systemctl stop apache2  # –µ—Å–ª–∏ –µ—Å—Ç—å
```

### –ü—Ä–æ–±–ª–µ–º–∞: DNS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS
dig coffe-ug.ru

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ A-–∑–∞–ø–∏—Å—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
```

### –ü—Ä–æ–±–ª–µ–º–∞: Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç

```bash
# –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

### –ü—Ä–æ–±–ª–µ–º–∞: Docker –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose -f docker-compose.prod.yml restart

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker logs coffee_frontend_prod
docker logs coffee_backend_prod
```

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

–°–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª `NGINX_SETUP_GUIDE.md` –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

## üîß –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (debug)

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ backend –æ—Ç–≤–µ—á–∞–µ—Ç
curl http://localhost:3001/api/test

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ frontend –æ—Ç–≤–µ—á–∞–µ—Ç
curl http://localhost:4000

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# 4. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Nginx
sudo tail -f /var/log/nginx/coffe-ug.ru-error.log
```

## ‚ú® –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–°–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω:

- ‚úÖ https://coffe-ug.ru (HTTPS, –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
- ‚úÖ http://coffe-ug.ru (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ HTTPS)
- ‚úÖ API: https://coffe-ug.ru/api/*
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤)

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5-10 –º–∏–Ω—É—Ç  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Root-–¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É  
**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** ‚úÖ SSL/TLS, ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
