# üß™ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ APK

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

1. **http-exception.filter.ts** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –¥–ª—è `exception.stack`
2. **organizations.controller.ts** ‚Äî –¥—É–±–ª–∏—Ä—É—é—â–∏–π –∏–º–ø–æ—Ä—Ç —É–∂–µ —É–¥–∞–ª–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 20 –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞)

## üìã –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É APK –ª–æ–∫–∞–ª—å–Ω–æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç

```bash
./test-apk-locally.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- –ö–æ–ø–∏—Ä—É–µ—Ç APK –≤ `backend/app-debug.apk`
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/app/version`
- –°–∫–∞—á–∏–≤–∞–µ—Ç APK –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é

#### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å backend –ª–æ–∫–∞–ª—å–Ω–æ

```bash
cd backend
npm run start:dev
```

Backend –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ `http://localhost:3001`

#### –®–∞–≥ 2: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å APK –≤ backend –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
cp ./apk-builds/app-debug-1.0.2.apk backend/app-debug.apk
```

Backend –∏—â–µ—Ç —Ñ–∞–π–ª –ø–æ –ø—É—Ç–∏: `backend/app-debug.apk` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `dist/main.js` —ç—Ç–æ `../../app-debug.apk`)

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å version endpoint

```bash
curl http://localhost:3001/api/app/version
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{
  "version": "1.0.2",
  "downloadUrl": "http://localhost:3001/app-debug.apk",
  "required": false,
  "releaseNotes": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫."
}
```

#### –®–∞–≥ 4: –°–∫–∞—á–∞—Ç—å APK

**–ß–µ—Ä–µ–∑ curl:**

```bash
curl -O http://localhost:3001/app-debug.apk
```

**–í –±—Ä–∞—É–∑–µ—Ä–µ:**
–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3001/app-debug.apk

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä:**

```bash
# –û—Ä–∏–≥–∏–Ω–∞–ª
ls -lh ./apk-builds/app-debug-1.0.2.apk

# –°–∫–∞—á–∞–Ω–Ω—ã–π
ls -lh ./app-debug.apk

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:3001/app-debug.apk
2. **–î–æ–ª–∂–Ω–æ:** –ù–∞—á–∞—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `app-debug.apk`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ~4.7 MB

## üìä –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

- [ ] Backend –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] APK —Ñ–∞–π–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ `backend/app-debug.apk`
- [ ] `/api/app/version` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `downloadUrl`
- [ ] `/app-debug.apk` –¥–æ—Å—Ç—É–ø–µ–Ω (HTTP 200)
- [ ] –§–∞–π–ª —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- [ ] –†–∞–∑–º–µ—Ä —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Backend is not running"

```bash
cd backend
npm install
npm run start:dev
```

### –ü—Ä–æ–±–ª–µ–º–∞: "404 - Cannot GET /app-debug.apk"

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ

**–†–µ—à–µ–Ω–∏–µ:**

```bash
cp ./apk-builds/app-debug-1.0.2.apk backend/app-debug.apk
```

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend (Ctrl+C –∏ `npm run start:dev`)

### –ü—Ä–æ–±–ª–µ–º–∞: "APK file not found at: ..."

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –≤ –ª–æ–≥–∞—Ö backend:**

```bash
# –í –ª–æ–≥–∞—Ö backend –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# APK file path: /path/to/backend/app-debug.apk
```

**–ò—Å–ø—Ä–∞–≤–∏—Ç—å:** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—É—Ç—å

## üéØ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
cd backend && npm run start:dev &
BACKEND_PID=$!

# 2. –ü–æ–¥–æ–∂–¥–∞—Ç—å –∑–∞–ø—É—Å–∫–∞
sleep 5

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç
cd ..
./test-apk-locally.sh

# 4. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backend
kill $BACKEND_PID
```

## üìù –õ–æ–≥–∏ backend

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ backend –ª–æ–∫–∞–ª—å–Ω–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
APK file path: /path/to/backend/app-debug.apk
Checking if APK exists at: /path/to/backend/app-debug.apk
‚úÖ APK file found, size: 4948480 bytes
```

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ APK:

```
üì• APK download request: /app-debug.apk ‚Üí /app-debug.apk
üìÅ Looking for APK at: /path/to/backend/app-debug.apk
‚úÖ Serving APK file, size: 4948480 bytes
‚úÖ APK file sent successfully
```

---

–ì–æ—Ç–æ–≤–æ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! üöÄ
