<div class="backups-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <mat-icon class="page-icon">backup</mat-icon>
        <div>
          <h1>–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h1>
          <p class="subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</p>
        </div>
      </div>

      <div class="header-actions">
        <input
          #fileInput
          type="file"
          accept=".sql,.sqlite"
          style="display: none"
          (change)="onFileSelected($event)"
        />

        <button
          mat-raised-button
          color="accent"
          (click)="fileInput.click()"
          [disabled]="isLoading() || isUploading()"
        >
          <mat-icon>upload_file</mat-icon>
          –ó–∞–≥—Ä—É–∑–∏—Ç—å –±—ç–∫–∞–ø
        </button>

        <button
          mat-raised-button
          color="primary"
          (click)="createBackup()"
          [disabled]="isLoading() || isCreating()"
        >
          <mat-icon>add</mat-icon>
          @if (isCreating()) {
            <mat-spinner diameter="20" class="inline-spinner"></mat-spinner>
            –°–æ–∑–¥–∞–Ω–∏–µ...
          } @else {
            –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
          }
        </button>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon color="primary">backup</mat-icon>
          <div class="stat-details">
            <h3>{{ backups().length }}</h3>
            <p>–í—Å–µ–≥–æ –±—ç–∫–∞–ø–æ–≤</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon color="accent">storage</mat-icon>
          <div class="stat-details">
            <h3>{{ totalBackupSize() }}</h3>
            <p>–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon color="warn">schedule</mat-icon>
          <div class="stat-details">
            <h3>–ï–∂–µ–º–µ—Å—è—á–Ω–æ</h3>
            <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card action-card" (click)="cleanupOldBackups()">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon>delete_sweep</mat-icon>
          <div class="stat-details">
            <h3>–û—á–∏—Å—Ç–∏—Ç—å</h3>
            <p>–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>
  }

  <!-- Upload Progress -->
  @if (isUploading()) {
    <mat-card class="upload-progress-card">
      <mat-card-content>
        <div class="upload-progress">
          <mat-icon>cloud_upload</mat-icon>
          <div class="progress-details">
            <h3>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</h3>
            <mat-progress-bar mode="indeterminate" color="accent"></mat-progress-bar>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  }

  <!-- Empty State -->
  @if (!isLoading() && !hasBackups()) {
    <mat-card class="empty-state">
      <mat-card-content>
        <mat-icon>backup</mat-icon>
        <h2>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤</h2>
        <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –±—ç–∫–∞–ø –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π</p>
        <div class="empty-state-actions">
          <button mat-raised-button color="primary" (click)="createBackup()">
            <mat-icon>add</mat-icon>
            –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
          </button>
          <button mat-raised-button color="accent" (click)="fileInput.click()">
            <mat-icon>upload_file</mat-icon>
            –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  }

  <!-- Backups List -->
  @if (!isLoading() && hasBackups()) {
    <div class="backups-grid">
      @for (backup of backups(); track backup.name) {
        <mat-card class="backup-card">
          <mat-card-header>
            <mat-icon mat-card-avatar [color]="getBackupColor(backup.type)">
              {{ getBackupIcon(backup.type) }}
            </mat-icon>
            <mat-card-title>{{ backup.name }}</mat-card-title>
            <mat-card-subtitle>{{ getRelativeTime(backup.createdAt) }}</mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <div class="backup-details">
              <div class="detail-row">
                <mat-icon>calendar_today</mat-icon>
                <span>{{ formatDate(backup.createdAt) }}</span>
              </div>
              <div class="detail-row">
                <mat-icon>storage</mat-icon>
                <span>{{ backup.sizeFormatted }}</span>
              </div>
              <div class="detail-row">
                <mat-icon>category</mat-icon>
                <span>
                  <mat-chip [color]="getBackupColor(backup.type)">
                    {{ backup.type === 'mysql' ? 'MySQL' : 'SQLite' }}
                  </mat-chip>
                </span>
              </div>
            </div>
          </mat-card-content>

          <mat-card-actions>
            <button
              mat-button
              color="primary"
              (click)="downloadBackup(backup)"
              matTooltip="–°–∫–∞—á–∞—Ç—å –±—ç–∫–∞–ø"
            >
              <mat-icon>download</mat-icon>
              –°–∫–∞—á–∞—Ç—å
            </button>

            <button
              mat-button
              color="accent"
              (click)="restoreBackup(backup)"
              matTooltip="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞"
            >
              <mat-icon>restore</mat-icon>
              –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
            </button>

            <button
              mat-button
              color="warn"
              (click)="deleteBackup(backup)"
              matTooltip="–£–¥–∞–ª–∏—Ç—å –±—ç–∫–∞–ø"
            >
              <mat-icon>delete</mat-icon>
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </div>
  }

  <!-- Info Section -->
  <mat-card class="info-card">
    <mat-card-header>
      <mat-icon mat-card-avatar color="primary">info</mat-icon>
      <mat-card-title>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—ç–∫–∞–ø–∞—Ö</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="info-section">
        <h3>üìÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã</h3>
        <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –±—ç–∫–∞–ø 1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 2:00 –Ω–æ—á–∏</p>

        <h3>üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ</h3>
        <p>–ë—ç–∫–∞–ø—ã —Ö—Ä–∞–Ω—è—Ç—Å—è 30 –¥–Ω–µ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å—Ä–æ–∫–∞</p>

        <h3>‚ö†Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</h3>
        <p>–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–µ–∫—É—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º</p>

        <h3>üì§ –ó–∞–≥—Ä—É–∑–∫–∞</h3>
        <p>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã .sql (MySQL) –∏ .sqlite (SQLite). –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 100MB</p>

        <h3>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
        <p>–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –±—ç–∫–∞–ø–∞–º–∏. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è</p>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Documentation Links -->
  <mat-card class="docs-card">
    <mat-card-content>
      <h3>
        <mat-icon>menu_book</mat-icon>
        –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
      </h3>
      <p>–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –±—ç–∫–∞–ø–∞–º–∏:</p>
      <ul>
        <li>BACKUP_QUICK_START.md - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</li>
        <li>docs/BACKUP_BEST_PRACTICES.md - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
        <li>docs/VM_MANAGEMENT_BACKUP_README.md - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ VM</li>
      </ul>
    </mat-card-content>
  </mat-card>
</div>

