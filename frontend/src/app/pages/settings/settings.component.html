<div class="settings-container">
  <div class="header">
    <h1>Настройки системы</h1>
    <p>Настройка системных параметров и предпочтений</p>
  </div>

  <form [formGroup]="settingsForm" (ngSubmit)="saveSettings()">
    <div class="settings-grid">
      <!-- General Settings -->
      <mat-card class="settings-section">
        <mat-card-header>
          <mat-card-title>Общие настройки</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Название сайта</mat-label>
            <input matInput formControlName="siteName" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Тема оформления</mat-label>
            <mat-icon matPrefix>{{ themes.find(t => t.value === currentTheme())?.icon || 'brightness_auto' }}</mat-icon>
            <mat-select formControlName="theme">
              <mat-option *ngFor="let theme of themes" [value]="theme.value">
                <mat-icon class="theme-option-icon">{{ theme.icon }}</mat-icon>
                <span>{{ theme.label }}</span>
              </mat-option>
            </mat-select>
            <mat-hint *ngIf="currentTheme() === 'auto'">
              Сейчас применена {{ effectiveTheme() === 'dark' ? 'темная' : 'светлая' }} тема
            </mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Язык</mat-label>
            <mat-select formControlName="language">
              <mat-option *ngFor="let lang of languages" [value]="lang.value">
                {{ lang.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Элементов на странице</mat-label>
            <input matInput type="number" formControlName="itemsPerPage" />
          </mat-form-field>
        </mat-card-content>
      </mat-card>

      <!-- Notifications -->
      <mat-card class="settings-section">
        <mat-card-header>
          <mat-card-title>Уведомления</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="toggle-setting">
            <span>Email уведомления</span>
            <mat-slide-toggle formControlName="emailNotifications"></mat-slide-toggle>
          </div>

          <div class="toggle-setting">
            <span>Push уведомления</span>
            <mat-slide-toggle formControlName="pushNotifications"></mat-slide-toggle>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- System Settings -->
      <mat-card class="settings-section">
        <mat-card-header>
          <mat-card-title>Системные настройки</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="toggle-setting">
            <span>Автосохранение</span>
            <mat-slide-toggle formControlName="autoSave"></mat-slide-toggle>
          </div>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Часовой пояс</mat-label>
            <input matInput formControlName="timezone" />
          </mat-form-field>
        </mat-card-content>
      </mat-card>

      <!-- Actions -->
      <mat-card class="settings-section actions-section">
        <mat-card-header>
          <mat-card-title>Действия</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="action-buttons">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="isLoading() || settingsForm.invalid"
            >
              <mat-icon *ngIf="isLoading()">refresh</mat-icon>
              <mat-icon *ngIf="!isLoading()">save</mat-icon>
              {{ isLoading() ? 'Сохранение...' : 'Сохранить настройки' }}
            </button>

            <button mat-button type="button" (click)="resetToDefaults()">
              <mat-icon>restore</mat-icon>
              <span>Сбросить к умолчанию</span>
            </button>

            <button mat-button type="button" (click)="exportSettings()">
              <mat-icon>download</mat-icon>
              <span>Экспорт настроек</span>
            </button>

            <button mat-button type="button" (click)="importSettings()">
              <mat-icon>upload</mat-icon>
              <span>Импорт настроек</span>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </form>
</div>
