<div class="orders-container">
  <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
  <div class="stats-switcher">
    <mat-button-toggle-group [(ngModel)]="statsView" aria-label="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏">
      <mat-button-toggle value="compact">üìä –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è</mat-button-toggle>
      <mat-button-toggle value="charts">üìà –° –≥—Ä–∞—Ñ–∏–∫–∞–º–∏</mat-button-toggle>
      <mat-button-toggle value="progress">üìâ –° –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <!-- –í–ê–†–ò–ê–ù–¢ 1: –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ -->
  <mat-card class="stats-card-unified" *ngIf="statsView === 'compact'">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>bar_chart</mat-icon>
        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
      </mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <div class="stats-table">
        <!-- –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ -->
        <div class="stats-section">
          <h3>–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º</h3>
          <div class="stats-row">
            <div class="stat-item">
              <mat-icon color="primary">assignment</mat-icon>
              <span class="label">–í—Å–µ–≥–æ:</span>
              <span class="value">{{ orderStats().total }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>schedule</mat-icon>
              <span class="label">–û–∂–∏–¥–∞—é—Ç:</span>
              <span class="value">{{ orderStats().waiting }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>person_add</mat-icon>
              <span class="label">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ:</span>
              <span class="value">{{ orderStats().processing }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>build</mat-icon>
              <span class="label">–í —Ä–∞–±–æ—Ç–µ:</span>
              <span class="value">{{ orderStats().working }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>visibility</mat-icon>
              <span class="label">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ:</span>
              <span class="value">{{ orderStats().review }}</span>
            </div>
            <div class="stat-item">
              <mat-icon style="color: #4caf50">check_circle</mat-icon>
              <span class="label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ:</span>
              <span class="value">{{ orderStats().completed }}</span>
            </div>
          </div>
        </div>

        <mat-divider></mat-divider>

        <!-- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤ -->
        <div class="stats-section">
          <h3>–ü–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º</h3>
          <div class="stats-row">
            <div class="stat-item">
              <mat-icon>touch_app</mat-icon>
              <span class="label">–í—Ä—É—á–Ω—É—é:</span>
              <span class="value">{{ orderStats().bySource.manual }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>settings</mat-icon>
              <span class="label">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:</span>
              <span class="value">{{ orderStats().bySource.automatic }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>email</mat-icon>
              <span class="label">–ò–∑ Email:</span>
              <span class="value">{{ orderStats().bySource.email }}</span>
            </div>
            <div class="stat-item">
              <mat-icon>api</mat-icon>
              <span class="label">–ß–µ—Ä–µ–∑ API:</span>
              <span class="value">{{ orderStats().bySource.api }}</span>
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- –í–ê–†–ò–ê–ù–¢ 2: –° –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ -->
  <mat-card class="stats-card-charts" *ngIf="statsView === 'charts'">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>bar_chart</mat-icon>
        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
      </mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <div class="charts-container">
        <!-- –ì—Ä–∞—Ñ–∏–∫ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º (Donut Chart) -->
        <div class="chart-section">
          <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h3>
          <div class="chart-wrapper">
            <canvas
              baseChart
              [data]="statusChartData"
              [options]="doughnutChartOptions"
              [type]="'doughnut'"
            ></canvas>
          </div>
          <div class="chart-stats">
            <div class="stat-badge" *ngFor="let stat of statusStats">
              <span class="badge-color" [style.background-color]="stat.color"></span>
              <span class="badge-label">{{ stat.label }}:</span>
              <span class="badge-value">{{ stat.value }}</span>
            </div>
          </div>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (Bar Chart) -->
        <div class="chart-section">
          <h3>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤</h3>
          <div class="chart-wrapper">
            <canvas
              baseChart
              [data]="sourceChartData"
              [options]="barChartOptions"
              [type]="'bar'"
            ></canvas>
          </div>
        </div>
      </div>

      <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div class="total-stats">
        <div class="total-item">
          <mat-icon color="primary">assignment</mat-icon>
          <div>
            <div class="total-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
            <div class="total-value">{{ orderStats().total }}</div>
          </div>
        </div>
        <div class="total-item">
          <mat-icon color="accent">build</mat-icon>
          <div>
            <div class="total-label">–í —Ä–∞–±–æ—Ç–µ</div>
            <div class="total-value">{{ orderStats().working }}</div>
          </div>
        </div>
        <div class="total-item">
          <mat-icon style="color: #4caf50">check_circle</mat-icon>
          <div>
            <div class="total-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
            <div class="total-value">{{ orderStats().completed }}</div>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- –í–ê–†–ò–ê–ù–¢ 3: –° –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏ -->
  <mat-card class="stats-card-progress" *ngIf="statsView === 'progress'">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>bar_chart</mat-icon>
        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
      </mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <!-- –û–±—â–∏–π —Å—á—ë—Ç—á–∏–∫ -->
      <div class="total-counter">
        <mat-icon>assignment</mat-icon>
        <div class="counter-text">
          <span class="counter-value">{{ orderStats().total }}</span>
          <span class="counter-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</span>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º -->
      <div class="progress-stats">
        <div class="progress-item">
          <div class="progress-header">
            <div class="progress-label-group">
              <mat-icon>schedule</mat-icon>
              <span class="progress-label">–û–∂–∏–¥–∞—é—Ç</span>
            </div>
            <span class="progress-value">{{ orderStats().waiting }}</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(orderStats().waiting)"
            color="warn"
          ></mat-progress-bar>
        </div>

        <div class="progress-item">
          <div class="progress-header">
            <div class="progress-label-group">
              <mat-icon>person_add</mat-icon>
              <span class="progress-label">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</span>
            </div>
            <span class="progress-value">{{ orderStats().processing }}</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(orderStats().processing)"
          ></mat-progress-bar>
        </div>

        <div class="progress-item">
          <div class="progress-header">
            <div class="progress-label-group">
              <mat-icon>build</mat-icon>
              <span class="progress-label">–í —Ä–∞–±–æ—Ç–µ</span>
            </div>
            <span class="progress-value">{{ orderStats().working }}</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(orderStats().working)"
            color="accent"
          ></mat-progress-bar>
        </div>

        <div class="progress-item">
          <div class="progress-header">
            <div class="progress-label-group">
              <mat-icon>visibility</mat-icon>
              <span class="progress-label">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>
            </div>
            <span class="progress-value">{{ orderStats().review }}</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(orderStats().review)"
            color="warn"
          ></mat-progress-bar>
        </div>

        <div class="progress-item">
          <div class="progress-header">
            <div class="progress-label-group">
              <mat-icon style="color: #4caf50">check_circle</mat-icon>
              <span class="progress-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>
            </div>
            <span class="progress-value">{{ orderStats().completed }}</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(orderStats().completed)"
            color="primary"
          ></mat-progress-bar>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ -->
      <div class="sources-compact">
        <h4>–ü–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º</h4>
        <div class="sources-row">
          <div class="source-chip">
            <mat-icon>touch_app</mat-icon>
            <span>–í—Ä—É—á–Ω—É—é: {{ orderStats().bySource.manual }}</span>
          </div>
          <div class="source-chip">
            <mat-icon>settings</mat-icon>
            <span>–ê–≤—Ç–æ: {{ orderStats().bySource.automatic }}</span>
          </div>
          <div class="source-chip">
            <mat-icon>email</mat-icon>
            <span>Email: {{ orderStats().bySource.email }}</span>
          </div>
          <div class="source-chip">
            <mat-icon>api</mat-icon>
            <span>API: {{ orderStats().bySource.api }}</span>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- OLD: Statistics Cards - Desktop –≤–µ—Ä—Å–∏—è (–±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞) -->
  <div class="stats-grid desktop-stats" *ngIf="false">
    <!-- Export Statistics Button -->
    <mat-card class="stat-card export-card" *ngIf="canExportOrders">
      <mat-card-content>
        <div class="stat-content export-content">
          <mat-icon class="stat-icon export-icon">download</mat-icon>
          <div class="stat-info">
            <button 
              mat-raised-button 
              color="primary" 
              (click)="exportStatisticsToExcel()"
              class="export-stats-btn">
              <mat-icon>file_download</mat-icon>
              –°–∫–∞—á–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            </button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">assignment</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().total }}</h3>
            <p i18n="@@orders.totalOrders">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">schedule</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().waiting }}</h3>
            <p i18n="@@orders.waiting">–û–∂–∏–¥–∞—é—Ç</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">person_add</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().processing }}</h3>
            <p i18n="@@orders.processing">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">build</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().working }}</h3>
            <p i18n="@@orders.inProgress">–í —Ä–∞–±–æ—Ç–µ</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">visibility</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().review }}</h3>
            <p i18n="@@orders.underReview">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">check_circle</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().completed }}</h3>
            <p i18n="@@orders.completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Statistics Card - –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–í–°–Å –í –û–î–ù–û–ô –ö–ê–†–¢–û–ß–ö–ï) - –°–ö–†–´–¢–û -->
  <mat-card class="mobile-stats mobile-stats-combined" *ngIf="false">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>bar_chart</mat-icon>
        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
      </mat-card-title>
      <div class="mobile-export-btn" *ngIf="canExportOrders">
        <button 
          mat-icon-button 
          color="primary" 
          (click)="exportStatisticsToExcel()"
          matTooltip="–°–∫–∞—á–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É">
          <mat-icon>file_download</mat-icon>
        </button>
      </div>
    </mat-card-header>
    <mat-card-content>
      <!-- –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ -->
      <div class="mobile-stats-section">
        <h4>–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º</h4>
        <div class="mobile-stats-simple">
          <p><strong>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤:</strong> <span class="stat-value">{{ orderStats().total }}</span></p>
          <p><strong>–û–∂–∏–¥–∞—é—Ç:</strong> <span class="stat-value">{{ orderStats().waiting }}</span></p>
          <p><strong>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ:</strong> <span class="stat-value">{{ orderStats().processing }}</span></p>
          <p><strong>–í —Ä–∞–±–æ—Ç–µ:</strong> <span class="stat-value">{{ orderStats().working }}</span></p>
          <p><strong>–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ:</strong> <span class="stat-value">{{ orderStats().review }}</span></p>
          <p><strong>–ó–∞–≤–µ—Ä—à–µ–Ω–æ:</strong> <span class="stat-value">{{ orderStats().completed }}</span></p>
        </div>
      </div>

      <!-- –ü–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º -->
      <div class="mobile-stats-section">
        <h4>–ü–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º</h4>
      <div class="mobile-stats-simple">
          <p><strong>{{ getSourceDisplay('manual') }}:</strong> <span class="stat-value">{{ orderStats().bySource.manual }}</span></p>
          <p><strong>{{ getSourceDisplay('automatic') }}:</strong> <span class="stat-value">{{ orderStats().bySource.automatic }}</span></p>
          <p><strong>{{ getSourceDisplay('email') }}:</strong> <span class="stat-value">{{ orderStats().bySource.email }}</span></p>
          <p><strong>{{ getSourceDisplay('api') }}:</strong> <span class="stat-value">{{ orderStats().bySource.api }}</span></p>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Source Statistics - Desktop - –°–ö–†–´–¢–û -->
  <div class="stats-grid desktop-stats source-stats-grid" *ngIf="false">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">touch_app</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().bySource.manual }}</h3>
            <p>{{ getSourceDisplay('manual') }}</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">settings</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().bySource.automatic }}</h3>
            <p>{{ getSourceDisplay('automatic') }}</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">email</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().bySource.email }}</h3>
            <p>{{ getSourceDisplay('email') }}</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">api</mat-icon>
          <div class="stat-info">
            <h3>{{ orderStats().bySource.api }}</h3>
            <p>{{ getSourceDisplay('api') }}</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Main Content -->
  <mat-card class="main-content">
    <mat-card-header>
      <div class="header">
        <h1 i18n="@@orders.management">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h1>
        <div class="header-actions">
          <mat-form-field class="filter-field">
            <mat-label>–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É</mat-label>
            <mat-select
              [value]="selectedStatus()"
              (selectionChange)="onStatusFilterChange($event.value)"
            >
              <mat-option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</mat-option>
              <mat-option *ngFor="let status of statusOptions" [value]="status">
                {{ getStatusDisplay(status) }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="search-field">
            <mat-label>–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤</mat-label>
            <input
              matInput
              (keyup)="applyFilter($event)"
              placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Ç.–¥."
            />
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>

          <button
            mat-icon-button
            (click)="refreshData()"
            matTooltip="–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"
            aria-label="–û–±–Ω–æ–≤–∏—Ç—å"
          >
            <mat-icon>refresh</mat-icon>
          </button>

          <button
            mat-raised-button
            color="accent"
            (click)="exportToExcel()"
            matTooltip="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Excel"
            aria-label="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel"
            *ngIf="canExportOrders"
          >
            <mat-icon>download</mat-icon>
            <span>–°–∫–∞—á–∞—Ç—å XLS</span>
          </button>

          <button
            mat-raised-button
            color="primary"
            (click)="onCreateOrder()"
            *ngIf="canCreateOrders"
          >
            <mat-icon>add</mat-icon>
            <span>–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</span>
          </button>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div class="loading-container" *ngIf="isLoading()">
        <mat-spinner diameter="40"></mat-spinner>
        <p i18n="@@orders.loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
      </div>

      <div class="table-container" *ngIf="!isLoading()">
        <table mat-table [dataSource]="dataSource" matSort class="orders-table">
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header i18n="@@orders.id">‚Ññ</th>
            <td mat-cell *matCellDef="let order">{{ order.id }}</td>
          </ng-container>

          <!-- Title Column -->
          <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef mat-sort-header i18n="@@orders.title">
              –ù–∞–∑–≤–∞–Ω–∏–µ
            </th>
            <td mat-cell *matCellDef="let order">
              <strong>{{ order.title }}</strong>
              <br />
              <small class="text-muted">{{ order.description }}</small>
            </td>
          </ng-container>

          <!-- Organization Column -->
          <ng-container matColumnDef="organization">
            <th mat-header-cell *matHeaderCellDef mat-sort-header i18n="@@orders.organization">
              –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
            </th>
            <td mat-cell *matCellDef="let order">{{ getOrganizationName(order) }}</td>
          </ng-container>

          <!-- Assigned Engineer Column -->
          <ng-container matColumnDef="assignedEngineer">
            <th mat-header-cell *matHeaderCellDef mat-sort-header i18n="@@orders.engineer">
              –ò–Ω–∂–µ–Ω–µ—Ä
            </th>
            <td mat-cell *matCellDef="let order">
              <div class="engineer-info">
                <div class="assigned-engineer" *ngIf="order.assignedEngineer">
                  <mat-icon class="engineer-icon">engineering</mat-icon>
                  <span class="engineer-name">{{ getEngineerName(order) }}</span>
                </div>
                <div class="no-engineer" *ngIf="!order.assignedEngineer">
                  <mat-icon class="no-engineer-icon">person_off</mat-icon>
                  <span class="no-engineer-text">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</span>
                </div>
                <div class="creator-info">
                  <mat-icon class="creator-icon">person_outline</mat-icon>
                  <small class="text-muted">{{ getCreatorName(order) }}</small>
                </div>
              </div>
            </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>–°—Ç–∞—Ç—É—Å</th>
            <td mat-cell *matCellDef="let order">
              <mat-chip [color]="getStatusColor(order.status)" selected>
                {{ getStatusDisplay(order.status) }}
              </mat-chip>
            </td>
          </ng-container>

          <!-- Created Date Column -->
          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>–°–æ–∑–¥–∞–Ω</th>
            <td mat-cell *matCellDef="let order">{{ order.createdAt | date: 'short' }}</td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>–î–µ–π—Å—Ç–≤–∏—è</th>
            <td mat-cell *matCellDef="let order">
              <!-- Engineer Actions -->
              <button
                mat-raised-button
                color="accent"
                (click)="onAcceptOrder(order)"
                matTooltip="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞—è–≤–∫—É –∏ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É"
                *ngIf="canAcceptOrder(order)"
              >
                <mat-icon>check_circle</mat-icon>
                –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
              </button>

              <button
                mat-raised-button
                color="primary"
                (click)="onCompleteWork(order)"
                matTooltip="–í–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ"
                *ngIf="canCompleteWork(order)"
              >
                <mat-icon>task_alt</mat-icon>
                –í—ã–ø–æ–ª–Ω–∏—Ç—å
              </button>

              <!-- Admin/Manager Actions -->
              <button
                mat-icon-button
                (click)="onEditOrder(order)"
                color="primary"
                matTooltip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑"
                aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                *ngIf="canEditOrder(order)"
              >
                <mat-icon>edit</mat-icon>
              </button>

              <!-- Edit within 24h after completion -->
              <button
                mat-icon-button
                (click)="onEditOrder(order)"
                color="warn"
                matTooltip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ (–¥–æ—Å—Ç—É–ø–Ω–æ 24 —á–∞—Å–∞)"
                aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                *ngIf="canEditCompletedOrder(order)"
              >
                <mat-icon>edit_note</mat-icon>
              </button>

              <button
                mat-button
                [matMenuTriggerFor]="statusMenu"
                color="accent"
                matTooltip="–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å"
                aria-label="–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å"
                *ngIf="canUpdateOrderStatus(order)"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <mat-menu #statusMenu="matMenu">
                <button
                  mat-menu-item
                  *ngFor="let status of getAvailableStatuses(order)"
                  [disabled]="order.status === status"
                  (click)="onUpdateStatus(order, status)"
                >
                  <mat-icon>{{ getStatusIcon(status) }}</mat-icon>
                  <span>{{ getStatusDisplay(status) }}</span>
                </button>
              </mat-menu>

              <button
                mat-icon-button
                (click)="onAssignEngineer(order)"
                [disabled]="order.status === 'completed'"
                color="primary"
                [matTooltip]="order.assignedEngineerId ? '–ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω–∂–µ–Ω–µ—Ä–∞' : '–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω–∂–µ–Ω–µ—Ä–∞'"
                [attr.aria-label]="order.assignedEngineerId ? '–ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω–∂–µ–Ω–µ—Ä–∞' : '–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω–∂–µ–Ω–µ—Ä–∞'"
                *ngIf="canAssignEngineers"
              >
                <mat-icon>{{ order.assignedEngineerId ? 'swap_horiz' : 'person_add' }}</mat-icon>
              </button>

              <button
                mat-icon-button
                (click)="onDeleteOrder(order)"
                color="warn"
                matTooltip="–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑"
                aria-label="–£–¥–∞–ª–∏—Ç—å"
                *ngIf="canDeleteOrders"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>

        <!-- No data message -->
        <div class="no-data" *ngIf="dataSource.data.length === 0">
          <mat-icon>assignment</mat-icon>
          <h3>–ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
          <p>–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–æ–∏—Å–∫–∞, –∏–ª–∏ –∑–∞–∫–∞–∑—ã –µ—â–µ –Ω–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã.</p>
        </div>
      </div>

      <mat-paginator
        [pageSizeOptions]="[5, 10, 20, 50]"
        showFirstLastButtons
        aria-label="–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–æ–≤"
      >
      </mat-paginator>
    </mat-card-content>
  </mat-card>
</div>
