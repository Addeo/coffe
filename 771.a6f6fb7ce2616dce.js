"use strict";(self.webpackChunkcoffee_admin=self.webpackChunkcoffee_admin||[]).push([[771],{3771:(C4,D,d)=>{d.r(D),d.d(D,{OrderEditComponent:()=>E4});var E=d(5841),t=d(4292),C=d(9351),a=d(7199),w=d(4842),f=d(6721),x=d(3505),h=d(5320),j=d(4536),k=d(8802),P=d(7694),v=d(91),R=d(8497),I=d(609),M=d(1084),_=d(8598),A=d(8953),N=d(5720),Y=d(4323),U=d(4755),z=d(5822),y=d(8613),H=d(3667),W=d(6e3),b=d(878);let B=(()=>{class n{constructor(){this.http=(0,t.WQX)(W.Qq),this.apiUrl=`${b.c.apiUrl}/work-sessions`}getWorkSessionById(e){return this.http.get(`${this.apiUrl}/${e}`)}getMyWorkSessions(e,u){let o=`${this.apiUrl}/my/sessions`;const s=[];return e&&s.push(`startDate=${e}`),u&&s.push(`endDate=${u}`),s.length>0&&(o+=`?${s.join("&")}`),this.http.get(o)}createWorkSession(e,u){return this.http.post(`${b.c.apiUrl}/orders/${e}/work-sessions`,u)}getOrderWorkSessions(e){return this.http.get(`${b.c.apiUrl}/orders/${e}/work-sessions`)}updateWorkSession(e,u){return this.http.patch(`${this.apiUrl}/${e}`,u)}deleteWorkSession(e){return this.http.delete(`${this.apiUrl}/${e}`)}calculateSessionsSummary(e){return e.reduce((u,o)=>({totalSessions:u.totalSessions+1,totalHours:u.totalHours+o.regularHours+o.overtimeHours,totalRegularHours:u.totalRegularHours+o.regularHours,totalOvertimeHours:u.totalOvertimeHours+o.overtimeHours,totalPayment:u.totalPayment+o.calculatedAmount,totalCarUsage:u.totalCarUsage+o.carUsageAmount}),{totalSessions:0,totalHours:0,totalRegularHours:0,totalOvertimeHours:0,totalPayment:0,totalCarUsage:0})}formatDateForApi(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}parseDate(e){return e instanceof Date?e:new Date(e)}static{this.\u0275fac=function(u){return new(u||n)}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function X(n,r){if(1&n&&(t.j41(0,"mat-card",7)(1,"mat-card-content")(2,"div",8)(3,"div",9)(4,"div",10),t.EFF(5,"\u0412\u0441\u0435\u0433\u043e \u0432\u044b\u0435\u0437\u0434\u043e\u0432"),t.k0s(),t.j41(6,"div",11),t.EFF(7),t.k0s()(),t.j41(8,"div",9)(9,"div",10),t.EFF(10,"\u0412\u0441\u0435\u0433\u043e \u0447\u0430\u0441\u043e\u0432"),t.k0s(),t.j41(11,"div",11),t.EFF(12),t.k0s()(),t.j41(13,"div",9)(14,"div",10),t.EFF(15,"\u041e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.j41(16,"div",11),t.EFF(17),t.k0s()(),t.j41(18,"div",9)(19,"div",10),t.EFF(20,"\u041f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0430"),t.k0s(),t.j41(21,"div",11),t.EFF(22),t.k0s()(),t.j41(23,"div",9)(24,"div",10),t.EFF(25,"\u041e\u043f\u043b\u0430\u0442\u0430"),t.k0s(),t.j41(26,"div",12),t.EFF(27),t.k0s()(),t.j41(28,"div",9)(29,"div",10),t.EFF(30,"\u0417\u0430 \u043c\u0430\u0448\u0438\u043d\u0443"),t.k0s(),t.j41(31,"div",11),t.EFF(32),t.k0s()()()()()),2&n){const e=t.XpG();t.R7$(7),t.JRh(e.summary.totalSessions),t.R7$(5),t.SpI("",e.formatHours(e.summary.totalHours)," \u0447"),t.R7$(5),t.SpI("",e.formatHours(e.summary.totalRegularHours)," \u0447"),t.R7$(5),t.SpI("",e.formatHours(e.summary.totalOvertimeHours)," \u0447"),t.R7$(5),t.JRh(e.formatCurrency(e.summary.totalPayment)),t.R7$(5),t.JRh(e.formatCurrency(e.summary.totalCarUsage))}}function L(n,r){1&n&&(t.j41(0,"div",13),t.EFF(1,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."),t.k0s())}function V(n,r){if(1&n&&(t.j41(0,"mat-card",14)(1,"mat-card-content")(2,"mat-icon",15),t.EFF(3,"error"),t.k0s(),t.j41(4,"span"),t.EFF(5),t.k0s()()()),2&n){const e=t.XpG();t.R7$(5),t.JRh(e.error)}}function K(n,r){1&n&&(t.j41(0,"div",16)(1,"mat-icon"),t.EFF(2,"event_busy"),t.k0s(),t.j41(3,"p"),t.EFF(4,"\u041d\u0435\u0442 \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u0441\u0435\u0441\u0441\u0438\u0439"),t.k0s(),t.j41(5,"p",17),t.EFF(6,"\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0432\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443"),t.k0s()())}function J(n,r){if(1&n&&(t.j41(0,"mat-card-subtitle"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.Lme(" \u0418\u043d\u0436\u0435\u043d\u0435\u0440: ",null==e.engineer||null==e.engineer.user?null:e.engineer.user.firstName," ",null==e.engineer||null==e.engineer.user?null:e.engineer.user.lastName," ")}}function Q(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit,u=t.XpG();t.R7$(),t.SpI(" ",u.formatHours(e.regularHours)," \u0447 (\u043e\u0431\u044b\u0447\u043d\u044b\u0435) ")}}function Z(n,r){if(1&n&&(t.j41(0,"span",31),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit,u=t.XpG();t.R7$(),t.SpI(" + ",u.formatHours(e.overtimeHours)," \u0447 (\u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0430) ")}}function q(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit,u=t.XpG();t.R7$(),t.SpI(" + \u0417\u0430 \u043c\u0430\u0448\u0438\u043d\u0443: ",u.formatCurrency(e.carUsageAmount)," ")}}function tt(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2).$implicit;t.R7$(),t.SpI("",e.distanceKm," \u043a\u043c")}}function et(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2).$implicit;t.R7$(),t.SpI(" (",e.territoryType,")")}}function nt(n,r){if(1&n&&(t.j41(0,"div",21)(1,"mat-icon"),t.EFF(2,"location_on"),t.k0s(),t.j41(3,"div",22),t.DNE(4,tt,2,1,"span",19)(5,et,2,1,"span",19),t.k0s()()),2&n){const e=t.XpG().$implicit;t.R7$(4),t.Y8G("ngIf",e.distanceKm),t.R7$(),t.Y8G("ngIf",e.territoryType)}}function ut(n,r){if(1&n&&(t.j41(0,"div",21)(1,"mat-icon"),t.EFF(2,"note"),t.k0s(),t.j41(3,"div",22)(4,"strong"),t.EFF(5,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f:"),t.k0s(),t.j41(6,"p",32),t.EFF(7),t.k0s()()()),2&n){const e=t.XpG().$implicit;t.R7$(7),t.JRh(e.notes)}}function ot(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",35),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2).$implicit,s=t.XpG();return t.Njj(s.onEditSession(o))}),t.j41(1,"mat-icon"),t.EFF(2,"edit"),t.k0s(),t.EFF(3," \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c "),t.k0s()}}function rt(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",36),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2).$implicit,s=t.XpG();return t.Njj(s.onDeleteSession(o))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.EFF(3," \u0423\u0434\u0430\u043b\u0438\u0442\u044c "),t.k0s()}}function it(n,r){if(1&n&&(t.j41(0,"mat-card-actions"),t.DNE(1,ot,4,0,"button",33)(2,rt,4,0,"button",34),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",e.canEdit),t.R7$(),t.Y8G("ngIf",e.canDelete)}}function st(n,r){if(1&n&&(t.j41(0,"mat-card",18)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),t.EFF(4,"calendar_today"),t.k0s(),t.EFF(5),t.k0s(),t.DNE(6,J,2,2,"mat-card-subtitle",19),t.k0s(),t.j41(7,"mat-card-content")(8,"div",20)(9,"div",21)(10,"mat-icon"),t.EFF(11,"schedule"),t.k0s(),t.j41(12,"div",22)(13,"strong"),t.EFF(14,"\u0412\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b:"),t.k0s(),t.j41(15,"div",23),t.DNE(16,Q,2,1,"span",19)(17,Z,2,1,"span",24),t.j41(18,"span",25),t.EFF(19),t.k0s()()()(),t.j41(20,"div",21)(21,"mat-icon"),t.EFF(22,"payments"),t.k0s(),t.j41(23,"div",22)(24,"strong"),t.EFF(25,"\u041e\u043f\u043b\u0430\u0442\u0430:"),t.k0s(),t.j41(26,"div",26)(27,"span"),t.EFF(28),t.k0s(),t.DNE(29,q,2,1,"span",19),t.j41(30,"span",27),t.EFF(31),t.k0s()()()(),t.DNE(32,nt,6,2,"div",28)(33,ut,8,1,"div",28),t.j41(34,"div",29)(35,"mat-chip",30),t.EFF(36),t.k0s(),t.j41(37,"mat-chip"),t.EFF(38),t.k0s()()()(),t.DNE(39,it,3,2,"mat-card-actions",19),t.k0s()),2&n){const e=r.$implicit,u=t.XpG();t.R7$(5),t.SpI(" ",u.formatDate(e.workDate)," "),t.R7$(),t.Y8G("ngIf",null==e.engineer?null:e.engineer.user),t.R7$(10),t.Y8G("ngIf",e.regularHours>0),t.R7$(),t.Y8G("ngIf",e.overtimeHours>0),t.R7$(2),t.SpI(" = ",u.formatHours(e.regularHours+e.overtimeHours)," \u0447 "),t.R7$(9),t.SpI("\u0417\u0430 \u0440\u0430\u0431\u043e\u0442\u0443: ",u.formatCurrency(e.calculatedAmount),""),t.R7$(),t.Y8G("ngIf",e.carUsageAmount>0),t.R7$(2),t.SpI(" = ",u.formatCurrency(u.getTotalPayment(e))," "),t.R7$(),t.Y8G("ngIf",e.distanceKm||e.territoryType),t.R7$(),t.Y8G("ngIf",e.notes),t.R7$(2),t.Y8G("color",e.canBeInvoiced?"primary":"warn"),t.R7$(),t.SpI(" ",e.canBeInvoiced?"\u041e\u043f\u043b\u0430\u0447\u0438\u0432\u0430\u0435\u043c\u0430\u044f":"\u041d\u0435 \u043e\u043f\u043b\u0430\u0447\u0438\u0432\u0430\u0435\u043c\u0430\u044f"," "),t.R7$(2),t.JRh("completed"===e.status?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430":"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"),t.R7$(),t.Y8G("ngIf",u.canEdit||u.canDelete)}}let at=(()=>{class n{constructor(){this.workSessionsService=(0,t.WQX)(B),this.canEdit=!1,this.canDelete=!1,this.sessionCreated=new t.bkB,this.sessionUpdated=new t.bkB,this.sessionDeleted=new t.bkB,this.sessions=[],this.summary=null,this.loading=!1,this.error=null}ngOnInit(){this.loadSessions()}loadSessions(){this.orderId&&(this.loading=!0,this.error=null,this.workSessionsService.getOrderWorkSessions(this.orderId).subscribe({next:e=>{this.sessions=e,this.summary=this.workSessionsService.calculateSessionsSummary(e),this.loading=!1},error:e=>{this.error="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438",console.error("Error loading work sessions:",e),this.loading=!1}}))}formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})}formatHours(e){return e.toFixed(2)}formatCurrency(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}onEditSession(e){console.log("Edit session:",e)}onDeleteSession(e){confirm(`\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e \u043e\u0442 ${this.formatDate(e.workDate)}?`)&&this.workSessionsService.deleteWorkSession(e.id).subscribe({next:()=>{this.sessionDeleted.emit(e.id),this.loadSessions()},error:u=>{alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e"),console.error("Error deleting session:",u)}})}getTotalPayment(e){return e.calculatedAmount+e.carUsageAmount}trackBySessionId(e,u){return u.id}static{this.\u0275fac=function(u){return new(u||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-work-session-list"]],inputs:{orderId:"orderId",canEdit:"canEdit",canDelete:"canDelete"},outputs:{sessionCreated:"sessionCreated",sessionUpdated:"sessionUpdated",sessionDeleted:"sessionDeleted"},standalone:!0,features:[t.aNF],decls:9,vars:6,consts:[[1,"work-sessions-container"],[1,"header"],["class","summary-card",4,"ngIf"],["class","loading",4,"ngIf"],["class","error-card",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","session-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"summary-card"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"summary-value","highlight"],[1,"loading"],[1,"error-card"],["color","warn"],[1,"empty-state"],[1,"hint"],[1,"session-card"],[4,"ngIf"],[1,"session-details"],[1,"detail-row"],[1,"detail-content"],[1,"time-breakdown"],["class","overtime",4,"ngIf"],[1,"total"],[1,"payment-breakdown"],[1,"total","highlight"],["class","detail-row",4,"ngIf"],[1,"status-row"],[3,"color"],[1,"overtime"],[1,"notes"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(u,o){1&u&&(t.j41(0,"div",0)(1,"div",1)(2,"h3"),t.EFF(3,"\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438 (\u0432\u044b\u0435\u0437\u0434\u044b)"),t.k0s()(),t.DNE(4,X,33,6,"mat-card",2)(5,L,2,0,"div",3)(6,V,6,1,"mat-card",4)(7,K,7,0,"div",5)(8,st,40,14,"mat-card",6),t.k0s()),2&u&&(t.R7$(4),t.Y8G("ngIf",o.summary&&o.sessions.length>0),t.R7$(),t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",o.error),t.R7$(),t.Y8G("ngIf",!o.loading&&0===o.sessions.length),t.R7$(),t.Y8G("ngForOf",o.sessions)("ngForTrackBy",o.trackBySessionId))},dependencies:[C.MD,C.Sq,C.bT,_.Hu,_.RN,_.YY,_.m2,_.MM,_.Lc,_.dh,h.Hl,h.$z,v.m_,v.An,y.YN,y.Jl,H.w],styles:[".work-sessions-container[_ngcontent-%COMP%]{padding:16px}.work-sessions-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:500}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{margin-bottom:24px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{text-align:center}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:12px;opacity:.9;margin-bottom:4px}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.work-sessions-container[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value.highlight[_ngcontent-%COMP%]{color:gold}.work-sessions-container[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{text-align:center;padding:32px;color:#0009}.work-sessions-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{background-color:#ffebee;margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;color:#c62828}.work-sessions-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:#0009}.work-sessions-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.3;margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}.work-sessions-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p.hint[_ngcontent-%COMP%]{font-size:14px;color:#0006}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]{margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:18px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{margin-top:4px;font-size:14px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#0000008a;margin-top:2px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]{flex:1}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:4px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .time-breakdown[_ngcontent-%COMP%], .work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .payment-breakdown[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;font-size:14px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .time-breakdown[_ngcontent-%COMP%]   .overtime[_ngcontent-%COMP%], .work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .payment-breakdown[_ngcontent-%COMP%]   .overtime[_ngcontent-%COMP%]{color:#ff6b6b}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .time-breakdown[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%], .work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .payment-breakdown[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{font-weight:600;margin-top:4px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .time-breakdown[_ngcontent-%COMP%]   .total.highlight[_ngcontent-%COMP%], .work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .payment-breakdown[_ngcontent-%COMP%]   .total.highlight[_ngcontent-%COMP%]{color:#4caf50;font-size:16px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{margin:8px 0 0;padding:12px;background-color:#f5f5f5;border-radius:4px;font-size:14px;line-height:1.5;white-space:pre-wrap}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:16px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:8px 16px;border-top:1px solid rgba(0,0,0,.12);display:flex;gap:8px}.work-sessions-container[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px;font-size:18px;width:18px;height:18px}"]})}}return n})();var S=d(5211);function ct(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u0414\u0430\u0442\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430 "),t.k0s())}function lt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e "),t.k0s())}function dt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0438\u043d\u0438\u043c\u0443\u043c 0 "),t.k0s())}function mt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 24 "),t.k0s())}function pt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0438\u043d\u0438\u043c\u0443\u043c 0 "),t.k0s())}function gt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 24 "),t.k0s())}function _t(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e "),t.k0s())}function ft(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0438\u043d\u0438\u043c\u0443\u043c 0 "),t.k0s())}function Ft(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0438\u043d\u0438\u043c\u0443\u043c 0 "),t.k0s())}function Et(n,r){if(1&n&&(t.j41(0,"div",24)(1,"mat-icon"),t.EFF(2,"error"),t.k0s(),t.EFF(3),t.k0s()),2&n){const e=t.XpG();t.R7$(3),t.SpI(" ",e.error," ")}}let Ct=(()=>{class n{constructor(){this.fb=(0,t.WQX)(a.ok),this.workSessionsService=(0,t.WQX)(B),this.sessionCreated=new t.bkB,this.cancelled=new t.bkB,this.loading=!1,this.error=null}ngOnInit(){this.initForm()}initForm(){this.sessionForm=this.fb.group({workDate:[new Date,a.k0.required],regularHours:[0,[a.k0.required,a.k0.min(0),a.k0.max(24)]],overtimeHours:[0,[a.k0.required,a.k0.min(0),a.k0.max(24)]],carPayment:[0,[a.k0.required,a.k0.min(0)]],distanceKm:[null,[a.k0.min(0)]],territoryType:[""],notes:[""],photoUrl:[""],canBeInvoiced:[!0]})}onSubmit(){if(this.sessionForm.invalid)return void this.sessionForm.markAllAsTouched();if(!this.orderId)return void(this.error="ID \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d");this.loading=!0,this.error=null;const e=this.sessionForm.value,o={workDate:e.workDate instanceof Date?this.workSessionsService.formatDateForApi(e.workDate):e.workDate,regularHours:Number(e.regularHours),overtimeHours:Number(e.overtimeHours),carPayment:Number(e.carPayment),distanceKm:e.distanceKm?Number(e.distanceKm):void 0,territoryType:e.territoryType||void 0,notes:e.notes||void 0,photoUrl:e.photoUrl||void 0,canBeInvoiced:e.canBeInvoiced};this.workSessionsService.createWorkSession(this.orderId,o).subscribe({next:()=>{this.loading=!1,this.sessionCreated.emit(),this.sessionForm.reset({workDate:new Date,regularHours:0,overtimeHours:0,carPayment:0,canBeInvoiced:!0})},error:s=>{this.loading=!1,this.error="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e",console.error("Error creating work session:",s)}})}onCancel(){this.cancelled.emit()}get totalHours(){const e=this.sessionForm.get("regularHours")?.value||0,u=this.sessionForm.get("overtimeHours")?.value||0;return Number(e)+Number(u)}static{this.\u0275fac=function(u){return new(u||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-work-session-form"]],inputs:{orderId:"orderId"},outputs:{sessionCreated:"sessionCreated",cancelled:"cancelled"},standalone:!0,features:[t.aNF],decls:73,vars:17,consts:[["picker",""],[1,"work-session-form"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","workDate","placeholder","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443","required","",3,"matDatepicker"],["matIconSuffix","",3,"for"],[4,"ngIf"],[1,"hours-row"],["appearance","outline"],["matInput","","type","number","formControlName","regularHours","placeholder","0","min","0","max","24","step","0.25"],["matTextSuffix",""],["matInput","","type","number","formControlName","overtimeHours","placeholder","0","min","0","max","24","step","0.25"],[1,"total-hours"],[1,"label"],[1,"value"],["matInput","","type","number","formControlName","carPayment","placeholder","0","min","0","step","100"],["matInput","","type","number","formControlName","distanceKm","placeholder","0","min","0","step","0.1"],["matInput","","formControlName","territoryType","placeholder","\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: home, zone_1"],["matInput","","formControlName","notes","placeholder","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b","rows","4"],[1,"checkbox-row"],["formControlName","canBeInvoiced"],["class","error-message",4,"ngIf"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-button","","type","button",3,"click","disabled"],[1,"error-message"]],template:function(u,o){if(1&u){const s=t.RV6();t.j41(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),t.EFF(4,"add_circle"),t.k0s(),t.EFF(5," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e (\u0432\u044b\u0435\u0437\u0434) "),t.k0s()(),t.j41(6,"mat-card-content")(7,"form",2),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(o.onSubmit())}),t.j41(8,"mat-form-field",3)(9,"mat-label"),t.EFF(10,"\u0414\u0430\u0442\u0430 \u0440\u0430\u0431\u043e\u0442\u044b"),t.k0s(),t.nrm(11,"input",4)(12,"mat-datepicker-toggle",5)(13,"mat-datepicker",null,0),t.DNE(15,ct,2,0,"mat-error",6),t.k0s(),t.j41(16,"div",7)(17,"mat-form-field",8)(18,"mat-label"),t.EFF(19,"\u041e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.nrm(20,"input",9),t.j41(21,"span",10),t.EFF(22,"\u0447"),t.k0s(),t.DNE(23,lt,2,0,"mat-error",6)(24,dt,2,0,"mat-error",6)(25,mt,2,0,"mat-error",6),t.k0s(),t.j41(26,"mat-form-field",8)(27,"mat-label"),t.EFF(28,"\u041f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0430"),t.k0s(),t.nrm(29,"input",11),t.j41(30,"span",10),t.EFF(31,"\u0447"),t.k0s(),t.DNE(32,pt,2,0,"mat-error",6)(33,gt,2,0,"mat-error",6),t.k0s(),t.j41(34,"div",12)(35,"span",13),t.EFF(36,"\u0412\u0441\u0435\u0433\u043e:"),t.k0s(),t.j41(37,"span",14),t.EFF(38),t.k0s()()(),t.j41(39,"mat-form-field",3)(40,"mat-label"),t.EFF(41,"\u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443"),t.k0s(),t.nrm(42,"input",15),t.j41(43,"span",10),t.EFF(44,"\u20bd"),t.k0s(),t.DNE(45,_t,2,0,"mat-error",6)(46,ft,2,0,"mat-error",6),t.k0s(),t.j41(47,"mat-form-field",3)(48,"mat-label"),t.EFF(49,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e)"),t.k0s(),t.nrm(50,"input",16),t.j41(51,"span",10),t.EFF(52,"\u043a\u043c"),t.k0s(),t.DNE(53,Ft,2,0,"mat-error",6),t.k0s(),t.j41(54,"mat-form-field",3)(55,"mat-label"),t.EFF(56,"\u0422\u0438\u043f \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438 (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e)"),t.k0s(),t.nrm(57,"input",17),t.k0s(),t.j41(58,"mat-form-field",3)(59,"mat-label"),t.EFF(60,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),t.k0s(),t.nrm(61,"textarea",18),t.k0s(),t.j41(62,"div",19)(63,"mat-checkbox",20),t.EFF(64," \u041e\u043f\u043b\u0430\u0447\u0438\u0432\u0430\u0435\u043c\u0430\u044f \u0441\u0435\u0441\u0441\u0438\u044f (\u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432 \u0440\u0430\u0441\u0447\u0451\u0442\u0435 \u0437\u0430\u0440\u043f\u043b\u0430\u0442\u044b) "),t.k0s()(),t.DNE(65,Et,4,1,"div",21),t.k0s()(),t.j41(66,"mat-card-actions")(67,"button",22),t.bIt("click",function(){return t.eBV(s),t.Njj(o.onSubmit())}),t.j41(68,"mat-icon"),t.EFF(69,"save"),t.k0s(),t.EFF(70),t.k0s(),t.j41(71,"button",23),t.bIt("click",function(){return t.eBV(s),t.Njj(o.onCancel())}),t.EFF(72,"\u041e\u0442\u043c\u0435\u043d\u0430"),t.k0s()()()}if(2&u){let s,p,c,m,g,O,i,G,T;const $=t.sdS(14);t.R7$(7),t.Y8G("formGroup",o.sessionForm),t.R7$(4),t.Y8G("matDatepicker",$),t.R7$(),t.Y8G("for",$),t.R7$(3),t.Y8G("ngIf",null==(s=o.sessionForm.get("workDate"))?null:s.hasError("required")),t.R7$(8),t.Y8G("ngIf",null==(p=o.sessionForm.get("regularHours"))?null:p.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(c=o.sessionForm.get("regularHours"))?null:c.hasError("min")),t.R7$(),t.Y8G("ngIf",null==(m=o.sessionForm.get("regularHours"))?null:m.hasError("max")),t.R7$(7),t.Y8G("ngIf",null==(g=o.sessionForm.get("overtimeHours"))?null:g.hasError("min")),t.R7$(),t.Y8G("ngIf",null==(O=o.sessionForm.get("overtimeHours"))?null:O.hasError("max")),t.R7$(5),t.SpI("",o.totalHours.toFixed(2)," \u0447"),t.R7$(7),t.Y8G("ngIf",null==(i=o.sessionForm.get("carPayment"))?null:i.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(G=o.sessionForm.get("carPayment"))?null:G.hasError("min")),t.R7$(7),t.Y8G("ngIf",null==(T=o.sessionForm.get("distanceKm"))?null:T.hasError("min")),t.R7$(12),t.Y8G("ngIf",o.error),t.R7$(2),t.Y8G("disabled",o.loading||o.sessionForm.invalid),t.R7$(3),t.SpI(" ",o.loading?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e"," "),t.R7$(),t.Y8G("disabled",o.loading)}},dependencies:[C.MD,C.bT,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.VZ,a.zX,a.j4,a.JD,f.RG,f.rl,f.nJ,f.TL,f.yw,x.fS,x.fg,h.Hl,h.$z,k.X6,k.Vh,k.bZ,k.bU,P.WX,S.g7,S.So,_.Hu,_.RN,_.YY,_.m2,_.MM,_.dh,v.m_,v.An],styles:[".work-session-form[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}.work-session-form[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:20px}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr auto;gap:16px;align-items:start}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]   .total-hours[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 16px;background-color:#f5f5f5;border-radius:4px;margin-top:4px}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]   .total-hours[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#0009;margin-bottom:4px}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]   .total-hours[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1976d2}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .checkbox-row[_ngcontent-%COMP%]{padding:8px 0}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background-color:#ffebee;color:#c62828;border-radius:4px;margin-top:8px}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.work-session-form[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:16px;border-top:1px solid rgba(0,0,0,.12);display:flex;gap:12px}.work-session-form[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}@media (max-width: 768px){.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.work-session-form[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .hours-row[_ngcontent-%COMP%]   .total-hours[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between}}"]})}}return n})();var l=d(6573),F=d(8200),kt=d(2277);function Ot(n,r){1&n&&(t.j41(0,"div",10),t.nrm(1,"mat-spinner",11),t.j41(2,"p"),t.EFF(3,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),t.k0s()())}function ht(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e "),t.k0s())}function vt(n,r){if(1&n&&(t.j41(0,"mat-option",26),t.EFF(1),t.k0s()),2&n){const e=r.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function xt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430 "),t.k0s())}function Pt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e "),t.k0s())}function Mt(n,r){if(1&n&&(t.j41(0,"mat-option",26),t.EFF(1),t.k0s()),2&n){const e=r.$implicit,u=t.XpG(3);t.Y8G("value",e),t.R7$(),t.SpI(" ",e===u.OrderStatus.WAITING?"\u041e\u0436\u0438\u0434\u0430\u0435\u0442":e===u.OrderStatus.ASSIGNED?"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d (\u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f)":e===u.OrderStatus.PROCESSING?"\u0412 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435":e===u.OrderStatus.WORKING?"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435":e===u.OrderStatus.REVIEW?"\u041d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435":e===u.OrderStatus.COMPLETED?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d":e," ")}}function bt(n,r){if(1&n&&(t.j41(0,"mat-form-field",16)(1,"mat-label"),t.EFF(2,"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a"),t.k0s(),t.j41(3,"mat-select",66)(4,"mat-option",26),t.EFF(5,"\u0412\u0440\u0443\u0447\u043d\u0443\u044e"),t.k0s(),t.j41(6,"mat-option",26),t.EFF(7,"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438"),t.k0s(),t.j41(8,"mat-option",26),t.EFF(9,"Email"),t.k0s(),t.j41(10,"mat-option",26),t.EFF(11,"API"),t.k0s()()()),2&n){const e=t.XpG(3);t.R7$(4),t.Y8G("value",e.OrderSource.MANUAL),t.R7$(2),t.Y8G("value",e.OrderSource.AUTOMATIC),t.R7$(2),t.Y8G("value",e.OrderSource.EMAIL),t.R7$(2),t.Y8G("value",e.OrderSource.API)}}function Dt(n,r){if(1&n&&(t.j41(0,"div",20)(1,"mat-form-field",16)(2,"mat-label"),t.EFF(3,"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043a\u0430\u0437\u0430"),t.k0s(),t.j41(4,"mat-select",64),t.DNE(5,Mt,2,2,"mat-option",22),t.k0s()(),t.DNE(6,bt,12,4,"mat-form-field",65),t.k0s()),2&n){const e=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",e.availableStatuses),t.R7$(),t.Y8G("ngIf",!e.isEngineer)}}function wt(n,r){if(1&n&&(t.j41(0,"div",20)(1,"mat-form-field",16)(2,"mat-label"),t.EFF(3,"\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0434\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430"),t.k0s(),t.nrm(4,"input",67)(5,"mat-datepicker-toggle",28)(6,"mat-datepicker",null,2),t.k0s(),t.j41(8,"mat-form-field",16)(9,"mat-label"),t.EFF(10,"\u0414\u0430\u0442\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f"),t.k0s(),t.nrm(11,"input",68)(12,"mat-datepicker-toggle",28)(13,"mat-datepicker",null,3),t.k0s()()),2&n){const e=t.sdS(7),u=t.sdS(14);t.R7$(4),t.Y8G("matDatepicker",e),t.R7$(),t.Y8G("for",e),t.R7$(6),t.Y8G("matDatepicker",u),t.R7$(),t.Y8G("for",u)}}function jt(n,r){1&n&&(t.j41(0,"div",69)(1,"div",70)(2,"p")(3,"strong"),t.EFF(4,"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435!"),t.k0s(),t.EFF(5," \u0414\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e:"),t.k0s(),t.j41(6,"ol")(7,"li"),t.EFF(8,'\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0430 "\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d"'),t.k0s(),t.j41(9,"li"),t.EFF(10,'\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0435 "\u0424\u0430\u0439\u043b\u044b"'),t.k0s()()()())}function Rt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435 "),t.k0s())}function It(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c "),t.k0s())}function yt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c "),t.k0s())}function Bt(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c "),t.k0s())}function St(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," \u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c "),t.k0s())}function Gt(n,r){if(1&n&&(t.j41(0,"mat-card-subtitle"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Lme(" \u0418\u043d\u0436\u0435\u043d\u0435\u0440: ",null==e.order||null==e.order.assignedEngineer?null:e.order.assignedEngineer.firstName," ",null==e.order||null==e.order.assignedEngineer?null:e.order.assignedEngineer.lastName," ")}}function Tt(n,r){if(1&n&&(t.j41(0,"div",74)(1,"h4")(2,"mat-icon"),t.EFF(3,"payments"),t.k0s(),t.EFF(4," \u0412\u0430\u0448\u0430 \u043e\u043f\u043b\u0430\u0442\u0430"),t.k0s(),t.j41(5,"div",75)(6,"div",76)(7,"span",77),t.EFF(8,"\u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u0440\u0430\u0431\u043e\u0442\u0443:"),t.k0s(),t.j41(9,"span",78),t.EFF(10),t.k0s()(),t.j41(11,"div",76)(12,"span",77),t.EFF(13,"\u0414\u043e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443:"),t.k0s(),t.j41(14,"span",78),t.EFF(15),t.k0s()(),t.j41(16,"div",79)(17,"span",77),t.EFF(18,"\u0418\u0442\u043e\u0433\u043e \u043a \u0432\u044b\u043f\u043b\u0430\u0442\u0435:"),t.k0s(),t.j41(19,"span",78)(20,"strong"),t.EFF(21),t.k0s()()()()()),2&n){const e=t.XpG(3);t.R7$(10),t.JRh(e.formatAmount((null==e.order?null:e.order.calculatedAmount)||0)),t.R7$(5),t.JRh(e.formatAmount((null==e.order?null:e.order.carUsageAmount)||0)),t.R7$(6),t.JRh(e.formatAmount(((null==e.order?null:e.order.calculatedAmount)||0)+((null==e.order?null:e.order.carUsageAmount)||0)))}}function $t(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.SpI("",e.formatAmount((null==e.order?null:e.order.engineerBaseRate)||0),"/\u0447")}}function At(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0421\u0442\u0430\u0432\u043a\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.SpI("",e.formatAmount((null==e.order?null:e.order.engineerOvertimeRate)||0),"/\u0447")}}function Nt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.SpI("",e.formatAmount((null==e.order?null:e.order.organizationBaseRate)||0),"/\u0447")}}function Yt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.JRh(null==e.order?null:e.order.organizationOvertimeMultiplier)}}function Ut(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0417\u0430 \u043e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.JRh(e.formatAmount((null==e.order?null:e.order.regularPayment)||0))}}function zt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0417\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0443:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.JRh(e.formatAmount((null==e.order?null:e.order.overtimePayment)||0))}}function Ht(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0417\u0430 \u043e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.JRh(e.formatAmount((null==e.order?null:e.order.organizationRegularPayment)||0))}}function Wt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0417\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0443:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(5);t.R7$(4),t.JRh(e.formatAmount((null==e.order?null:e.order.organizationOvertimePayment)||0))}}function Xt(n,r){if(1&n&&(t.j41(0,"div",87)(1,"h4")(2,"mat-icon"),t.EFF(3,"calculate"),t.k0s(),t.EFF(4," \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0440\u0430\u0437\u0431\u0438\u0432\u043a\u0430 \u0440\u0430\u0441\u0447\u0451\u0442\u0430"),t.k0s(),t.j41(5,"div",88)(6,"h5"),t.EFF(7,"\u0421\u0442\u0430\u0432\u043a\u0438 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430:"),t.k0s(),t.j41(8,"div",75),t.DNE(9,$t,5,1,"div",89)(10,At,5,1,"div",89),t.k0s()(),t.j41(11,"div",88)(12,"h5"),t.EFF(13,"\u0421\u0442\u0430\u0432\u043a\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438:"),t.k0s(),t.j41(14,"div",75),t.DNE(15,Nt,5,1,"div",89)(16,Yt,5,1,"div",89),t.k0s()(),t.j41(17,"div",88)(18,"h5"),t.EFF(19,"\u0420\u0430\u0441\u0447\u0451\u0442 \u043e\u043f\u043b\u0430\u0442\u044b \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0443:"),t.k0s(),t.j41(20,"div",75),t.DNE(21,Ut,5,1,"div",89)(22,zt,5,1,"div",89),t.k0s()(),t.j41(23,"div",88)(24,"h5"),t.EFF(25,"\u0420\u0430\u0441\u0447\u0451\u0442 \u043e\u043f\u043b\u0430\u0442\u044b \u043e\u0442 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438:"),t.k0s(),t.j41(26,"div",75),t.DNE(27,Ht,5,1,"div",89)(28,Wt,5,1,"div",89),t.k0s()()()),2&n){const e=t.XpG(4);t.R7$(9),t.Y8G("ngIf",null==e.order?null:e.order.engineerBaseRate),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.engineerOvertimeRate),t.R7$(5),t.Y8G("ngIf",null==e.order?null:e.order.organizationBaseRate),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.organizationOvertimeMultiplier),t.R7$(5),t.Y8G("ngIf",null==e.order?null:e.order.regularPayment),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.overtimePayment),t.R7$(5),t.Y8G("ngIf",null==e.order?null:e.order.organizationRegularPayment),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.organizationOvertimePayment)}}function Lt(n,r){if(1&n&&(t.qex(0),t.j41(1,"div",74)(2,"h4")(3,"mat-icon"),t.EFF(4,"payments"),t.k0s(),t.EFF(5," \u041e\u043f\u043b\u0430\u0442\u0430 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0443"),t.k0s(),t.j41(6,"div",75)(7,"div",76)(8,"span",77),t.EFF(9,"\u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u0440\u0430\u0431\u043e\u0442\u0443:"),t.k0s(),t.j41(10,"span",78),t.EFF(11),t.k0s()(),t.j41(12,"div",76)(13,"span",77),t.EFF(14,"\u0414\u043e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443:"),t.k0s(),t.j41(15,"span",78),t.EFF(16),t.k0s()(),t.j41(17,"div",79)(18,"span",77),t.EFF(19,"\u0418\u0442\u043e\u0433\u043e \u043a \u0432\u044b\u043f\u043b\u0430\u0442\u0435 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0443:"),t.k0s(),t.j41(20,"span",78)(21,"strong"),t.EFF(22),t.k0s()()()()(),t.j41(23,"div",74)(24,"h4")(25,"mat-icon"),t.EFF(26,"business"),t.k0s(),t.EFF(27," \u041e\u043f\u043b\u0430\u0442\u0430 \u043e\u0442 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438"),t.k0s(),t.j41(28,"div",75)(29,"div",76)(30,"span",77),t.EFF(31,"\u041e\u043f\u043b\u0430\u0442\u0430 \u043e\u0442 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438:"),t.k0s(),t.j41(32,"span",78),t.EFF(33),t.k0s()(),t.j41(34,"div",76)(35,"span",77),t.EFF(36,"\u0414\u043e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443:"),t.k0s(),t.j41(37,"span",78),t.EFF(38),t.k0s()(),t.j41(39,"div",79)(40,"span",77),t.EFF(41,"\u0418\u0442\u043e\u0433\u043e \u043e\u0442 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438:"),t.k0s(),t.j41(42,"span",78)(43,"strong"),t.EFF(44),t.k0s()()()()(),t.j41(45,"div",83)(46,"h4")(47,"mat-icon"),t.EFF(48,"trending_up"),t.k0s(),t.EFF(49," \u041f\u0440\u0438\u0431\u044b\u043b\u044c"),t.k0s(),t.j41(50,"div",75)(51,"div",84)(52,"span",77),t.EFF(53,"\u041d\u0430\u0448\u0430 \u043f\u0440\u0438\u0431\u044b\u043b\u044c:"),t.k0s(),t.j41(54,"span",85)(55,"strong"),t.EFF(56),t.k0s()()()()(),t.DNE(57,Xt,29,8,"div",86),t.bVm()),2&n){const e=t.XpG(3);t.R7$(11),t.JRh(e.formatAmount((null==e.order?null:e.order.calculatedAmount)||0)),t.R7$(5),t.JRh(e.formatAmount((null==e.order?null:e.order.carUsageAmount)||0)),t.R7$(6),t.JRh(e.formatAmount(((null==e.order?null:e.order.calculatedAmount)||0)+((null==e.order?null:e.order.carUsageAmount)||0))),t.R7$(11),t.JRh(e.formatAmount((null==e.order?null:e.order.organizationPayment)||0)),t.R7$(5),t.JRh(e.formatAmount((null==e.order?null:e.order.carUsageAmount)||0)),t.R7$(6),t.JRh(e.formatAmount(((null==e.order?null:e.order.organizationPayment)||0)+((null==e.order?null:e.order.carUsageAmount)||0))),t.R7$(12),t.JRh(e.formatAmount((null==e.order?null:e.order.profit)||((null==e.order?null:e.order.organizationPayment)||0)-((null==e.order?null:e.order.calculatedAmount)||0))),t.R7$(),t.Y8G("ngIf",(null==e.order?null:e.order.engineerBaseRate)||(null==e.order?null:e.order.organizationBaseRate))}}function Vt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(4);t.R7$(4),t.SpI("",null==e.order?null:e.order.distanceKm," \u043a\u043c")}}function Kt(n,r){if(1&n&&(t.j41(0,"div",76)(1,"span",77),t.EFF(2,"\u0422\u0438\u043f \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438:"),t.k0s(),t.j41(3,"span",78),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(4);t.R7$(4),t.JRh(e.getTerritoryTypeLabel((null==e.order?null:e.order.territoryType)||""))}}function Jt(n,r){if(1&n&&(t.j41(0,"div",74)(1,"h4")(2,"mat-icon"),t.EFF(3,"location_on"),t.k0s(),t.EFF(4," \u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u044f"),t.k0s(),t.j41(5,"div",75),t.DNE(6,Vt,5,1,"div",89)(7,Kt,5,1,"div",89),t.k0s()()),2&n){const e=t.XpG(3);t.R7$(6),t.Y8G("ngIf",null==e.order?null:e.order.distanceKm),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.territoryType)}}function Qt(n,r){if(1&n&&(t.j41(0,"div",74)(1,"h4")(2,"mat-icon"),t.EFF(3,"notes"),t.k0s(),t.EFF(4," \u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),t.k0s(),t.j41(5,"p",90),t.EFF(6),t.k0s()()),2&n){const e=t.XpG(3);t.R7$(6),t.JRh(null==e.order?null:e.order.workNotes)}}function Zt(n,r){if(1&n&&(t.j41(0,"div",91)(1,"mat-icon"),t.EFF(2,"access_time"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(3);t.R7$(4),t.SpI("\u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b: ",e.formatDateTime(null==e.order?null:e.order.actualStartDate),"")}}function qt(n,r){if(1&n&&(t.j41(0,"div",91)(1,"mat-icon"),t.EFF(2,"access_time"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(3);t.R7$(4),t.SpI("\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435: ",e.formatDateTime(null==e.order?null:e.order.completionDate),"")}}function t4(n,r){if(1&n&&(t.j41(0,"mat-tab",71)(1,"div",72)(2,"h3"),t.EFF(3,"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435"),t.k0s(),t.j41(4,"p",33),t.EFF(5,"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u043c \u0437\u0430\u043a\u0430\u0437\u0435"),t.k0s(),t.j41(6,"mat-card",73)(7,"mat-card-header")(8,"mat-card-title")(9,"mat-icon"),t.EFF(10,"assignment_turned_in"),t.k0s(),t.EFF(11),t.k0s(),t.DNE(12,Gt,2,2,"mat-card-subtitle",18),t.k0s(),t.j41(13,"mat-card-content")(14,"div",74)(15,"h4")(16,"mat-icon"),t.EFF(17,"schedule"),t.k0s(),t.EFF(18," \u041e\u0442\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.j41(19,"div",75)(20,"div",76)(21,"span",77),t.EFF(22,"\u041e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b:"),t.k0s(),t.j41(23,"span",78),t.EFF(24),t.k0s()(),t.j41(25,"div",76)(26,"span",77),t.EFF(27,"\u0427\u0430\u0441\u044b \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438:"),t.k0s(),t.j41(28,"span",78),t.EFF(29),t.k0s()(),t.j41(30,"div",79)(31,"span",77),t.EFF(32,"\u0412\u0441\u0435\u0433\u043e \u0447\u0430\u0441\u043e\u0432:"),t.k0s(),t.j41(33,"span",78)(34,"strong"),t.EFF(35),t.k0s()()()()(),t.DNE(36,Tt,22,3,"div",80)(37,Lt,58,8,"ng-container",18)(38,Jt,8,2,"div",80)(39,Qt,7,1,"div",80),t.j41(40,"div",81),t.DNE(41,Zt,5,1,"div",82)(42,qt,5,1,"div",82),t.k0s()()()()()),2&n){const e=t.XpG(2);t.R7$(11),t.SpI(" \u0417\u0430\u043a\u0430\u0437 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d ",e.formatDate(null==e.order?null:e.order.completionDate)," "),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.assignedEngineer),t.R7$(12),t.SpI("",(null==e.order?null:e.order.regularHours)||0," \u0447"),t.R7$(5),t.SpI("",(null==e.order?null:e.order.overtimeHours)||0," \u0447"),t.R7$(6),t.SpI("",((null==e.order?null:e.order.regularHours)||0)+((null==e.order?null:e.order.overtimeHours)||0)," \u0447"),t.R7$(),t.Y8G("ngIf",e.isEngineer),t.R7$(),t.Y8G("ngIf",e.isAdminOrManager()),t.R7$(),t.Y8G("ngIf",(null==e.order?null:e.order.distanceKm)||(null==e.order?null:e.order.territoryType)),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.workNotes),t.R7$(2),t.Y8G("ngIf",null==e.order?null:e.order.actualStartDate),t.R7$(),t.Y8G("ngIf",null==e.order?null:e.order.completionDate)}}function e4(n,r){1&n&&(t.j41(0,"div",69)(1,"div",70)(2,"p")(3,"strong"),t.EFF(4,"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435!"),t.k0s(),t.EFF(5," \u0414\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b. "),t.k0s(),t.j41(6,"p"),t.EFF(7,"\u0424\u043e\u0442\u043e \u0434\u043e\u043b\u0436\u043d\u044b \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443 \u0438 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0442\u044c \u0435\u0451 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e."),t.k0s()()())}function n4(n,r){if(1&n&&(t.j41(0,"div",101),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.error," ")}}function u4(n,r){if(1&n&&(t.j41(0,"div",95)(1,"div",96)(2,"span",97),t.EFF(3),t.k0s(),t.j41(4,"span",98),t.EFF(5),t.k0s()(),t.nrm(6,"mat-progress-bar",99),t.DNE(7,n4,2,1,"div",100),t.k0s()),2&n){const e=r.$implicit;t.R7$(3),t.JRh(e.file.name),t.R7$(),t.HbH(e.status),t.R7$(),t.SpI(" ","uploading"===e.status?e.progress+"%":"completed"===e.status?"\u0413\u043e\u0442\u043e\u0432\u043e":"error"===e.status?"\u041e\u0448\u0438\u0431\u043a\u0430":"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435"," "),t.R7$(),t.HbH(e.status),t.Y8G("value",e.progress),t.R7$(),t.Y8G("ngIf",e.error)}}function o4(n,r){if(1&n&&(t.j41(0,"div",92)(1,"h4"),t.EFF(2,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432:"),t.k0s(),t.j41(3,"div",93),t.DNE(4,u4,8,8,"div",94),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(4),t.Y8G("ngForOf",e.uploadProgress())}}function r4(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",105)(1,"span",97),t.EFF(2),t.k0s(),t.j41(3,"span",106),t.EFF(4),t.k0s(),t.j41(5,"button",107),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(3);return t.Njj(s.removeUploadedFile(s.getUploadIndex(o)))}),t.j41(6,"mat-icon"),t.EFF(7,"delete"),t.k0s()()()}if(2&n){const e=r.$implicit;t.R7$(2),t.JRh(e.file.name),t.R7$(2),t.SpI("(",(e.file.size/1024/1024).toFixed(2)," MB)")}}function i4(n,r){if(1&n&&(t.j41(0,"div",102)(1,"h4"),t.EFF(2,"\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b (\u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u044b \u043a \u0437\u0430\u043a\u0430\u0437\u0443):"),t.k0s(),t.j41(3,"div",103),t.DNE(4,r4,8,2,"div",104),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(4),t.Y8G("ngForOf",e.getCompletedUploads())}}function s4(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",105)(1,"span",97),t.EFF(2),t.k0s(),t.j41(3,"span",106),t.EFF(4),t.k0s(),t.j41(5,"div",109)(6,"button",110),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(3);return t.Njj(s.viewFile(o.id))}),t.j41(7,"mat-icon"),t.EFF(8,"visibility"),t.k0s()(),t.j41(9,"button",111),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(3);return t.Njj(s.downloadFile(o.id))}),t.j41(10,"mat-icon"),t.EFF(11,"download"),t.k0s()(),t.j41(12,"button",112),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(3);return t.Njj(s.removeAttachedFile(o.id))}),t.j41(13,"mat-icon"),t.EFF(14,"delete"),t.k0s()()()()}if(2&n){const e=r.$implicit;t.R7$(2),t.JRh(e.originalName),t.R7$(2),t.SpI("(",(e.size/1024/1024).toFixed(2)," MB)")}}function a4(n,r){if(1&n&&(t.j41(0,"div",108)(1,"h4"),t.EFF(2,"\u041f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b:"),t.k0s(),t.j41(3,"div",103),t.DNE(4,s4,15,2,"div",104),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(4),t.Y8G("ngForOf",e.attachedFiles())}}function c4(n,r){if(1&n){const e=t.RV6();t.j41(0,"app-work-session-form",117),t.bIt("sessionCreated",function(){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onWorkSessionCreated())}),t.k0s()}if(2&n){const e=t.XpG(3);t.Y8G("orderId",e.orderId)}}function l4(n,r){if(1&n&&t.nrm(0,"app-work-session-list",118),2&n){let e;const u=t.XpG(3);t.Y8G("orderId",u.orderId)("canEdit",u.canEditOrder)("canDelete",u.canEditOrder&&(null==(e=u.authService.currentUser())?null:e.role)===u.UserRole.ADMIN)}}function d4(n,r){if(1&n&&(t.j41(0,"mat-tab",113)(1,"div",114)(2,"h3"),t.EFF(3,"\u0423\u0447\u0451\u0442 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u043e \u0437\u0430\u043a\u0430\u0437\u0443"),t.k0s(),t.j41(4,"p",33),t.EFF(5," \u0417\u0434\u0435\u0441\u044c \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0432\u044b\u0435\u0437\u0434\u044b \u0438 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438 \u043f\u043e \u044d\u0442\u043e\u043c\u0443 \u0437\u0430\u043a\u0430\u0437\u0443. \u041a\u0430\u0436\u0434\u0430\u044f \u0441\u0435\u0441\u0441\u0438\u044f \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u0442 \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0438 \u0431\u0443\u0434\u0435\u0442 \u0443\u0447\u0442\u0435\u043d\u0430 \u0432 \u0440\u0430\u0441\u0447\u0451\u0442\u0435 \u0437\u0430\u0440\u043f\u043b\u0430\u0442\u044b \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u043c \u043c\u0435\u0441\u044f\u0446\u0435. "),t.k0s(),t.DNE(6,c4,1,1,"app-work-session-form",115)(7,l4,1,3,"app-work-session-list",116),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(6),t.Y8G("ngIf",(null==e.order?null:e.order.status)!==e.OrderStatus.COMPLETED&&e.canEditOrder&&e.orderId),t.R7$(),t.Y8G("ngIf",e.orderId)}}function m4(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",119),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onAcceptOrder())}),t.j41(1,"mat-icon"),t.EFF(2,"check_circle"),t.k0s(),t.j41(3,"span"),t.EFF(4,"\u041f\u0440\u0438\u043d\u044f\u0442\u044c \u0437\u0430\u043a\u0430\u0437"),t.k0s()()}if(2&n){const e=t.XpG(2);t.Y8G("disabled",e.isLoading())}}function p4(n,r){1&n&&t.nrm(0,"mat-spinner",120)}function g4(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.JRh(e.isEdit?"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}}function _4(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",12)(1,"mat-tab-group",13),t.mxI("selectedIndexChange",function(o){t.eBV(e);const s=t.XpG();return t.DH7(s.selectedTabIndex,o)||(s.selectedTabIndex=o),t.Njj(o)}),t.j41(2,"mat-tab",14)(3,"form",15)(4,"mat-form-field",16)(5,"mat-label"),t.EFF(6,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"),t.k0s(),t.nrm(7,"input",17),t.DNE(8,ht,2,0,"mat-error",18),t.k0s(),t.j41(9,"mat-form-field",16)(10,"mat-label"),t.EFF(11,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),t.k0s(),t.nrm(12,"textarea",19),t.k0s(),t.j41(13,"div",20)(14,"mat-form-field",16)(15,"mat-label"),t.EFF(16,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),t.k0s(),t.j41(17,"mat-select",21),t.DNE(18,vt,2,2,"mat-option",22),t.k0s(),t.DNE(19,xt,2,0,"mat-error",18),t.k0s(),t.j41(20,"mat-form-field",16)(21,"mat-label"),t.EFF(22,"\u041c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435"),t.k0s(),t.nrm(23,"input",23),t.DNE(24,Pt,2,0,"mat-error",18),t.k0s()(),t.j41(25,"div",20)(26,"mat-form-field",16)(27,"mat-label"),t.EFF(28,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (\u043a\u043c)"),t.k0s(),t.nrm(29,"input",24),t.k0s(),t.j41(30,"mat-form-field",16)(31,"mat-label"),t.EFF(32,"\u0422\u0438\u043f \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438"),t.k0s(),t.j41(33,"mat-select",25)(34,"mat-option",26),t.EFF(35,"\u0413\u043e\u0440\u043e\u0434\u0441\u043a\u043e\u0439"),t.k0s(),t.j41(36,"mat-option",26),t.EFF(37,"\u041f\u0440\u0438\u0433\u043e\u0440\u043e\u0434\u043d\u044b\u0439"),t.k0s(),t.j41(38,"mat-option",26),t.EFF(39,"\u0421\u0435\u043b\u044c\u0441\u043a\u0438\u0439"),t.k0s(),t.j41(40,"mat-option",26),t.EFF(41,"\u0414\u043e\u043c\u0430\u0448\u043d\u0438\u0439 (\u226460 \u043a\u043c)"),t.k0s(),t.j41(42,"mat-option",26),t.EFF(43,"\u0417\u043e\u043d\u0430 1 (61-199 \u043a\u043c)"),t.k0s(),t.j41(44,"mat-option",26),t.EFF(45,"\u0417\u043e\u043d\u0430 2 (200-250 \u043a\u043c)"),t.k0s(),t.j41(46,"mat-option",26),t.EFF(47,"\u0417\u043e\u043d\u0430 3 (>250 \u043a\u043c)"),t.k0s()()()(),t.j41(48,"mat-form-field",16)(49,"mat-label"),t.EFF(50,"\u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u043c\u0430\u044f \u0434\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430"),t.k0s(),t.nrm(51,"input",27)(52,"mat-datepicker-toggle",28)(53,"mat-datepicker",null,0),t.k0s(),t.DNE(55,Dt,7,2,"div",29)(56,wt,15,4,"div",29)(57,jt,11,0,"div",30),t.k0s()(),t.j41(58,"mat-tab",31)(59,"div",32)(60,"h3"),t.EFF(61,"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"),t.k0s(),t.j41(62,"p",33),t.EFF(63," \u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043e\u0442\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0435 \u0447\u0430\u0441\u044b \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430 \u0438 \u0440\u0430\u0441\u0447\u0451\u0442\u0430 \u043e\u043f\u043b\u0430\u0442\u044b "),t.k0s(),t.j41(64,"form",34)(65,"div",35)(66,"h4"),t.EFF(67,"\u041e\u0442\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.j41(68,"div",20)(69,"mat-form-field",16)(70,"mat-label"),t.EFF(71,"\u041e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.nrm(72,"input",36),t.j41(73,"mat-hint"),t.EFF(74,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0447\u0430\u0441\u043e\u0432 \u043f\u043e \u043e\u0431\u044b\u0447\u043d\u043e\u043c\u0443 \u0442\u0430\u0440\u0438\u0444\u0443"),t.k0s(),t.DNE(75,Rt,2,0,"mat-error",18)(76,It,2,0,"mat-error",18),t.k0s(),t.j41(77,"mat-form-field",16)(78,"mat-label"),t.EFF(79,"\u0427\u0430\u0441\u044b \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438"),t.k0s(),t.nrm(80,"input",37),t.j41(81,"mat-hint"),t.EFF(82,"\u0427\u0430\u0441\u044b \u043f\u043e \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u043e\u043c\u0443 \u0442\u0430\u0440\u0438\u0444\u0443"),t.k0s(),t.DNE(83,yt,2,0,"mat-error",18),t.k0s()(),t.j41(84,"div",38)(85,"mat-icon"),t.EFF(86,"schedule"),t.k0s(),t.j41(87,"span"),t.EFF(88,"\u0412\u0441\u0435\u0433\u043e \u0447\u0430\u0441\u043e\u0432: "),t.j41(89,"strong"),t.EFF(90),t.k0s()()()(),t.j41(91,"div",39)(92,"h4"),t.EFF(93,"\u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c"),t.k0s(),t.j41(94,"mat-form-field",40)(95,"mat-label"),t.EFF(96,"\u0414\u043e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443 (\u20bd)"),t.k0s(),t.nrm(97,"input",41),t.j41(98,"mat-hint"),t.EFF(99,"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u0447\u043d\u043e\u0433\u043e \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f"),t.k0s(),t.DNE(100,Bt,2,0,"mat-error",18),t.k0s()(),t.j41(101,"div",42)(102,"h4"),t.EFF(103,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u044f (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e)"),t.k0s(),t.j41(104,"div",20)(105,"mat-form-field",16)(106,"mat-label"),t.EFF(107,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (\u043a\u043c)"),t.k0s(),t.nrm(108,"input",43),t.j41(109,"mat-hint"),t.EFF(110,"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043e\u0442 \u0434\u043e\u043c\u0430 \u0434\u043e \u043c\u0435\u0441\u0442\u0430 \u0440\u0430\u0431\u043e\u0442\u044b"),t.k0s(),t.DNE(111,St,2,0,"mat-error",18),t.k0s(),t.j41(112,"mat-form-field",16)(113,"mat-label"),t.EFF(114,"\u0422\u0438\u043f \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438"),t.k0s(),t.j41(115,"mat-select",25)(116,"mat-option",26),t.EFF(117,"\u0413\u043e\u0440\u043e\u0434\u0441\u043a\u0430\u044f"),t.k0s(),t.j41(118,"mat-option",26),t.EFF(119,"\u041f\u0440\u0438\u0433\u043e\u0440\u043e\u0434\u043d\u0430\u044f"),t.k0s(),t.j41(120,"mat-option",26),t.EFF(121,"\u0421\u0435\u043b\u044c\u0441\u043a\u0430\u044f"),t.k0s(),t.j41(122,"mat-option",26),t.EFF(123,"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f (\u226460 \u043a\u043c)"),t.k0s(),t.j41(124,"mat-option",26),t.EFF(125,"\u0417\u043e\u043d\u0430 1 (61-199 \u043a\u043c)"),t.k0s(),t.j41(126,"mat-option",26),t.EFF(127,"\u0417\u043e\u043d\u0430 2 (200-250 \u043a\u043c)"),t.k0s(),t.j41(128,"mat-option",26),t.EFF(129,"\u0417\u043e\u043d\u0430 3 (>250 \u043a\u043c)"),t.k0s()(),t.j41(130,"mat-hint"),t.EFF(131,"\u0414\u043b\u044f \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"),t.k0s()()()(),t.j41(132,"mat-form-field",40)(133,"mat-label"),t.EFF(134,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),t.k0s(),t.nrm(135,"textarea",44),t.j41(136,"mat-hint"),t.EFF(137,"\u041d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e"),t.k0s()()(),t.j41(138,"div",45)(139,"mat-icon",46),t.EFF(140,"info"),t.k0s(),t.j41(141,"div",47)(142,"p")(143,"strong"),t.EFF(144,"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f:"),t.k0s()(),t.j41(145,"ul")(146,"li")(147,"strong"),t.EFF(148,"\u041e\u0431\u044b\u0447\u043d\u044b\u0435 \u0447\u0430\u0441\u044b"),t.k0s(),t.EFF(149," - \u043e\u043f\u043b\u0430\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u043e \u0431\u0430\u0437\u043e\u0432\u043e\u043c\u0443 \u0442\u0430\u0440\u0438\u0444\u0443"),t.k0s(),t.j41(150,"li")(151,"strong"),t.EFF(152,"\u0427\u0430\u0441\u044b \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438"),t.k0s(),t.EFF(153," - \u043e\u043f\u043b\u0430\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u043e \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u043e\u043c\u0443 \u0442\u0430\u0440\u0438\u0444\u0443"),t.k0s(),t.j41(154,"li")(155,"strong"),t.EFF(156,"\u0414\u043e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043c\u0430\u0448\u0438\u043d\u0443"),t.k0s(),t.EFF(157," - \u043a\u043e\u043c\u043f\u0435\u043d\u0441\u0430\u0446\u0438\u044f \u0437\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u0447\u043d\u043e\u0433\u043e \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f "),t.k0s(),t.j41(158,"li"),t.EFF(159,"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0447\u0430\u0441\u044b \u0441 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c\u044e \u0434\u043e 0.25 (15 \u043c\u0438\u043d\u0443\u0442)"),t.k0s(),t.j41(160,"li"),t.EFF(161,'\u0414\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0444\u043e\u0442\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u043d\u0430 \u0432\u043a\u043b\u0430\u0434\u043a\u0435 "\u0424\u0430\u0439\u043b\u044b"'),t.k0s()()()()()(),t.DNE(162,t4,43,11,"mat-tab",48),t.j41(163,"mat-tab",49)(164,"div",50),t.DNE(165,e4,8,0,"div",30),t.j41(166,"h3"),t.EFF(167,"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430\u043c\u0438"),t.k0s(),t.j41(168,"div",51)(169,"input",52,1),t.bIt("change",function(o){t.eBV(e);const s=t.XpG();return t.Njj(s.onFileSelected(o))}),t.k0s(),t.j41(171,"button",53),t.bIt("click",function(){t.eBV(e);const o=t.sdS(170);return t.Njj(o.click())}),t.j41(172,"mat-icon"),t.EFF(173,"add"),t.k0s(),t.EFF(174," \u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b "),t.k0s()(),t.j41(175,"div",54),t.bIt("dragover",function(o){t.eBV(e);const s=t.XpG();return t.Njj(s.onDragOver(o))})("dragleave",function(o){t.eBV(e);const s=t.XpG();return t.Njj(s.onDragLeave(o))})("drop",function(o){t.eBV(e);const s=t.XpG();return t.Njj(s.onDrop(o))}),t.j41(176,"mat-icon"),t.EFF(177,"cloud_upload"),t.k0s(),t.j41(178,"p"),t.EFF(179," \u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430 \u0438\u043b\u0438 "),t.j41(180,"button",55),t.bIt("click",function(){t.eBV(e);const o=t.sdS(170);return t.Njj(o.click())}),t.EFF(181,"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435"),t.k0s()(),t.j41(182,"small"),t.EFF(183,"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u0444\u043e\u0440\u043c\u0430\u0442\u044b: \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f, PDF, \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b (\u043c\u0430\u043a\u0441. 10MB)"),t.k0s()(),t.DNE(184,o4,5,1,"div",56)(185,i4,5,1,"div",57)(186,a4,5,1,"div",58),t.k0s()(),t.DNE(187,d4,8,2,"mat-tab",59),t.k0s(),t.j41(188,"div",60)(189,"button",6),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onCancel())}),t.EFF(190,"\u041e\u0442\u043c\u0435\u043d\u0430"),t.k0s(),t.DNE(191,m4,5,1,"button",61),t.j41(192,"button",62),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onSave())}),t.DNE(193,p4,1,0,"mat-spinner",63)(194,g4,2,1,"span",18),t.k0s()()()}if(2&n){let e,u,o,s,p,c,m,g;const O=t.sdS(54),i=t.XpG();t.R7$(),t.R50("selectedIndex",i.selectedTabIndex),t.R7$(2),t.Y8G("formGroup",i.orderForm),t.R7$(5),t.Y8G("ngIf",null==(e=i.orderForm.get("title"))?null:e.hasError("required")),t.R7$(10),t.Y8G("ngForOf",i.organizations()),t.R7$(),t.Y8G("ngIf",null==(u=i.orderForm.get("organizationId"))?null:u.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(o=i.orderForm.get("location"))?null:o.hasError("required")),t.R7$(10),t.Y8G("value",i.TerritoryType.URBAN),t.R7$(2),t.Y8G("value",i.TerritoryType.SUBURBAN),t.R7$(2),t.Y8G("value",i.TerritoryType.RURAL),t.R7$(2),t.Y8G("value",i.TerritoryType.HOME),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_1),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_2),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_3),t.R7$(5),t.Y8G("matDatepicker",O),t.R7$(),t.Y8G("for",O),t.R7$(3),t.Y8G("ngIf",i.isEdit),t.R7$(),t.Y8G("ngIf",i.isEdit&&!i.isEngineer),t.R7$(),t.Y8G("ngIf",i.isEdit&&i.isEngineer&&(null==i.order?null:i.order.status)===i.OrderStatus.WORKING),t.R7$(7),t.Y8G("formGroup",i.workReportForm),t.R7$(11),t.Y8G("ngIf",null==(s=i.workReportForm.get("regularHours"))?null:s.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(p=i.workReportForm.get("regularHours"))?null:p.hasError("min")),t.R7$(7),t.Y8G("ngIf",null==(c=i.workReportForm.get("overtimeHours"))?null:c.hasError("min")),t.R7$(7),t.JRh(i.getTotalHours()),t.R7$(10),t.Y8G("ngIf",null==(m=i.workReportForm.get("carPayment"))?null:m.hasError("min")),t.R7$(11),t.Y8G("ngIf",null==(g=i.workReportForm.get("distanceKm"))?null:g.hasError("min")),t.R7$(5),t.Y8G("value",i.TerritoryType.URBAN),t.R7$(2),t.Y8G("value",i.TerritoryType.SUBURBAN),t.R7$(2),t.Y8G("value",i.TerritoryType.RURAL),t.R7$(2),t.Y8G("value",i.TerritoryType.HOME),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_1),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_2),t.R7$(2),t.Y8G("value",i.TerritoryType.ZONE_3),t.R7$(34),t.Y8G("ngIf",(null==i.order?null:i.order.status)===i.OrderStatus.COMPLETED),t.R7$(3),t.Y8G("ngIf",i.isEngineer&&(null==i.order?null:i.order.status)===i.OrderStatus.WORKING),t.R7$(6),t.Y8G("disabled",i.isUploadingInProgress()),t.R7$(4),t.AVh("drag-over",i.isDragOver()),t.R7$(9),t.Y8G("ngIf",i.uploadProgress().length>0),t.R7$(),t.Y8G("ngIf",i.getCompletedUploads().length>0),t.R7$(),t.Y8G("ngIf",i.attachedFiles().length>0),t.R7$(),t.Y8G("ngIf",i.isEdit&&i.orderId),t.R7$(4),t.Y8G("ngIf",i.canAcceptOrder),t.R7$(),t.Y8G("disabled",i.orderForm.invalid||i.isLoading()||i.isUploadingInProgress()),t.R7$(),t.Y8G("ngIf",i.isLoading()),t.R7$(),t.Y8G("ngIf",!i.isLoading())}}function f4(n,r){if(1&n&&t.nrm(0,"img",130),2&n){const e=t.XpG(2);t.Y8G("src",e.currentImageMetadata.viewUrl,t.B4B)("alt",null==e.currentImageMetadata?null:e.currentImageMetadata.originalName)}}function F4(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",121),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeImageModal())}),t.j41(1,"div",122),t.bIt("click",function(o){return t.eBV(e),t.Njj(o.stopPropagation())}),t.j41(2,"div",123)(3,"h3"),t.EFF(4),t.k0s(),t.j41(5,"button",124),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeImageModal())}),t.j41(6,"mat-icon"),t.EFF(7,"close"),t.k0s()()(),t.j41(8,"div",125),t.DNE(9,f4,1,2,"img",126),t.k0s(),t.j41(10,"div",127)(11,"span",128),t.EFF(12),t.k0s(),t.j41(13,"button",129),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.downloadCurrentImage())}),t.j41(14,"mat-icon"),t.EFF(15,"download"),t.k0s(),t.EFF(16," \u0421\u043a\u0430\u0447\u0430\u0442\u044c "),t.k0s()()()()}if(2&n){const e=t.XpG();t.R7$(4),t.JRh(null==e.currentImageMetadata?null:e.currentImageMetadata.originalName),t.R7$(5),t.Y8G("ngIf",null==e.currentImageMetadata?null:e.currentImageMetadata.viewUrl),t.R7$(3),t.Lme(" ",null==e.currentImageMetadata?null:e.currentImageMetadata.sizeFormatted," \u2022 ",null==e.currentImageMetadata?null:e.currentImageMetadata.type," ")}}let E4=(()=>{class n{constructor(){this.fb=(0,t.WQX)(a.ok),this.route=(0,t.WQX)(w.nX),this.router=(0,t.WQX)(w.Ix),this.ordersService=(0,t.WQX)(A.B),this.organizationsService=(0,t.WQX)(N.k),this.filesService=(0,t.WQX)(Y.F),this.toastService=(0,t.WQX)(U.f),this.authService=(0,t.WQX)(z.u),this.isLoading=(0,t.vPA)(!1),this.organizations=(0,t.vPA)([]),this.TerritoryType=l.F2,this.OrderStatus=l.Re,this.OrderSource=l.kc,this.UserRole=F.gG,this.orderId=null,this.isEdit=!1,this.order=null,this.attachedFiles=(0,t.vPA)([]),this.selectedFiles=[],this.isUploadingFiles=(0,t.vPA)(!1),this.isDragOver=(0,t.vPA)(!1),this.uploadProgress=(0,t.vPA)([]),this.imageModalVisible=!1,this.currentImageMetadata=null,this.selectedTabIndex=0,this.orderForm=this.fb.group({title:["",[a.k0.required]],description:[""],organizationId:[null,[a.k0.required]],location:["",[a.k0.required]],distanceKm:[null],territoryType:[null],plannedStartDate:[null],source:[l.kc.MANUAL],status:[l.Re.WAITING],actualStartDate:[null],completionDate:[null],equipmentInfo:[""],comments:[""],files:[[]]}),this.workExecutionForm=this.fb.group({workActNumber:[""],workStartTime:[null],workEndTime:[null],isOvertimeRate:[!1],isRepairComplete:[null]}),this.workReportForm=this.fb.group({regularHours:[null,[a.k0.required,a.k0.min(0)]],overtimeHours:[null,[a.k0.min(0)]],carPayment:[null,[a.k0.min(0)]],distanceKm:[null,[a.k0.min(0)]],territoryType:[null],notes:[""]}),this.showWorkReportTab=(0,t.EWP)(()=>this.isEngineer&&this.isEdit&&this.order&&(this.order.status===l.Re.WORKING||this.order.status===l.Re.COMPLETED)),this.showWorkExecutionForm=(0,t.EWP)(()=>this.isEngineer&&this.isEdit&&this.order&&this.order.status===l.Re.WORKING),this.isOrderLocked=(0,t.EWP)(()=>{if(!this.order||!this.order.completionLockedAt)return!1;const e=new Date(this.order.completionLockedAt);return new Date>e}),this.canConfirmOrder=(0,t.EWP)(()=>this.isEngineer&&this.isEdit&&this.order&&this.order.status===l.Re.ASSIGNED),this.canStartExecution=(0,t.EWP)(()=>this.isEngineer&&this.isEdit&&this.order&&this.order.status===l.Re.WORKING&&!this.order.workStartTime),this.canCompleteExecution=(0,t.EWP)(()=>this.isEngineer&&this.isEdit&&this.order&&this.order.status===l.Re.WORKING&&!!this.order.workStartTime),this.totalWorkHours=(0,t.EWP)(()=>{const e=this.workExecutionForm.get("workStartTime")?.value,u=this.workExecutionForm.get("workEndTime")?.value;if(e&&u){const o=new Date(e),c=(new Date(u).getTime()-o.getTime())/36e5;return Math.max(0,Math.round(100*c)/100)}return 0})}get availableStatuses(){const e=this.authService.currentUser();if(!e)return[];if(e.role===F.gG.ADMIN||e.role===F.gG.MANAGER)return Object.values(l.Re);if(e.role===F.gG.USER&&this.order&&this.order.assignedEngineerId===e.id)switch(this.order.status){case l.Re.ASSIGNED:return[l.Re.ASSIGNED];case l.Re.PROCESSING:return[l.Re.PROCESSING,l.Re.WORKING];case l.Re.WORKING:return[l.Re.WORKING,l.Re.REVIEW];case l.Re.REVIEW:return[l.Re.REVIEW];default:return[this.order.status]}return[]}get isEngineer(){return this.authService.currentUser()?.role===F.gG.USER}get canEditOrder(){const e=this.authService.currentUser();return!(!e||!this.order)&&(e.role===F.gG.ADMIN||e.role===F.gG.MANAGER||e.role===F.gG.USER&&this.order.assignedEngineerId===e.id)}ngOnInit(){this.loadOrganizations(),this.route.paramMap.subscribe(e=>{const u=e.get("id");u&&(this.orderId=+u,this.isEdit=!0,this.loadOrder(this.orderId))})}loadOrder(e){this.isLoading.set(!0),this.ordersService.getOrder(e).subscribe({next:u=>{this.order=u,this.populateForm(u),this.isLoading.set(!1)},error:u=>{console.error("Error loading order:",u),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0437\u0430\u043a\u0430\u0437\u0430"),this.isLoading.set(!1),this.router.navigate(["/orders"])}})}populateForm(e){this.orderForm.patchValue({title:e.title,description:e.description,organizationId:e.organizationId,location:e.location,distanceKm:e.distanceKm,territoryType:e.territoryType,plannedStartDate:e.plannedStartDate,source:e.source,status:e.status,actualStartDate:e.actualStartDate,completionDate:e.completionDate,equipmentInfo:e.equipmentInfo||"",comments:e.comments||"",files:e.files?.map(u=>u.id)||[]}),(e.status===l.Re.WORKING||e.status===l.Re.COMPLETED)&&(this.workExecutionForm.patchValue({workActNumber:e.workActNumber||"",workStartTime:e.workStartTime||null,workEndTime:e.workEndTime||null,isOvertimeRate:e.isOvertimeRate||!1,isRepairComplete:e.isRepairComplete}),this.isOrderLocked()&&this.workExecutionForm.disable()),(void 0!==e.regularHours||void 0!==e.overtimeHours)&&(console.log("\u{1f4cb} Loading existing work data:",{regularHours:e.regularHours,overtimeHours:e.overtimeHours,carUsageAmount:e.carUsageAmount,workNotes:e.workNotes}),this.workReportForm.patchValue({regularHours:e.regularHours||0,overtimeHours:e.overtimeHours||0,carPayment:e.carUsageAmount||0,distanceKm:e.distanceKm||null,territoryType:e.territoryType||null,notes:e.workNotes||""}),"completed"===e.status&&(this.workReportForm.disable(),console.log("\u2139\ufe0f Work report form disabled - order already completed"))),e.files?(console.log("Loading existing order files:",e.files.map(u=>({id:u.id,name:u.originalName}))),this.attachedFiles.set(e.files)):console.log("No existing files found for order")}loadOrganizations(){this.organizationsService.getOrganizations().subscribe({next:e=>{this.organizations.set(e.data.filter(u=>u.isActive))},error:e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0439:",e),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0439")}})}onFileSelected(e){const u=e.target.files;u&&u.length>0&&this.addFilesAndStartUpload(Array.from(u))}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!0)}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1)}onDrop(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1);const u=e.dataTransfer?.files;u&&u.length>0&&this.addFilesAndStartUpload(Array.from(u))}addFilesAndStartUpload(e){var u=this;return(0,E.A)(function*(){const s=["image/jpeg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],p=[];for(const c of e)c.size>10485760?u.toastService.error(`\u0424\u0430\u0439\u043b "${c.name}" \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439. \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440: 10MB`):s.includes(c.type)?u.uploadProgress().some(g=>g.file.name===c.name&&g.file.size===c.size)?u.toastService.warning(`\u0424\u0430\u0439\u043b "${c.name}" \u0443\u0436\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d`):p.push(c):u.toastService.error(`\u0424\u0430\u0439\u043b "${c.name}" \u0438\u043c\u0435\u0435\u0442 \u043d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442`);for(const c of p)u.startFileUpload(c)})()}startFileUpload(e){var u=this;return(0,E.A)(function*(){const o={file:e,progress:0,status:"uploading"},s=u.uploadProgress();u.uploadProgress.set([...s,o]);try{const m=yield u.filesService.uploadFile(e,kt.p.ORDER_PHOTO).toPromise();if(!m)throw new Error("Upload failed");o.progress=100,o.status="completed",o.uploadedFileId=m.id,u.toastService.success(`\u0424\u0430\u0439\u043b "${e.name}" \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e`)}catch(m){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u0430:",m),o.status="error",o.error="\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u0430",u.toastService.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u0430: ${e.name}`)}const p=u.uploadProgress(),c=p.findIndex(m=>m.file===e);-1!==c&&(p[c]=o,u.uploadProgress.set([...p]))})()}removeSelectedFile(e){this.selectedFiles.splice(e,1)}removeUploadedFile(e){const u=this.uploadProgress();u.splice(e,1),this.uploadProgress.set([...u])}removeAttachedFile(e){const o=(this.orderForm.get("files")?.value||[]).filter(p=>p!==e);this.orderForm.patchValue({files:o});const s=this.attachedFiles();this.attachedFiles.set(s.filter(p=>p.id!==e))}viewFile(e){var u=this;return(0,E.A)(function*(){try{const o=yield u.filesService.getFileMetadata(e).toPromise();o?.isImage?u.openImageModal(o):u.downloadFile(e)}catch(o){console.error("Error viewing file:",o),u.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435 \u0444\u0430\u0439\u043b\u0430")}})()}downloadFile(e){var u=this;return(0,E.A)(function*(){try{const o=yield u.filesService.getFileMetadata(e).toPromise();if(o?.downloadUrl){const s=document.createElement("a");s.href=o.downloadUrl,s.download=o.originalName,s.target="_blank",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}catch(o){console.error("Error downloading file:",o),u.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}})()}openImageModal(e){this.currentImageMetadata=e,this.imageModalVisible=!0}closeImageModal(){this.imageModalVisible=!1,this.currentImageMetadata=null}downloadCurrentImage(){this.currentImageMetadata&&this.downloadFile(this.currentImageMetadata.id)}onSave(){var e=this;return(0,E.A)(function*(){if(!e.orderForm.invalid){e.isLoading.set(!0),e.isUploadingFiles.set(!0);try{e.isEdit&&e.orderId?yield e.updateOrder():yield e.createOrder()}catch(u){console.error("Error saving order:",u),e.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430"),e.isLoading.set(!1),e.isUploadingFiles.set(!1)}}})()}createOrder(){var e=this;return(0,E.A)(function*(){const u=e.orderForm.value,s=e.getCompletedUploads().filter(c=>c.uploadedFileId).map(c=>c.uploadedFileId);console.log("Creating order with file IDs:",s),e.ordersService.createOrder({title:u.title,description:u.description||void 0,organizationId:u.organizationId,location:u.location,distanceKm:u.distanceKm||void 0,territoryType:u.territoryType||void 0,plannedStartDate:u.plannedStartDate||void 0,source:u.source,files:s.length>0?s:void 0}).subscribe({next:c=>{e.toastService.success("\u0417\u0430\u043a\u0430\u0437 \u0441\u043e\u0437\u0434\u0430\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),e.clearFileData(),e.router.navigate(["/orders"])},error:c=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430:",c),e.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),e.isLoading.set(!1),e.isUploadingFiles.set(!1)}})})()}updateOrder(){var e=this;return(0,E.A)(function*(){if(!e.orderId)return;const u=e.orderForm.value,s=e.getCompletedUploads().filter(i=>i.uploadedFileId).map(i=>i.uploadedFileId),p=e.attachedFiles().map(i=>i.id),c=[...p,...s];console.log("Updating order with file IDs:",c,"(existing:",p,", new:",s,")");const m=e.workReportForm.value,g=null!==m.regularHours||null!==m.overtimeHours,O={title:u.title,description:u.description||void 0,organizationId:u.organizationId,location:u.location,distanceKm:u.distanceKm||void 0,territoryType:u.territoryType||void 0,plannedStartDate:u.plannedStartDate||void 0,source:u.source,status:u.status,actualStartDate:u.actualStartDate||void 0,completionDate:u.completionDate||void 0,files:c.length>0?c:void 0,regularHours:g?m.regularHours||0:void 0,overtimeHours:g?m.overtimeHours||0:void 0,carUsageAmount:g?m.carPayment||0:void 0,workNotes:g&&m.notes||void 0};console.log("\u{1f4ca} Order update data:",{...O,hasWorkData:g,workReportFormValue:m}),e.ordersService.updateOrder(e.orderId,O).subscribe({next:i=>{e.toastService.success("\u0417\u0430\u043a\u0430\u0437 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),e.clearFileData(),e.orderId&&e.loadOrder(e.orderId),e.isLoading.set(!1),e.isUploadingFiles.set(!1)},error:i=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430:",i),e.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),e.isLoading.set(!1),e.isUploadingFiles.set(!1)}})})()}getCompletedUploads(){return this.uploadProgress().filter(e=>"completed"===e.status)}getUploadIndex(e){return this.uploadProgress().indexOf(e)}isUploadingInProgress(){return this.uploadProgress().some(e=>"uploading"===e.status)}clearFileData(){this.selectedFiles=[],this.uploadProgress.set([]),this.isUploadingFiles.set(!1)}onCancel(){this.clearFileData(),this.router.navigate(["/orders"])}get canAcceptOrder(){const e=this.authService.currentUser();return!(!e||!this.order)&&e.role===F.gG.USER&&this.order.status===l.Re.ASSIGNED&&this.order.assignedEngineerId===e.id}onAcceptOrder(){var e=this;return(0,E.A)(function*(){if(e.orderId&&e.canAcceptOrder){e.isLoading.set(!0);try{yield e.ordersService.acceptOrder(e.orderId).toPromise(),e.toastService.success("\u0417\u0430\u043a\u0430\u0437 \u043f\u0440\u0438\u043d\u044f\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),yield e.loadOrder(e.orderId),e.selectedTabIndex=0}catch(u){console.error("Error accepting order:",u),e.toastService.error(u.error?.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u0438 \u0437\u0430\u043a\u0430\u0437\u0430")}finally{e.isLoading.set(!1)}}})()}onConfirmOrder(){var e=this;return(0,E.A)(function*(){if(!e.orderId||!e.canConfirmOrder())return;e.isLoading.set(!0);const u={status:l.Re.WORKING,actualStartDate:new Date};try{yield e.ordersService.updateOrder(e.orderId,u).toPromise(),e.toastService.success("\u0417\u0430\u044f\u0432\u043a\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0430. \u0421\u0442\u0430\u0442\u0443\u0441: \u0412 \u0440\u0430\u0431\u043e\u0442\u0435"),e.loadOrder(e.orderId)}catch(o){console.error("Error confirming order:",o),e.toastService.error(o.error?.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0438 \u0437\u0430\u044f\u0432\u043a\u0438")}finally{e.isLoading.set(!1)}})()}onStartExecution(){this.canStartExecution()&&(this.workExecutionForm.patchValue({workStartTime:new Date}),this.toastService.success("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 \u0440\u0430\u0431\u043e\u0442"))}onSetRepairComplete(e){this.workExecutionForm.patchValue({isRepairComplete:e})}onCompleteExecution(){var e=this;return(0,E.A)(function*(){if(!e.orderId||!e.canCompleteExecution())return;const u=e.workExecutionForm.value;if(!u.workStartTime||!u.workEndTime)return void e.toastService.error("\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442");if(null===u.isRepairComplete)return void e.toastService.error("\u0423\u043a\u0430\u0436\u0438\u0442\u0435, \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d \u043b\u0438 \u0440\u0435\u043c\u043e\u043d\u0442");e.isLoading.set(!0);const o=new Date(u.workStartTime),c=(new Date(u.workEndTime).getTime()-o.getTime())/36e5;if(c<=0)return e.toastService.error("\u0412\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u0437\u0436\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043d\u0430\u0447\u0430\u043b\u0430"),void e.isLoading.set(!1);const m={workActNumber:u.workActNumber,workStartTime:u.workStartTime,workEndTime:u.workEndTime,totalWorkHours:Math.round(100*c)/100,isOvertimeRate:u.isOvertimeRate,isRepairComplete:u.isRepairComplete,equipmentInfo:e.orderForm.get("equipmentInfo")?.value,comments:e.orderForm.get("comments")?.value};if(!0===u.isRepairComplete){m.status=l.Re.COMPLETED,m.completionDate=new Date;const g=new Date;g.setHours(g.getHours()+24),m.completionLockedAt=g}else m.isIncomplete=!0;try{yield e.ordersService.updateOrder(e.orderId,m).toPromise(),e.toastService.success(!0===u.isRepairComplete?"\u0420\u0430\u0431\u043e\u0442\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e. \u0421\u0442\u0430\u0442\u0443\u0441: \u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430":"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b. \u0417\u0430\u044f\u0432\u043a\u0430 \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u0430 \u043a\u0430\u043a \u043d\u0435\u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u0430\u044f"),e.loadOrder(e.orderId)}catch(g){console.error("Error completing execution:",g),e.toastService.error(g.error?.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0440\u0430\u0431\u043e\u0442\u044b")}finally{e.isLoading.set(!1)}})()}getTotalHours(){return(this.workReportForm.get("regularHours")?.value||0)+(this.workReportForm.get("overtimeHours")?.value||0)}onAutoFillWorkReport(){this.workReportForm.patchValue({regularHours:8,overtimeHours:0,carPayment:0,distanceKm:this.orderForm.get("distanceKm")?.value||null,territoryType:this.orderForm.get("territoryType")?.value||null})}getTerritoryTypeLabel(e){return{[l.F2.URBAN]:"\u0413\u043e\u0440\u043e\u0434\u0441\u043a\u0430\u044f",[l.F2.SUBURBAN]:"\u041f\u0440\u0438\u0433\u043e\u0440\u043e\u0434\u043d\u0430\u044f",[l.F2.RURAL]:"\u0421\u0435\u043b\u044c\u0441\u043a\u0430\u044f",[l.F2.HOME]:"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f (\u226460 \u043a\u043c)",[l.F2.ZONE_1]:"\u0417\u043e\u043d\u0430 1 (61-199 \u043a\u043c)",[l.F2.ZONE_2]:"\u0417\u043e\u043d\u0430 2 (200-250 \u043a\u043c)",[l.F2.ZONE_3]:"\u0417\u043e\u043d\u0430 3 (>250 \u043a\u043c)"}[e]||e}formatDate(e){return e?new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"}formatDateTime(e){return e?new Date(e).toLocaleString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"}formatAmount(e){return null==e||isNaN(e)?"0 \u20bd":`${e.toFixed(2)} \u20bd`}isAdminOrManager(){return this.authService.hasAnyRole([F.gG.ADMIN,F.gG.MANAGER])}onWorkSessionCreated(){this.toastService.showSuccess("\u0420\u0430\u0431\u043e\u0447\u0430\u044f \u0441\u0435\u0441\u0441\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0430","success")}onWorkSessionUpdated(e){this.toastService.showSuccess("\u0420\u0430\u0431\u043e\u0447\u0430\u044f \u0441\u0435\u0441\u0441\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430","success")}onWorkSessionDeleted(e){this.toastService.showSuccess("\u0420\u0430\u0431\u043e\u0447\u0430\u044f \u0441\u0435\u0441\u0441\u0438\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0430","success")}static{this.\u0275fac=function(u){return new(u||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-order-edit"]],standalone:!0,features:[t.aNF],decls:11,vars:4,consts:[["picker",""],["fileInput",""],["actualPicker",""],["completionPicker",""],[1,"order-edit-container"],[1,"header"],["mat-button","",3,"click"],["class","loading-container",4,"ngIf"],["class","order-form-container",4,"ngIf"],["class","image-modal-overlay",3,"click",4,"ngIf"],[1,"loading-container"],["diameter","40"],[1,"order-form-container"],[3,"selectedIndexChange","selectedIndex"],["label","\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0437\u0430\u043a\u0430\u0437\u0435"],[1,"order-form",3,"formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","title","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"],[4,"ngIf"],["matInput","","formControlName","description","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430","rows","3"],[1,"form-row"],["formControlName","organizationId"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","location","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435"],["matInput","","type","number","formControlName","distanceKm","placeholder","\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432 \u043a\u043c","min","0","step","0.1"],["formControlName","territoryType"],[3,"value"],["matInput","","formControlName","plannedStartDate",3,"matDatepicker"],["matSuffix","",3,"for"],["class","form-row",4,"ngIf"],["class","engineer-completion-section",4,"ngIf"],["label","\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0442\u044b"],[1,"work-report-tab-content"],[1,"tab-description"],[1,"work-report-form",3,"formGroup"],[1,"hours-group"],["matInput","","type","number","formControlName","regularHours","placeholder","8","min","0","step","0.25"],["matInput","","type","number","formControlName","overtimeHours","placeholder","0","min","0","step","0.25"],[1,"total-hours-display"],[1,"car-payment-group"],["appearance","outline",1,"form-field","full-width"],["matInput","","type","number","formControlName","carPayment","placeholder","0","min","0","step","1"],[1,"distance-group"],["matInput","","type","number","formControlName","distanceKm","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435","min","0","step","0.1"],["matInput","","formControlName","notes","placeholder","\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435","rows","3"],[1,"info-box"],[1,"info-icon"],[1,"info-text"],["label","\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0440\u0430\u0431\u043e\u0442\u044b",4,"ngIf"],["label","\u0424\u0430\u0439\u043b\u044b"],[1,"files-tab-content"],[1,"file-input-container"],["type","file","multiple","","accept","image/*,.pdf,.doc,.docx,.txt,.xlsx,.xls",2,"display","none",3,"change"],["mat-stroked-button","","type","button",3,"click","disabled"],[1,"drop-zone",3,"dragover","dragleave","drop"],["mat-button","","type","button",3,"click"],["class","upload-progress",4,"ngIf"],["class","uploaded-files",4,"ngIf"],["class","attached-files",4,"ngIf"],["label","\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438",4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","accent","class","accept-order-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],["formControlName","status"],["appearance","outline","class","form-field",4,"ngIf"],["formControlName","source"],["matInput","","formControlName","actualStartDate",3,"matDatepicker"],["matInput","","formControlName","completionDate",3,"matDatepicker"],[1,"engineer-completion-section"],[1,"engineer-note"],["label","\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0440\u0430\u0431\u043e\u0442\u044b"],[1,"work-report-view-tab-content"],[1,"report-card"],[1,"report-section"],[1,"report-grid"],[1,"report-item"],[1,"label"],[1,"value"],[1,"report-item","total"],["class","report-section",4,"ngIf"],[1,"report-timestamps"],["class","timestamp-item",4,"ngIf"],[1,"report-section","profit-section"],[1,"report-item","profit-item"],[1,"value","profit-value"],["class","report-section calculation-details",4,"ngIf"],[1,"report-section","calculation-details"],[1,"details-subsection"],["class","report-item",4,"ngIf"],[1,"notes-text"],[1,"timestamp-item"],[1,"upload-progress"],[1,"progress-list"],["class","progress-item",4,"ngFor","ngForOf"],[1,"progress-item"],[1,"progress-header"],[1,"file-name"],[1,"progress-status"],["mode","determinate",3,"value"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"uploaded-files"],[1,"file-list"],["class","file-item",4,"ngFor","ngForOf"],[1,"file-item"],[1,"file-size"],["mat-icon-button","","type","button",3,"click"],[1,"attached-files"],[1,"file-actions"],["mat-icon-button","","type","button","title","\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c",3,"click"],["mat-icon-button","","type","button","title","\u0421\u043a\u0430\u0447\u0430\u0442\u044c",3,"click"],["mat-icon-button","","type","button","title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c",3,"click"],["label","\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438"],[1,"work-sessions-tab-content"],[3,"orderId","sessionCreated",4,"ngIf"],[3,"orderId","canEdit","canDelete",4,"ngIf"],[3,"sessionCreated","orderId"],[3,"orderId","canEdit","canDelete"],["mat-raised-button","","color","accent",1,"accept-order-button",3,"click","disabled"],["diameter","20"],[1,"image-modal-overlay",3,"click"],[1,"image-modal-content",3,"click"],[1,"image-modal-header"],["mat-icon-button","",3,"click"],[1,"image-modal-body"],["class","image-viewer",3,"src","alt",4,"ngIf"],[1,"image-modal-footer"],[1,"file-info"],["mat-raised-button","","color","primary",3,"click"],[1,"image-viewer",3,"src","alt"]],template:function(u,o){1&u&&(t.j41(0,"div",4)(1,"div",5)(2,"h1"),t.EFF(3),t.k0s(),t.j41(4,"button",6),t.bIt("click",function(){return o.onCancel()}),t.j41(5,"mat-icon"),t.EFF(6,"arrow_back"),t.k0s(),t.EFF(7," \u041d\u0430\u0437\u0430\u0434 "),t.k0s()(),t.DNE(8,Ot,4,0,"div",7)(9,_4,195,45,"div",8),t.k0s(),t.DNE(10,F4,17,4,"div",9)),2&u&&(t.R7$(3),t.JRh(o.isEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043a\u0430\u0437":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0437\u0430\u043a\u0430\u0437"),t.R7$(5),t.Y8G("ngIf",o.isLoading()),t.R7$(),t.Y8G("ngIf",!o.isLoading()),t.R7$(),t.Y8G("ngIf",o.imageModalVisible))},dependencies:[C.MD,C.Sq,C.bT,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.VZ,a.j4,a.JD,f.RG,f.rl,f.nJ,f.MV,f.TL,f.yw,x.fS,x.fg,h.Hl,h.$z,h.iY,j.Ve,j.VO,P.wT,k.X6,k.Vh,k.bZ,k.bU,P.WX,v.m_,v.An,R.D6,R.LG,I.PO,I.HM,M.RI,M.mq,M.T8,_.Hu,_.RN,_.m2,_.MM,_.Lc,_.dh,at,Ct],styles:['@charset "UTF-8";.order-edit-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;display:flex;flex-direction:column;gap:24px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e0e0e0;padding-bottom:16px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#1976d2;font-size:2rem;font-weight:400}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666;font-size:1.1rem}.order-form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.order-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;max-width:800px;padding:20px 0}.files-tab-content[_ngcontent-%COMP%], .work-report-tab-content[_ngcontent-%COMP%]{padding:20px 0}.work-report-tab-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.work-report-tab-content[_ngcontent-%COMP%]   .tab-description[_ngcontent-%COMP%]{color:#666;margin-bottom:24px}.work-report-tab-content[_ngcontent-%COMP%]   .info-banner[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:16px;margin-bottom:24px;background-color:#e3f2fd;border-left:4px solid #1976d2;border-radius:8px}.work-report-tab-content[_ngcontent-%COMP%]   .info-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:24px;width:24px;height:24px;margin-top:2px}.work-report-tab-content[_ngcontent-%COMP%]   .info-banner[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{flex:1}.work-report-tab-content[_ngcontent-%COMP%]   .info-banner[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#1976d2;font-size:16px;margin-bottom:4px}.work-report-tab-content[_ngcontent-%COMP%]   .info-banner[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#555;font-size:14px}.work-report-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px;max-width:800px}.work-report-form[_ngcontent-%COMP%]   .hours-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .work-report-form[_ngcontent-%COMP%]   .car-payment-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .work-report-form[_ngcontent-%COMP%]   .distance-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#555;font-size:16px;font-weight:500}.work-report-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.work-report-form[_ngcontent-%COMP%]   .total-hours-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background-color:#e8f5e9;border-left:4px solid #4caf50;border-radius:4px;margin-top:12px}.work-report-form[_ngcontent-%COMP%]   .total-hours-display[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#4caf50;font-size:20px;width:20px;height:20px}.work-report-form[_ngcontent-%COMP%]   .total-hours-display[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;color:#333}.work-report-form[_ngcontent-%COMP%]   .total-hours-display[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:18px;color:#2e7d32}.work-report-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;margin-top:16px}.work-report-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.info-box[_ngcontent-%COMP%]{margin-top:24px;display:flex;align-items:flex-start;gap:12px;background-color:#e8f4f8;border-left:4px solid #1976d2;border-radius:4px;padding:16px}.info-box[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:24px;width:24px;height:24px}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{flex:1}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#333;font-weight:500}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#555}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.engineer-completion-section[_ngcontent-%COMP%]{margin:20px 0;padding:16px;background-color:#fff8e1;border-left:4px solid #ffc107;border-radius:4px}.engineer-completion-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0;font-weight:500;color:#333}.engineer-completion-section[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin-bottom:0;padding-left:20px}.engineer-completion-section[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px}.engineer-completion-section[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.form-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{flex:1;min-width:0}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px;padding-top:24px;border-top:1px solid #e0e0e0}.files-section[_ngcontent-%COMP%]{margin-top:24px;padding-top:24px;border-top:1px solid #e0e0e0}.files-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;font-weight:500;color:#1976d2}.files-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:16px 0 8px;font-size:14px;font-weight:500;color:#666}.file-input-container[_ngcontent-%COMP%]{margin-bottom:16px}.file-input-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px;text-transform:uppercase;font-weight:500;letter-spacing:.5px}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #ccc;border-radius:8px;padding:24px;text-align:center;background-color:#fafafa;transition:all .3s ease;margin-bottom:16px;cursor:pointer}.drop-zone[_ngcontent-%COMP%]:hover{border-color:#1976d2;background-color:#f0f8ff}.drop-zone.drag-over[_ngcontent-%COMP%]{border-color:#1976d2;background-color:#e3f2fd;transform:scale(1.02)}.drop-zone.drag-over[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.drop-zone[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#666;margin-bottom:8px}.drop-zone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0 4px;color:#666;font-size:14px}.drop-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#1976d2;text-decoration:underline;font-weight:500}.drop-zone[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#999;font-size:12px;display:block;margin-top:8px}.upload-progress[_ngcontent-%COMP%]{margin-bottom:16px;padding:16px;background-color:#f9f9f9;border-radius:8px;border:1px solid #e0e0e0}.upload-progress[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:500;color:#1976d2}.progress-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.progress-item[_ngcontent-%COMP%]{padding:12px;background-color:#fff;border-radius:6px;border:1px solid #e0e0e0}.progress-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.progress-header[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-weight:500;color:#333;flex:1}.progress-status[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding:2px 8px;border-radius:12px;text-transform:uppercase}.progress-status.pending[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.progress-status.uploading[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.progress-status.completed[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#388e3c}.progress-status.error[_ngcontent-%COMP%]{background-color:#ffebee;color:#d32f2f}.progress-item[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{margin-bottom:4px}.progress-item[_ngcontent-%COMP%]   mat-progress-bar.completed[_ngcontent-%COMP%]{--mdc-linear-progress-active-indicator-color: #388e3c}.progress-item[_ngcontent-%COMP%]   mat-progress-bar.error[_ngcontent-%COMP%]{--mdc-linear-progress-active-indicator-color: #d32f2f}.error-message[_ngcontent-%COMP%]{color:#d32f2f;font-size:12px;margin-top:4px}.file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 12px;background-color:#f5f5f5;border-radius:6px;border:1px solid #e0e0e0}.file-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:32px;height:32px;line-height:32px}.file-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.file-name[_ngcontent-%COMP%]{flex:1;font-size:14px;font-weight:500;color:#333}.file-size[_ngcontent-%COMP%]{font-size:12px;color:#666;white-space:nowrap}.calculation-details[_ngcontent-%COMP%]{background-color:#f9fafb!important;border:2px solid #e3f2fd}.calculation-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#1565c0;margin-bottom:20px}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 12px;color:#424242;font-size:14px;font-weight:600;display:flex;align-items:center;gap:8px}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]:before{content:"\\2022";color:#1976d2;font-size:18px}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   .report-grid[_ngcontent-%COMP%]{gap:12px}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e0e0e0}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#616161;font-size:13px}.calculation-details[_ngcontent-%COMP%]   .details-subsection[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#1976d2;font-weight:600}.image-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000c;display:flex;align-items:center;justify-content:center;z-index:10000}.image-modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:90vw;max-height:90vh;display:flex;flex-direction:column;box-shadow:0 10px 30px #0000004d}.image-modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #e0e0e0}.image-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500;color:#333;max-width:calc(100% - 40px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.image-modal-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#666}.image-modal-body[_ngcontent-%COMP%]{flex:1;padding:20px;display:flex;align-items:center;justify-content:center;min-height:300px;max-height:70vh;overflow:auto}.image-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;border-radius:4px}.image-modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-top:1px solid #e0e0e0;background:#f8f9fa}.image-modal-footer[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{color:#666;font-size:14px}.image-modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.file-actions[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center}.work-report-view-tab-content[_ngcontent-%COMP%]{padding:20px 0}.work-report-view-tab-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.work-report-view-tab-content[_ngcontent-%COMP%]   .tab-description[_ngcontent-%COMP%]{color:#666;margin-bottom:24px}.work-report-view-tab-content[_ngcontent-%COMP%]   .work-report-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:18px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#4caf50}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{margin-top:8px;color:#666}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding-top:16px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-section[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-section[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:0;margin-bottom:16px;color:#1976d2;font-size:16px;font-weight:500}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;background-color:#f5f5f5;border-radius:8px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item.total[_ngcontent-%COMP%]{background-color:#e3f2fd;border:1px solid #1976d2}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item.total[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#1976d2}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item.profit-item[_ngcontent-%COMP%]{background-color:#e8f5e9;border:1px solid #4caf50}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item.profit-item[_ngcontent-%COMP%]   .profit-value[_ngcontent-%COMP%]{color:#4caf50;font-size:18px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-size:14px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#333}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-item[_ngcontent-%COMP%]   .value.status-completed[_ngcontent-%COMP%]{color:#4caf50}.work-report-view-tab-content.profit-section[_ngcontent-%COMP%]{background-color:#f1f8e9;padding:16px;border-radius:8px;border:2px solid #4caf50}.work-report-view-tab-content[_ngcontent-%COMP%]   .notes-text[_ngcontent-%COMP%]{padding:12px;background-color:#f5f5f5;border-radius:8px;color:#333;line-height:1.6;white-space:pre-wrap}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-timestamps[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:16px;padding-top:16px;border-top:1px solid #e0e0e0}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-timestamps[_ngcontent-%COMP%]   .timestamp-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#666;font-size:14px}.work-report-view-tab-content[_ngcontent-%COMP%]   .report-timestamps[_ngcontent-%COMP%]   .timestamp-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#999}.work-report-view-tab-content[_ngcontent-%COMP%]   .no-reports[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center;color:#999}.work-report-view-tab-content[_ngcontent-%COMP%]   .no-reports[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;color:#ccc}.work-report-view-tab-content[_ngcontent-%COMP%]   .no-reports[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0}@media (max-width: 600px){.order-edit-container[_ngcontent-%COMP%]{padding:16px}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:flex-start}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}button[_ngcontent-%COMP%]{width:100%}}']})}}return n})()}}]);