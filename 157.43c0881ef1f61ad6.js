"use strict";(self.webpackChunkcoffee_admin=self.webpackChunkcoffee_admin||[]).push([[157],{6573:(I,v,s)=>{s.d(v,{F2:()=>r,Re:()=>e,cD:()=>F,jB:()=>f,kc:()=>p});var e=function(i){return i.WAITING="waiting",i.ASSIGNED="assigned",i.PROCESSING="processing",i.WORKING="working",i.REVIEW="review",i.COMPLETED="completed",i.PAID_TO_ENGINEER="paid_to_engineer",i}(e||{}),f=function(i){return i.WAITING="Waiting",i.ASSIGNED="Assigned",i.PROCESSING="Processing",i.WORKING="In Progress",i.REVIEW="Under Review",i.COMPLETED="Completed",i.PAID_TO_ENGINEER="Paid to Engineer",i}(f||{}),r=function(i){return i.URBAN="urban",i.SUBURBAN="suburban",i.RURAL="rural",i.HOME="home",i.ZONE_1="zone_1",i.ZONE_2="zone_2",i.ZONE_3="zone_3",i}(r||{}),F=function(i){return i.STAFF="staff",i.CONTRACT="contract",i}(F||{}),p=function(i){return i.MANUAL="manual",i.AUTOMATIC="automatic",i.EMAIL="email",i.API="api",i}(p||{})},2157:(I,v,s)=>{s.r(v),s.d(v,{UserEditComponent:()=>xe});var e=s(4292),f=s(9351),r=s(7199),F=s(1084),p=s(8598),i=s(6721),l=s(3505),d=s(5320),x=s(4536),E=s(91),P=s(8497),C=s(7317),k=s(8613),T=s(6093),D=s(4165),U=s(4842),N=s(4740),$=s(4755),G=s(1253),j=s(5720),R=s(8200),b=s(6573);function S(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e "),e.k0s())}function y(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c "),e.k0s())}function z(u,a){1&u&&e.nrm(0,"mat-spinner",10)}function w(u,a){1&u&&(e.j41(0,"span"),e.EFF(1,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),e.k0s())}let Y=(()=>{class u{constructor(){this.fb=(0,e.WQX)(r.ok),this.dialogRef=(0,e.WQX)(D.CP),this.data=(0,e.WQX)(D.Vh),this.isLoading=!1,this.rateForm=this.fb.group({value:[this.data.currentValue||0,[r.k0.required,r.k0.min(0)]]})}onSave(){this.rateForm.valid&&this.dialogRef.close(this.rateForm.value.value)}onCancel(){this.dialogRef.close(null)}static{this.\u0275fac=function(n){return new(n||u)}}static{this.\u0275cmp=e.VBU({type:u,selectors:[["app-rate-edit-dialog"]],standalone:!0,features:[e.aNF],decls:17,vars:9,consts:[[1,"rate-edit-dialog"],["mat-dialog-title",""],[1,"rate-form",3,"formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","value","type","number","step","0.01","autocomplete","off",3,"placeholder"],[4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],["diameter","20"]],template:function(n,o){if(1&n&&(e.j41(0,"div",0)(1,"h2",1),e.EFF(2),e.k0s(),e.j41(3,"mat-dialog-content")(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),e.EFF(7),e.k0s(),e.nrm(8,"input",4),e.DNE(9,S,2,0,"mat-error",5)(10,y,2,0,"mat-error",5),e.k0s()()(),e.j41(11,"mat-dialog-actions",6)(12,"button",7),e.bIt("click",function(){return o.onCancel()}),e.EFF(13,"\u041e\u0442\u043c\u0435\u043d\u0430"),e.k0s(),e.j41(14,"button",8),e.bIt("click",function(){return o.onSave()}),e.DNE(15,z,1,0,"mat-spinner",9)(16,w,2,0,"span",5),e.k0s()()()),2&n){let m,g;e.R7$(2),e.JRh(o.data.title),e.R7$(2),e.Y8G("formGroup",o.rateForm),e.R7$(3),e.JRh(o.data.label),e.R7$(),e.Y8G("placeholder",o.data.placeholder||"0"),e.R7$(),e.Y8G("ngIf",null==(m=o.rateForm.get("value"))?null:m.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(g=o.rateForm.get("value"))?null:g.hasError("min")),e.R7$(4),e.Y8G("disabled",o.rateForm.invalid),e.R7$(),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading)}},dependencies:[f.MD,f.bT,r.X1,r.qT,r.me,r.Q0,r.BC,r.cb,r.j4,r.JD,D.hM,D.BI,D.E7,D.Yi,i.RG,i.rl,i.nJ,i.TL,l.fS,l.fg,d.Hl,d.$z,E.m_,P.D6,P.LG],styles:[".rate-edit-dialog[_ngcontent-%COMP%]{min-width:400px;max-width:90vw;border-radius:12px;overflow:hidden}h2[mat-dialog-title][_ngcontent-%COMP%]{margin:0;padding:24px 24px 16px;font-size:20px;font-weight:500;color:#1976d2;border-bottom:1px solid #e0e0e0}.rate-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:24px;min-width:300px}.form-field[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{padding:0!important}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px 24px;margin:0;border-top:1px solid #e0e0e0;justify-content:flex-end;gap:12px}button[_ngcontent-%COMP%]{min-width:100px;border-radius:8px;text-transform:uppercase;font-weight:500;letter-spacing:.5px}button[color=primary][_ngcontent-%COMP%]{background-color:#1976d2;color:#fff}button[color=primary][_ngcontent-%COMP%]:disabled{background-color:#ccc;color:#666}.mat-mdc-form-field[_ngcontent-%COMP%]{margin-bottom:0}.mat-mdc-form-field-outline[_ngcontent-%COMP%], .mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-notched-outline__leading[_ngcontent-%COMP%], .mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%], .mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-notched-outline__trailing[_ngcontent-%COMP%]{border-radius:8px}mat-error[_ngcontent-%COMP%]{font-size:12px;margin-top:4px}@media (max-width: 600px){.rate-edit-dialog[_ngcontent-%COMP%]{min-width:95vw;margin:16px}.rate-form[_ngcontent-%COMP%]{padding:16px}h2[mat-dialog-title][_ngcontent-%COMP%]{padding:20px 16px 12px;font-size:18px}mat-dialog-actions[_ngcontent-%COMP%]{padding:12px 16px 20px;flex-direction:column;gap:8px}button[_ngcontent-%COMP%]{width:100%;min-width:unset}}"]})}}return u})();var L=s(7694);const A=()=>["organization","baseRate","overtimeRate"];function X(u,a){1&u&&(e.j41(0,"mat-error"),e.pXf(1,2),e.k0s())}function V(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0424\u0430\u043c\u0438\u043b\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430 "),e.k0s())}function H(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430 "),e.k0s())}function W(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email "),e.k0s())}function Z(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0420\u043e\u043b\u044c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430 "),e.k0s())}function Q(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0422\u0438\u043f \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d "),e.k0s())}function J(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 "),e.k0s())}function K(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0421\u0442\u0430\u0432\u043a\u0430 \u0437\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 "),e.k0s())}function q(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u041f\u043b\u0430\u043d\u043e\u0432\u044b\u0435 \u0447\u0430\u0441\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 1 "),e.k0s())}function ee(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u0421\u0443\u043c\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 "),e.k0s())}function te(u,a){if(1&u&&(e.j41(0,"div",30)(1,"mat-icon",31),e.EFF(2,"info"),e.k0s(),e.j41(3,"div",32)(4,"p")(5,"strong"),e.EFF(6,"\u0424\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b:"),e.k0s(),e.EFF(7),e.nI1(8,"currency"),e.k0s(),e.j41(9,"p",33),e.EFF(10),e.k0s()()()),2&u){let t;const n=e.XpG(2);e.R7$(7),e.SpI(" ",e.ii3(8,3,n.calculateFixedExpenses(),"RUB","symbol","1.0-0")," \u0432 \u043c\u0435\u0441\u044f\u0446 "),e.R7$(3),e.Lme(" \u0420\u0430\u0441\u0447\u0435\u0442: \u041f\u043b\u0430\u043d\u043e\u0432\u044b\u0435 \u0447\u0430\u0441\u044b/\u043c\u0435\u0441\u044f\u0446 \xd7 \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430 = ",(null==(t=n.userForm.get("planHoursMonth"))?null:t.value)||0," \xd7 ",(null==(t=n.userForm.get("baseRate"))?null:t.value)||0," \u0440\u0443\u0431. ")}}function ue(u,a){if(1&u){const t=e.RV6();e.j41(0,"div")(1,"div",10)(2,"mat-form-field",11)(3,"mat-label"),e.EFF(4,"\u0422\u0438\u043f \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430"),e.k0s(),e.j41(5,"mat-select",24),e.bIt("selectionChange",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onEngineerTypeChange())}),e.j41(6,"mat-option",17),e.EFF(7,"\u0428\u0442\u0430\u0442\u043d\u044b\u0439 \u0438\u043d\u0436\u0435\u043d\u0435\u0440"),e.k0s(),e.j41(8,"mat-option",17),e.EFF(9,"\u041a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 (\u043d\u0430\u0435\u043c\u043d\u044b\u0439) \u0438\u043d\u0436\u0435\u043d\u0435\u0440"),e.k0s()(),e.DNE(10,Q,2,0,"mat-error",13),e.k0s()(),e.j41(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e.EFF(14,"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430 (\u20bd/\u0447\u0430\u0441)"),e.k0s(),e.nrm(15,"input",25),e.DNE(16,J,2,0,"mat-error",13),e.k0s(),e.j41(17,"mat-form-field",11)(18,"mat-label"),e.EFF(19,"\u0421\u0442\u0430\u0432\u043a\u0430 \u0437\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0443 (\u20bd/\u0447\u0430\u0441)"),e.k0s(),e.nrm(20,"input",26),e.DNE(21,K,2,0,"mat-error",13),e.k0s()(),e.j41(22,"div",10)(23,"mat-form-field",11)(24,"mat-label"),e.EFF(25,"\u041f\u043b\u0430\u043d\u043e\u0432\u044b\u0435 \u0447\u0430\u0441\u044b/\u043c\u0435\u0441\u044f\u0446"),e.k0s(),e.nrm(26,"input",27),e.j41(27,"mat-hint"),e.EFF(28,"\u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0448\u0442\u0430\u0442\u043d\u044b\u0445 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u043e\u0432"),e.k0s(),e.DNE(29,q,2,0,"mat-error",13),e.k0s(),e.j41(30,"mat-form-field",11)(31,"mat-label"),e.EFF(32,"\u0424\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0439 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438 (\u20bd)"),e.k0s(),e.nrm(33,"input",28),e.j41(34,"mat-hint"),e.EFF(35,"\u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0448\u0442\u0430\u0442\u043d\u044b\u0445 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u043e\u0432"),e.k0s(),e.DNE(36,ee,2,0,"mat-error",13),e.k0s()(),e.DNE(37,te,11,8,"div",29),e.k0s()}if(2&u){let t,n,o,m,g,_;const c=e.XpG();e.R7$(6),e.Y8G("value",c.EngineerType.STAFF),e.R7$(2),e.Y8G("value",c.EngineerType.CONTRACT),e.R7$(2),e.Y8G("ngIf",null==(t=c.userForm.get("engineerType"))?null:t.hasError("required")),e.R7$(6),e.Y8G("ngIf",null==(n=c.userForm.get("baseRate"))?null:n.hasError("min")),e.R7$(5),e.Y8G("ngIf",null==(o=c.userForm.get("overtimeRate"))?null:o.hasError("min")),e.R7$(8),e.Y8G("ngIf",null==(m=c.userForm.get("planHoursMonth"))?null:m.hasError("min")),e.R7$(7),e.Y8G("ngIf",null==(g=c.userForm.get("homeTerritoryFixedAmount"))?null:g.hasError("min")),e.R7$(),e.Y8G("ngIf",(null==(_=c.userForm.get("engineerType"))?null:_.value)===c.EngineerType.STAFF)}}function ne(u,a){1&u&&(e.j41(0,"mat-form-field",11)(1,"mat-label"),e.EFF(2,"\u0421\u0442\u0430\u0442\u0443\u0441 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430"),e.k0s(),e.j41(3,"mat-select",36)(4,"mat-option",17),e.EFF(5,"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0438\u043d\u0436\u0435\u043d\u0435\u0440"),e.k0s(),e.j41(6,"mat-option",17),e.EFF(7,"\u041d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0438\u043d\u0436\u0435\u043d\u0435\u0440"),e.k0s()()()),2&u&&(e.R7$(4),e.Y8G("value",!0),e.R7$(2),e.Y8G("value",!1))}function oe(u,a){if(1&u&&(e.j41(0,"div",10)(1,"mat-form-field",11)(2,"mat-label"),e.EFF(3,"\u0421\u0442\u0430\u0442\u0443\u0441"),e.k0s(),e.j41(4,"mat-select",34)(5,"mat-option",17),e.EFF(6,"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0439"),e.k0s(),e.j41(7,"mat-option",17),e.EFF(8,"\u041d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439"),e.k0s()()(),e.DNE(9,ne,8,2,"mat-form-field",35),e.k0s()),2&u){let t;const n=e.XpG();e.R7$(5),e.Y8G("value",!0),e.R7$(2),e.Y8G("value",!1),e.R7$(2),e.Y8G("ngIf",(null==(t=n.userForm.get("role"))?null:t.value)===n.UserRole.USER)}}function re(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u041f\u0430\u0440\u043e\u043b\u044c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d "),e.k0s())}function ie(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),e.k0s())}function ae(u,a){if(1&u&&(e.j41(0,"div",10)(1,"mat-form-field",11)(2,"mat-label"),e.EFF(3,"\u041f\u0430\u0440\u043e\u043b\u044c"),e.k0s(),e.nrm(4,"input",37),e.DNE(5,re,2,0,"mat-error",13)(6,ie,2,0,"mat-error",13),e.k0s()()),2&u){let t,n;const o=e.XpG();e.R7$(5),e.Y8G("ngIf",null==(t=o.userForm.get("password"))?null:t.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(n=o.userForm.get("password"))?null:n.hasError("minlength"))}}function se(u,a){1&u&&(e.j41(0,"mat-error"),e.EFF(1," \u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),e.k0s())}function le(u,a){if(1&u&&(e.j41(0,"div",10)(1,"mat-form-field",11)(2,"mat-label"),e.EFF(3,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c (\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)"),e.k0s(),e.nrm(4,"input",38),e.DNE(5,se,2,0,"mat-error",13),e.k0s()()),2&u){let t;const n=e.XpG();e.R7$(5),e.Y8G("ngIf",null==(t=n.userForm.get("password"))?null:t.hasError("minlength"))}}function me(u,a){1&u&&(e.j41(0,"mat-card",39)(1,"mat-card-content")(2,"div",40)(3,"mat-icon",31),e.EFF(4,"info"),e.k0s(),e.j41(5,"div",32)(6,"h4"),e.EFF(7,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0441\u0442\u0430\u0432\u043e\u043a \u043f\u043e \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f\u043c"),e.k0s(),e.j41(8,"p"),e.EFF(9,' \u041f\u043e\u0441\u043b\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0431\u0443\u0434\u0443\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u0441\u0442\u0430\u0432\u043a\u0438 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0439. \u0412\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u0442\u0430\u0432\u043a\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043d\u0430 \u0432\u043a\u043b\u0430\u0434\u043a\u0435 "\u0421\u0442\u0430\u0432\u043a\u0438". '),e.k0s()()()()())}function ce(u,a){1&u&&e.nrm(0,"mat-spinner",41)}function de(u,a){if(1&u&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&u){const t=e.XpG();e.R7$(),e.JRh(t.isEdit?"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}}function ge(u,a){1&u&&(e.j41(0,"div",46),e.nrm(1,"mat-spinner",47),e.j41(2,"p"),e.EFF(3,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0442\u0430\u0432\u043e\u043a..."),e.k0s()())}function pe(u,a){1&u&&(e.j41(0,"th",57),e.EFF(1,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),e.k0s())}function fe(u,a){if(1&u&&(e.j41(0,"td",58)(1,"strong"),e.EFF(2),e.k0s()()),2&u){const t=a.$implicit;e.R7$(2),e.JRh(t.name)}}function _e(u,a){1&u&&(e.j41(0,"th",57),e.EFF(1,"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430"),e.k0s())}function Ee(u,a){if(1&u){const t=e.RV6();e.j41(0,"td",58)(1,"span",59),e.EFF(2),e.k0s(),e.j41(3,"button",60),e.bIt("click",function(){const o=e.eBV(t).$implicit,m=e.XpG(3);return e.Njj(m.editRateInline(o,"baseRate"))}),e.j41(4,"mat-icon"),e.EFF(5,"edit"),e.k0s()()()}if(2&u){const t=a.$implicit,n=e.XpG(3);e.R7$(2),e.JRh(n.getRateDisplayValue(n.getRateForOrganization(t.id),"baseRate"))}}function he(u,a){1&u&&(e.j41(0,"th",57),e.EFF(1,"\u0421\u0442\u0430\u0432\u043a\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438"),e.k0s())}function Ce(u,a){if(1&u){const t=e.RV6();e.j41(0,"td",58)(1,"span",59),e.EFF(2),e.k0s(),e.j41(3,"button",60),e.bIt("click",function(){const o=e.eBV(t).$implicit,m=e.XpG(3);return e.Njj(m.editRateInline(o,"overtimeRate"))}),e.j41(4,"mat-icon"),e.EFF(5,"edit"),e.k0s()()()}if(2&u){const t=a.$implicit,n=e.XpG(3);e.R7$(2),e.JRh(n.getRateDisplayValue(n.getRateForOrganization(t.id),"overtimeRate"))}}function Fe(u,a){1&u&&e.nrm(0,"tr",61)}function Re(u,a){1&u&&e.nrm(0,"tr",62)}function ve(u,a){if(1&u&&(e.j41(0,"div",48)(1,"table",49),e.qex(2,50),e.DNE(3,pe,2,0,"th",51)(4,fe,3,1,"td",52),e.bVm(),e.qex(5,53),e.DNE(6,_e,2,0,"th",51)(7,Ee,6,1,"td",52),e.bVm(),e.qex(8,54),e.DNE(9,he,2,0,"th",51)(10,Ce,6,1,"td",52),e.bVm(),e.DNE(11,Fe,1,0,"tr",55)(12,Re,1,0,"tr",56),e.k0s()()),2&u){const t=e.XpG(2);e.R7$(),e.Y8G("dataSource",t.organizations()),e.R7$(10),e.Y8G("matHeaderRowDef",e.lJ4(3,A)),e.R7$(),e.Y8G("matRowDefColumns",e.lJ4(4,A))}}function De(u,a){if(1&u&&(e.j41(0,"mat-tab",42)(1,"div",8)(2,"div",43)(3,"p"),e.EFF(4,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0442\u0430\u0432\u043e\u043a \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430 \u043f\u043e \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f\u043c."),e.k0s(),e.j41(5,"p")(6,"strong"),e.EFF(7,"\u0411\u0430\u0437\u043e\u0432\u044b\u0435:"),e.k0s(),e.EFF(8),e.j41(9,"strong"),e.EFF(10,"\u041f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0430:"),e.k0s(),e.EFF(11),e.k0s()(),e.DNE(12,ge,4,0,"div",44)(13,ve,13,5,"div",45),e.k0s()()),2&u){let t,n;const o=e.XpG();e.R7$(8),e.SpI(" ",null==(t=o.getUser())||null==t.engineer?null:t.engineer.baseRate," \u20bd/\u0447, "),e.R7$(3),e.SpI(" ",null==(n=o.getUser())||null==n.engineer?null:n.engineer.overtimeRate," \u20bd/\u0447 "),e.R7$(),e.Y8G("ngIf",o.ratesLoading()),e.R7$(),e.Y8G("ngIf",!o.ratesLoading())}}let xe=(()=>{class u{constructor(){this.fb=(0,e.WQX)(r.ok),this.route=(0,e.WQX)(U.nX),this.router=(0,e.WQX)(U.Ix),this.dialog=(0,e.WQX)(D.bZ),this.usersService=(0,e.WQX)(N.g),this.toastService=(0,e.WQX)($.f),this.engineerRatesService=(0,e.WQX)(G.n),this.organizationsService=(0,e.WQX)(j.k),this.userId=(0,e.vPA)(null),this.isEdit=!1,this.user=(0,e.vPA)(null),this.isLoading=(0,e.vPA)(!1),this.selectedTabIndex=(0,e.vPA)(0),this.organizations=(0,e.vPA)([]),this.engineerRates=(0,e.vPA)([]),this.ratesLoading=(0,e.vPA)(!1),this.UserRole=R.gG,this.EngineerType=b.cD,this.userForm=this.fb.group({firstName:["",[r.k0.required]],lastName:["",[r.k0.required]],email:["",[r.k0.required,r.k0.email]],role:[R.gG.USER,[r.k0.required]],password:[""],isActive:[!0],engineerType:[b.cD.STAFF],baseRate:[700,[r.k0.min(0)]],overtimeRate:[700,[r.k0.min(0)]],planHoursMonth:[160,[r.k0.min(1)]],homeTerritoryFixedAmount:[0,[r.k0.min(0)]],engineerIsActive:[!0]})}calculateFixedExpenses(){return(this.userForm.get("planHoursMonth")?.value||0)*(this.userForm.get("baseRate")?.value||0)}ngOnInit(){const t=this.route.snapshot.params.id;t&&(this.userId.set(+t),this.isEdit=!0,this.loadUser(+t)),this.loadOrganizations()}loadUser(t){this.isLoading.set(!0),this.usersService.getUser(t).subscribe({next:n=>{this.user.set(n),this.userForm.patchValue({firstName:n.firstName,lastName:n.lastName,email:n.email,role:n.role,isActive:n.isActive}),n.engineer&&(this.userForm.patchValue({engineerType:n.engineer.type,baseRate:n.engineer.baseRate,overtimeRate:n.engineer.overtimeRate||0,planHoursMonth:n.engineer.planHoursMonth,homeTerritoryFixedAmount:n.engineer.homeTerritoryFixedAmount,engineerIsActive:n.engineer.isActive}),this.loadEngineerRates(t)),this.userForm.get("password")?.setValidators([r.k0.minLength(6)]),this.isLoading.set(!1)},error:n=>{console.error("Error loading user:",n),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),this.isLoading.set(!1),this.goBack()}})}loadOrganizations(){this.organizationsService.getOrganizations().subscribe({next:t=>{this.organizations.set(t.data||[])},error:t=>{console.error("Error loading organizations:",t)}})}loadEngineerRates(t){this.ratesLoading.set(!0);const n=this.user();n?.engineer?this.engineerRatesService.getActiveRatesForEngineer(n.engineer.id).subscribe({next:o=>{console.log("\u{1f4ca} Loaded engineer rates:",o),this.engineerRates.set(o),this.ratesLoading.set(!1)},error:o=>{console.error("Error loading engineer rates:",o),this.ratesLoading.set(!1)}}):this.ratesLoading.set(!1)}onRoleChange(){this.userForm.get("role")?.value!==R.gG.USER?this.userForm.patchValue({engineerType:b.cD.STAFF,baseRate:700,overtimeRate:700,planHoursMonth:160,homeTerritoryFixedAmount:0,engineerIsActive:!0}):this.onEngineerTypeChange()}onEngineerTypeChange(){switch(this.userForm.get("engineerType")?.value){case b.cD.STAFF:this.userForm.patchValue({baseRate:700,overtimeRate:700,planHoursMonth:160,homeTerritoryFixedAmount:0}),this.userForm.get("planHoursMonth")?.enable(),this.userForm.get("homeTerritoryFixedAmount")?.enable();break;case b.cD.CONTRACT:this.userForm.patchValue({baseRate:700,overtimeRate:1200,planHoursMonth:null,homeTerritoryFixedAmount:null}),this.userForm.get("planHoursMonth")?.disable(),this.userForm.get("homeTerritoryFixedAmount")?.disable()}}onSave(){this.userForm.invalid||(this.isLoading.set(!0),this.isEdit&&this.userId()?this.updateUser():this.createUser())}createUser(){const t=this.userForm.value;this.usersService.createUser({firstName:t.firstName,lastName:t.lastName,email:t.email,password:t.password,role:t.role,engineerType:t.role===R.gG.USER?t.engineerType:void 0,baseRate:t.role===R.gG.USER?t.baseRate:void 0,overtimeRate:t.role===R.gG.USER?t.overtimeRate:void 0,planHoursMonth:t.role===R.gG.USER?t.planHoursMonth:void 0,homeTerritoryFixedAmount:t.role===R.gG.USER?t.homeTerritoryFixedAmount:void 0}).subscribe({next:o=>{this.toastService.success(o.role===R.gG.USER?"\u0418\u043d\u0436\u0435\u043d\u0435\u0440 \u0441\u043e\u0437\u0434\u0430\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e. \u0421\u0442\u0430\u0432\u043a\u0438 \u043f\u043e \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438.":"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441\u043e\u0437\u0434\u0430\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),this.isLoading.set(!1),this.goBack()},error:o=>{console.error("Error creating user:",o),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),this.isLoading.set(!1)}})}updateUser(){if(!this.userId())return;const t=this.userForm.value,n={firstName:t.firstName,lastName:t.lastName,email:t.email,role:t.role,isActive:t.isActive};t.password&&(n.password=t.password),t.role===R.gG.USER&&(n.engineerType=t.engineerType,n.baseRate=t.baseRate,n.overtimeRate=t.overtimeRate,n.planHoursMonth=t.planHoursMonth,n.homeTerritoryFixedAmount=t.homeTerritoryFixedAmount,n.engineerIsActive=t.engineerIsActive),this.usersService.updateUser(this.userId(),n).subscribe({next:o=>{this.toastService.success("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),this.isLoading.set(!1),this.goBack()},error:o=>{console.error("Error updating user:",o),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),this.isLoading.set(!1)}})}editRateInline(t,n){const o=this.getRateForOrganization(t.id);let m=0;if(o)switch(n){case"baseRate":m=o.customBaseRate||0;break;case"overtimeRate":m=o.customOvertimeRate||0}this.dialog.open(Y,{data:{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 "+("baseRate"===n?"\u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u0441\u0442\u0430\u0432\u043a\u0438":"\u0441\u0442\u0430\u0432\u043a\u0438 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438"),label:"baseRate"===n?"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430 (\u20bd/\u0447\u0430\u0441)":"\u0421\u0442\u0430\u0432\u043a\u0430 \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0438 (\u20bd/\u0447\u0430\u0441)",currentValue:m,placeholder:"700"},width:"400px",disableClose:!0}).afterClosed().subscribe(c=>{if(null!=c){const h={};switch(n){case"baseRate":h.customBaseRate=c;break;case"overtimeRate":h.customOvertimeRate=c}o?this.onUpdateRate(o,h):this.createNewRate(t.id,h)}})}createNewRate(t,n){const o=this.user();if(!o||!o.engineer)return;const m=o.engineer.id,g=this.engineerRates().find(_=>_.engineerId===m&&_.organizationId===t);if(g)console.log("\u{1f504} Updating existing rate:",g.id,n),this.onUpdateRate(g,n);else{const _={engineerId:m,organizationId:t,...n};console.log("\u{1f3d7}\ufe0f Creating new rate:",_),this.engineerRatesService.createRate(_).subscribe({next:c=>{console.log("\u2705 Rate created successfully:",c);const h=this.engineerRates();this.engineerRates.set([...h,c]),this.toastService.success("\u0421\u0442\u0430\u0432\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),this.loadEngineerRates(o.id)},error:c=>{if(console.error("\u274c Error creating rate:",c),409===c.status){console.log("\u{1f504} Rate already exists, trying to update...");const h=this.engineerRates().find(M=>M.engineerId===m&&M.organizationId===t);h?this.onUpdateRate(h,n):this.toastService.warning("\u0421\u0442\u0430\u0432\u043a\u0430 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442, \u043d\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e")}else this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0441\u0442\u0430\u0432\u043a\u0438")}})}}onUpdateRate(t,n){const o={customBaseRate:n.customBaseRate,customOvertimeRate:n.customOvertimeRate,customZone1Extra:n.customZone1Extra,customZone2Extra:n.customZone2Extra,customZone3Extra:n.customZone3Extra};console.log("\u{1f504} Updating rate:",t.id,o),this.engineerRatesService.updateRate(t.id,o).subscribe({next:m=>{console.log("\u2705 Rate updated successfully:",m);const _=this.engineerRates().map(c=>c.id===t.id?m:c);this.engineerRates.set(_),this.toastService.success("\u0421\u0442\u0430\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e")},error:m=>{console.error("\u274c Error updating rate:",m),this.toastService.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0441\u0442\u0430\u0432\u043a\u0438")}})}getUser(){return this.user()}getRateForOrganization(t){return this.engineerRates().find(n=>n.organizationId===t)}getRateDisplayValue(t,n){if(!t)return"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";switch(n){case"baseRate":return t.customBaseRate?`${t.customBaseRate} \u20bd`:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";case"overtimeRate":return t.customOvertimeRate?`${t.customOvertimeRate} \u20bd`:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";case"zone1Extra":return t.customZone1Extra?`${t.customZone1Extra} \u20bd`:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";case"zone2Extra":return t.customZone2Extra?`${t.customZone2Extra} \u20bd`:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";case"zone3Extra":return t.customZone3Extra?`${t.customZone3Extra} \u20bd`:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e";default:return"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e"}}goBack(){this.router.navigate(["/users"])}static{this.\u0275fac=function(n){return new(n||u)}}static{this.\u0275cmp=e.VBU({type:u,selectors:[["app-user-edit"]],standalone:!0,features:[e.aNF],decls:53,vars:20,consts:()=>{let t,n,o;return t=$localize`:@@user.firstName:Имя`,n=$localize`:@@user.lastName:Фамилия`,o=$localize`:@@user.firstNameRequired: Имя обязательно `,[t,n,o,[1,"user-edit-container"],[1,"header"],["mat-button","",3,"click"],[3,"selectedIndexChange","selectedIndex"],["label","\u041e\u0431\u0449\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"],[1,"tab-content"],[1,"user-form",3,"formGroup"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","firstName","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f"],[4,"ngIf"],["matInput","","formControlName","lastName","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0430\u043c\u0438\u043b\u0438\u044e"],["matInput","","formControlName","email","type","email","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b"],["formControlName","role",3,"selectionChange"],[3,"value"],["class","form-row",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],["label","\u0421\u0442\u0430\u0432\u043a\u0438",4,"ngIf"],["formControlName","engineerType",3,"selectionChange"],["matInput","","formControlName","baseRate","type","number","step","0.01","placeholder","700"],["matInput","","formControlName","overtimeRate","type","number","step","0.01","placeholder","700"],["matInput","","formControlName","planHoursMonth","type","number","placeholder","160"],["matInput","","formControlName","homeTerritoryFixedAmount","type","number","step","0.01","placeholder","0"],["class","info-box",4,"ngIf"],[1,"info-box"],[1,"info-icon"],[1,"info-text"],[1,"info-details"],["formControlName","isActive"],["appearance","outline","class","form-field",4,"ngIf"],["formControlName","engineerIsActive"],["matInput","","formControlName","password","type","password","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"],["matInput","","formControlName","password","type","password","placeholder","\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u0443\u0441\u0442\u044b\u043c, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"],[1,"info-card"],[1,"info-content"],["diameter","20"],["label","\u0421\u0442\u0430\u0432\u043a\u0438"],[1,"rates-info"],["class","rates-loading",4,"ngIf"],["class","rates-table-container",4,"ngIf"],[1,"rates-loading"],["diameter","40"],[1,"rates-table-container"],["mat-table","",1,"rates-table",3,"dataSource"],["matColumnDef","organization"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","baseRate"],["matColumnDef","overtimeRate"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"rate-value"],["mat-icon-button","","matTooltip","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",3,"click"],["mat-header-row",""],["mat-row",""]]},template:function(n,o){if(1&n&&(e.j41(0,"div",3)(1,"div",4)(2,"h1"),e.EFF(3),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return o.goBack()}),e.j41(5,"mat-icon"),e.EFF(6,"arrow_back"),e.k0s(),e.EFF(7," \u041d\u0430\u0437\u0430\u0434 "),e.k0s()(),e.j41(8,"mat-tab-group",6),e.mxI("selectedIndexChange",function(g){return e.DH7(o.selectedTabIndex,g)||(o.selectedTabIndex=g),g}),e.j41(9,"mat-tab",7)(10,"div",8)(11,"form",9)(12,"div",10)(13,"mat-form-field",11)(14,"mat-label"),e.pXf(15,0),e.k0s(),e.nrm(16,"input",12),e.DNE(17,X,2,0,"mat-error",13),e.k0s(),e.j41(18,"mat-form-field",11)(19,"mat-label"),e.pXf(20,1),e.k0s(),e.nrm(21,"input",14),e.DNE(22,V,2,0,"mat-error",13),e.k0s()(),e.j41(23,"div",10)(24,"mat-form-field",11)(25,"mat-label"),e.EFF(26,"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430"),e.k0s(),e.nrm(27,"input",15),e.DNE(28,H,2,0,"mat-error",13)(29,W,2,0,"mat-error",13),e.k0s(),e.j41(30,"mat-form-field",11)(31,"mat-label"),e.EFF(32,"\u0420\u043e\u043b\u044c"),e.k0s(),e.j41(33,"mat-select",16),e.bIt("selectionChange",function(){return o.onRoleChange()}),e.j41(34,"mat-option",17),e.EFF(35,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"),e.k0s(),e.j41(36,"mat-option",17),e.EFF(37,"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"),e.k0s(),e.j41(38,"mat-option",17),e.EFF(39,"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"),e.k0s()(),e.DNE(40,Z,2,0,"mat-error",13),e.k0s()(),e.DNE(41,ue,38,8,"div",13)(42,oe,10,3,"div",18)(43,ae,7,2,"div",18)(44,le,6,1,"div",18)(45,me,10,0,"mat-card",19),e.k0s(),e.j41(46,"div",20)(47,"button",5),e.bIt("click",function(){return o.goBack()}),e.EFF(48,"\u041e\u0442\u043c\u0435\u043d\u0430"),e.k0s(),e.j41(49,"button",21),e.bIt("click",function(){return o.onSave()}),e.DNE(50,ce,1,0,"mat-spinner",22)(51,de,2,1,"span",13),e.k0s()()()(),e.DNE(52,De,14,4,"mat-tab",23),e.k0s()()),2&n){let m,g,_,c,h,M,B,O;e.R7$(3),e.JRh(o.isEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),e.R7$(5),e.R50("selectedIndex",o.selectedTabIndex),e.R7$(3),e.Y8G("formGroup",o.userForm),e.R7$(6),e.Y8G("ngIf",null==(m=o.userForm.get("firstName"))?null:m.hasError("required")),e.R7$(5),e.Y8G("ngIf",null==(g=o.userForm.get("lastName"))?null:g.hasError("required")),e.R7$(6),e.Y8G("ngIf",null==(_=o.userForm.get("email"))?null:_.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(c=o.userForm.get("email"))?null:c.hasError("email")),e.R7$(5),e.Y8G("value",o.UserRole.USER),e.R7$(2),e.Y8G("value",o.UserRole.MANAGER),e.R7$(2),e.Y8G("value",o.UserRole.ADMIN),e.R7$(2),e.Y8G("ngIf",null==(h=o.userForm.get("role"))?null:h.hasError("required")),e.R7$(),e.Y8G("ngIf",(null==(M=o.userForm.get("role"))?null:M.value)===o.UserRole.USER),e.R7$(),e.Y8G("ngIf",o.isEdit),e.R7$(),e.Y8G("ngIf",!o.isEdit),e.R7$(),e.Y8G("ngIf",o.isEdit),e.R7$(),e.Y8G("ngIf",!o.isEdit&&(null==(B=o.userForm.get("role"))?null:B.value)===o.UserRole.USER),e.R7$(4),e.Y8G("disabled",o.userForm.invalid||o.isLoading()),e.R7$(),e.Y8G("ngIf",o.isLoading()),e.R7$(),e.Y8G("ngIf",!o.isLoading()),e.R7$(),e.Y8G("ngIf",o.isEdit&&(null==(O=o.getUser())?null:O.role)===o.UserRole.USER&&(null==(O=o.getUser())?null:O.engineer))}},dependencies:[f.MD,f.bT,f.oe,r.X1,r.qT,r.me,r.Q0,r.BC,r.cb,r.j4,r.JD,F.RI,F.mq,F.T8,p.Hu,p.RN,p.m2,i.RG,i.rl,i.nJ,i.MV,i.TL,l.fS,l.fg,d.Hl,d.$z,d.iY,x.Ve,x.VO,L.wT,E.m_,E.An,P.D6,P.LG,C.tP,C.Zl,C.tL,C.ji,C.cC,C.YV,C.iL,C.KS,C.$R,C.YZ,C.NB,k.YN,T.uc,T.oV],styles:[".user-edit-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;display:flex;flex-direction:column;gap:24px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e0e0e0;padding-bottom:16px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#1976d2;font-size:2rem;font-weight:400}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.tab-content[_ngcontent-%COMP%]{padding:24px 0}.user-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;max-width:800px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.form-field[_ngcontent-%COMP%]{flex:1;min-width:0}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px;padding-top:24px;border-top:1px solid #e0e0e0}.info-card[_ngcontent-%COMP%]{margin:20px 0;background-color:#e3f2fd!important;border:1px solid #bbdefb!important}.info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px!important}.info-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.info-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:24px;margin-top:2px}.info-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#1976d2;font-size:16px;font-weight:500}.info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#424242;font-size:14px;line-height:1.4}.info-box[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;background-color:#fff8e1;border-left:4px solid #ffc107;border-radius:4px;padding:16px;margin:16px 0}.info-box[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{color:#ffc107}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#424242}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.info-box[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]{font-size:.9em;color:#666}.rates-info[_ngcontent-%COMP%]{margin-bottom:20px;padding:16px;background-color:#f5f5f5;border-radius:8px;border-left:4px solid #1976d2}.rates-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#424242}.rates-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.rates-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;color:#666}.rates-loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px}.rates-table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:16px}.rates-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.rates-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px;color:#666;padding:12px 16px;background-color:#f5f5f5;border-bottom:1px solid #e0e0e0;text-align:left}.rates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e0e0e0}.rates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .rate-value[_ngcontent-%COMP%]{margin-right:8px;font-weight:500}.rates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]{width:32px;height:32px}.rates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   button[mat-button][_ngcontent-%COMP%]{font-size:.875rem;line-height:1;padding:6px 12px;min-height:32px}.rates-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}@media (max-width: 768px){.user-edit-container[_ngcontent-%COMP%]{padding:16px}.header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:flex-start}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.form-field[_ngcontent-%COMP%]{width:100%!important}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.rates-table[_ngcontent-%COMP%]{font-size:.875rem}.rates-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .rates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px}}@media (max-width: 480px){.user-edit-container[_ngcontent-%COMP%]{padding:12px}.form-field[_ngcontent-%COMP%]{width:100%!important;min-width:100%!important}.form-row[_ngcontent-%COMP%]{gap:16px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem}.info-box[_ngcontent-%COMP%]{padding:12px;margin:12px 0}.info-box[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9em}}"]})}}return u})()},5720:(I,v,s)=>{s.d(v,{k:()=>F});var e=s(4292),f=s(6e3),r=s(878);let F=(()=>{class p{constructor(){this.http=(0,e.WQX)(f.Qq)}getOrganizations(l){let d=new f.Nl;return l&&Object.entries(l).forEach(([x,E])=>{null!=E&&""!==E&&(d=d.set(x,E.toString()))}),this.http.get(`${r.c.apiUrl}/organizations`,{params:d})}getOrganization(l){return this.http.get(`${r.c.apiUrl}/organizations/${l}`)}createOrganization(l){return this.http.post(`${r.c.apiUrl}/organizations`,l)}updateOrganization(l,d){return this.http.patch(`${r.c.apiUrl}/organizations/${l}`,d)}deleteOrganization(l){return this.http.delete(`${r.c.apiUrl}/organizations/${l}`)}toggleOrganizationStatus(l){return this.http.patch(`${r.c.apiUrl}/organizations/${l}/toggle-status`,{})}static{this.\u0275fac=function(d){return new(d||p)}}static{this.\u0275prov=e.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()},4740:(I,v,s)=>{s.d(v,{g:()=>F});var e=s(4292),f=s(6e3),r=s(878);let F=(()=>{class p{constructor(){this.http=(0,e.WQX)(f.Qq)}getUsers(l){let d=new f.Nl;return l&&Object.entries(l).forEach(([x,E])=>{null!=E&&""!==E&&(d=d.set(x,E.toString()))}),this.http.get(`${r.c.apiUrl}/users`,{params:d})}getUser(l){return this.http.get(`${r.c.apiUrl}/users/${l}`)}createUser(l){return this.http.post(`${r.c.apiUrl}/users`,l)}updateUser(l,d){return this.http.patch(`${r.c.apiUrl}/users/${l}`,d)}deleteUser(l){return this.http.delete(`${r.c.apiUrl}/users/${l}`)}checkUserDeletion(l){return this.http.delete(`${r.c.apiUrl}/users/${l}`)}forceDeleteUser(l){return this.http.delete(`${r.c.apiUrl}/users/${l}/force`)}getUserProfile(){return this.http.get(`${r.c.apiUrl}/users/profile`)}updateProfile(l){return this.http.patch(`${r.c.apiUrl}/users/profile`,l)}static{this.\u0275fac=function(d){return new(d||p)}}static{this.\u0275prov=e.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()}}]);